window.__require=function t(e,n,o){function i(a,s){if(!n[a]){if(!e[a]){var c=a.split("/");if(c=c[c.length-1],!e[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(r)return r(c,!0);throw new Error("Cannot find module '"+a+"'")}a=c}var u=n[a]={exports:{}};e[a][0].call(u.exports,function(t){return i(e[a][1][t]||t)},u,u.exports,t,e,n,o)}return n[a].exports}for(var r="function"==typeof __require&&__require,a=0;a<o.length;a++)i(o[a]);return i}({BitStream:[function(t,e,n){(function(t){"use strict";cc._RF.push(e,"60a67X/wJpForP73rC32Wao","BitStream"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,n,o){if(!(e instanceof ArrayBuffer||void 0!==t&&e instanceof t))throw new Error("Must specify a valid ArrayBuffer or Buffer.");n=n||0,o=o||e.byteLength||e.length,this._view=new Uint8Array(e,n,o),this.bigEndian=!1}return Object.defineProperty(e.prototype,"buffer",{get:function(){return void 0!==t?t.from(this._view.buffer):this._view.buffer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"byteLength",{get:function(){return this._view.length},enumerable:!0,configurable:!0}),e.prototype.setBit=function(t,e){e?this._view[t>>3]|=1<<(7&t):this._view[t>>3]&=~(1<<(7&t))},e.prototype.getBits=function(t,e,n){var o=8*this._view.length-t;if(e>o)throw new Error("Cannot get "+e+" bit(s) from offset "+t+", "+o+" available");for(var i=0,r=0;r<e;){var a=e-r,s=7&t,c=this._view[t>>3],l=Math.min(a,8-s);this.bigEndian?(i<<=l,i|=c>>8-l-s&~(255<<l)):i|=(c>>s&~(255<<l))<<r,t+=l,r+=l}return n?(32!==e&&i&1<<e-1&&(i|=-1^(1<<e)-1),i):i>>>0},e.prototype.setBits=function(t,e,n){var o=8*this._view.length-t;if(n>o)throw new Error("Cannot set "+n+" bit(s) from offset "+t+", "+o+" available");for(var i=0;i<n;){var r=n-i,a=7&t,s=t>>3,c=Math.min(r,8-a),l=void 0,u=void 0,p=void 0;if(this.bigEndian){u=e>>n-i-c&(l=~(-1<<c));var f=8-a-c;p=~(l<<f),this._view[s]=this._view[s]&p|u<<f}else u=e&(l=~(255<<c)),e>>=c,p=~(l<<a),this._view[s]=this._view[s]&p|u<<a;t+=c,i+=c}},e.prototype.getBoolean=function(t){return 0!==this.getBits(t,1,!1)},e.prototype.getInt8=function(t){return this.getBits(t,8,!0)},e.prototype.getUint8=function(t){return this.getBits(t,8,!1)},e.prototype.getInt16=function(t){return this.getBits(t,16,!0)},e.prototype.getUint16=function(t){return this.getBits(t,16,!1)},e.prototype.getInt32=function(t){return this.getBits(t,32,!0)},e.prototype.getUint32=function(t){return this.getBits(t,32,!1)},e.prototype.getFloat32=function(t){return e._scratch.setUint32(0,this.getUint32(t)),e._scratch.getFloat32(0)},e.prototype.getFloat64=function(t){return e._scratch.setUint32(0,this.getUint32(t)),e._scratch.setUint32(4,this.getUint32(t+32)),e._scratch.getFloat64(0)},e.prototype.setBoolean=function(t,e){this.setBits(t,e?1:0,1)},e.prototype.setUint8=function(t,e){this.setBits(t,e,8)},e.prototype.setInt8=function(t,e){this.setUint8(t,e)},e.prototype.setUint16=function(t,e){this.setBits(t,e,16)},e.prototype.setInt16=function(t,e){this.setUint16(t,e)},e.prototype.setUint32=function(t,e){this.setBits(t,e,32)},e.prototype.setInt32=function(t,e){this.setUint32(t,e)},e.prototype.setFloat32=function(t,n){e._scratch.setFloat32(0,n),this.setBits(t,e._scratch.getUint32(0),32)},e.prototype.setFloat64=function(t,n){e._scratch.setFloat64(0,n),this.setBits(t,e._scratch.getUint32(0),32),this.setBits(t+32,e._scratch.getUint32(4),32)},e.prototype.getArrayBuffer=function(t,e){for(var n=new Uint8Array(e),o=0;o<e;o++)n[o]=this.getUint8(t+8*o);return n.buffer},e._scratch=new DataView(new ArrayBuffer(8)),e}();n.BitView=o;var i=function(t,e){return function(){if(this._index+e>this._length)throw new Error("Trying to read past the end of the stream");var n=this._view[t](this._index);return this._index+=e,n}},r=function(t,e){return function(n){this._view[t](this._index,n),this._index+=e}};function a(t,e){return c(t,e,!1)}function s(t,e){return c(t,e,!0)}function c(t,e,n){if(0===e)return"";var o=0,i=[],r=!0,a=!!e;for(e||(e=Math.floor((t._length-t._index)/8));o<e;){var s=t.readUint8();if(0===s&&(r=!1,!a))break;r&&i.push(s),o++}var c=String.fromCharCode.apply(null,i);if(!n)return c;try{return decodeURIComponent(escape(c))}catch(t){return c}}function l(t,e,n){for(var o=n||e.length+1,i=0;i<o;i++)t.writeUint8(i<e.length?e.charCodeAt(i):0)}function u(t,e,n){for(var o=p(e),i=n||o.length+1,r=0;r<i;r++)t.writeUint8(r<o.length?o[r]:0)}function p(t){var e,n,o=[];for(e=0;e<t.length;e++)(n=t.charCodeAt(e))<=127?o.push(n):n<=2047?(o.push(n>>6|192),o.push(63&n|128)):n<=65535?(o.push(n>>12|224),o.push(n>>6&63|128),o.push(63&n|128)):(o.push(n>>18|240),o.push(n>>12&63|128),o.push(n>>6&63|128),o.push(63&n|128));return o}var f=function(){function e(e,n,a){this.readBoolean=i("getBoolean",1),this.readInt8=i("getInt8",8),this.readUint8=i("getUint8",8),this.readInt16=i("getInt16",16),this.readUint16=i("getUint16",16),this.readInt32=i("getInt32",32),this.readUint32=i("getUint32",32),this.readFloat32=i("getFloat32",32),this.readFloat64=i("getFloat64",64),this.writeBoolean=r("setBoolean",1),this.writeInt8=r("setInt8",8),this.writeUint8=r("setUint8",8),this.writeInt16=r("setInt16",16),this.writeUint16=r("setUint16",16),this.writeInt32=r("setInt32",32),this.writeUint32=r("setUint32",32),this.writeFloat32=r("setFloat32",32),this.writeFloat64=r("setFloat64",64);var s=e instanceof ArrayBuffer||void 0!==t&&e instanceof t;if(!(e instanceof o||s))throw new Error("Must specify a valid BitView, ArrayBuffer or Buffer");this._view=s?new o(e,n,a):e,this._index=0,this._startIndex=0,this._length=8*this._view.byteLength}return Object.defineProperty(e.prototype,"index",{get:function(){return this._index-this._startIndex},set:function(t){this._index=t+this._startIndex},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._length-this._startIndex},set:function(t){this._length=t+this._startIndex},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bitsLeft",{get:function(){return this._length-this._index},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"byteIndex",{get:function(){return Math.ceil(this._index/8)},set:function(t){this._index=8*t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buffer",{get:function(){return this._view.buffer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"view",{get:function(){return this._view},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bigEndian",{get:function(){return this._view.bigEndian},set:function(t){this._view.bigEndian=t},enumerable:!0,configurable:!0}),e.prototype.readBits=function(t,e){var n=this._view.getBits(this._index,t,e);return this._index+=t,n},e.prototype.writeBits=function(t,e){this._view.setBits(this._index,t,e),this._index+=e},e.prototype.readASCIIString=function(t){return a(this,t)},e.prototype.readUTF8String=function(t){return s(this,t)},e.prototype.writeASCIIString=function(t,e){l(this,t,e)},e.prototype.writeUTF8String=function(t,e){u(this,t,e)},e.prototype.readBitStream=function(t){var n=new e(this._view);return n._startIndex=this._index,n._index=this._index,n.length=t,this._index+=t,n},e.prototype.writeBitStream=function(t,e,n){var o;for(e||(e=t.bitsLeft),"number"==typeof n&&(t.index=n);e>0;)o=Math.min(e,32),this.writeBits(t.readBits(o),o),e-=o},e.prototype.readArrayBuffer=function(t){var e=this._view.getArrayBuffer(this._index,t);return this._index+=8*t,e},e.prototype.writeArrayBuffer=function(t,n){this.writeBitStream(new e(t),8*n)},e}();n.BitStream=f,cc._RF.pop()}).call(this,t("buffer").Buffer)},{buffer:2}],ClientRequest:[function(t,e,n){"use strict";cc._RF.push(e,"25ce3vSedBLC4x2e9bQXvjy","ClientRequest");var o=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var i=cc._decorator,r=i.ccclass,a=(i.property,function(){function t(){}var e;return e=t,t.prototype.StartRequest=function(t,n){e.ms_client&&e.ms_client.sendRequest(t,n)},t.prototype.onGameInfo=function(t){console.log("ClientRequest - onGameInfo")},t.prototype.onJoinGame=function(t){},t.prototype.onServerData=function(t){},t.prototype.onError=function(t){},t.prototype.onDeath=function(t){},t.prototype.onNotiMessage=function(t){},t.prototype.onLeaderboardChange=function(t){},t.ms_client=null,t=e=o([r],t)}());n.ClientRequest=a,cc._RF.pop()},{}],ConfigGame:[function(t,e,n){"use strict";cc._RF.push(e,"74641lUXttOLp2HhJBr9F5T","ConfigGame"),Object.defineProperty(n,"__esModule",{value:!0}),function(t){t.FPS=30,t.TILE_SIZE=64,t.WORLD_WIDTH=28*t.TILE_SIZE,t.WORLD_HEIGHT=28*t.TILE_SIZE,t.BOSS_COUNT=10,t.BOSS_CHANGEDIR_FRQ=3,t.BOSS_FIREBOMB_FRQ=5,t.PLAYER_WIDTH=26,t.PLAYER_HALF_W=t.PLAYER_WIDTH/2,t.PLAYER_HEIGHT=29.25,t.PLAYER_HALF_H=t.PLAYER_HEIGHT/2,t.PLAYER_SPEED=200,t.PLAYER_START_HEALTH=70,t.PLAYER_EXP_GAIN_BASE=50,t.PLAYER_LEVEL_MAX=6,t.BOMB_SPEED=480,t.BOMB_RANGE=52,t.BOMB_LENGTH=212.5,t.BOMB_BASE_DAMGE=50,t.EXP_BUBLE_WIDTH=10,t.EXP_BUBLE_HEIGHT=10,t.EXP_BUBLE_EXP=5,t.EXP_BUBLE_PER_SCREEN=5,t.EXP_BUBLE_COUNT=t.EXP_BUBLE_PER_SCREEN*Math.round(t.WORLD_WIDTH*t.WORLD_HEIGHT/614400),t.PLAYER_SKILL_COOLDOWN=5,t.PLAYERS_AS_TARGET=3,t.BURN_DAMAGE=5,t.BURN_INTERVAL=1,t.SLOW_PERCENT=.5,t.EFFECT_DURATION=[0,15,10,10,10,5,5,3],t.OBSTACLES=[[[2,2,3,3]],[[8,2,6,2]],[[18,2,6,2],[23,2,3,3]],[[9,9,9,4]],[[1,14,5,2]],[[22,15,5,2]],[[12,17,5,4]],[[2,20,3,6],[4,24,6,2]],[[18,24,6,2],[23,22,3,4]]],t.getDamge=function(e){return t.BOMB_BASE_DAMGE},t.getExpGain=function(e){for(var n=t.PLAYER_EXP_GAIN_BASE,o=2;o<=e;o++)n+=t.PLAYER_EXP_GAIN_BASE/2;return n},t.getHealth=function(e){return t.PLAYER_START_HEALTH*e},t.getLevelExp=function(t){return 100*Math.pow(2,t-1)}}(n.ConfigGame||(n.ConfigGame={})),cc._RF.pop()},{}],1:[function(t,e,n){"use strict";n.byteLength=function(t){var e=l(t),n=e[0],o=e[1];return 3*(n+o)/4-o},n.toByteArray=function(t){var e,n,o=l(t),a=o[0],s=o[1],c=new r(u(t,a,s)),p=0,f=s>0?a-4:a;for(n=0;n<f;n+=4)e=i[t.charCodeAt(n)]<<18|i[t.charCodeAt(n+1)]<<12|i[t.charCodeAt(n+2)]<<6|i[t.charCodeAt(n+3)],c[p++]=e>>16&255,c[p++]=e>>8&255,c[p++]=255&e;2===s&&(e=i[t.charCodeAt(n)]<<2|i[t.charCodeAt(n+1)]>>4,c[p++]=255&e);1===s&&(e=i[t.charCodeAt(n)]<<10|i[t.charCodeAt(n+1)]<<4|i[t.charCodeAt(n+2)]>>2,c[p++]=e>>8&255,c[p++]=255&e);return c},n.fromByteArray=function(t){for(var e,n=t.length,i=n%3,r=[],a=0,s=n-i;a<s;a+=16383)r.push(f(t,a,a+16383>s?s:a+16383));1===i?(e=t[n-1],r.push(o[e>>2]+o[e<<4&63]+"==")):2===i&&(e=(t[n-2]<<8)+t[n-1],r.push(o[e>>10]+o[e>>4&63]+o[e<<2&63]+"="));return r.join("")};for(var o=[],i=[],r="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,c=a.length;s<c;++s)o[s]=a[s],i[a.charCodeAt(s)]=s;function l(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function u(t,e,n){return 3*(e+n)/4-n}function p(t){return o[t>>18&63]+o[t>>12&63]+o[t>>6&63]+o[63&t]}function f(t,e,n){for(var o,i=[],r=e;r<n;r+=3)o=(t[r]<<16&16711680)+(t[r+1]<<8&65280)+(255&t[r+2]),i.push(p(o));return i.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},{}],2:[function(t,e,n){(function(e){"use strict";var o=t("base64-js"),i=t("ieee754"),r=t("isarray");function a(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(t,e){if(a()<e)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=c.prototype:(null===t&&(t=new c(e)),t.length=e),t}function c(t,e,n){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return f(this,t)}return l(this,t,e,n)}function l(t,e,n,o){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?y(t,e,n,o):"string"==typeof e?h(t,e,n):g(t,e)}function u(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function p(t,e,n,o){return u(e),e<=0?s(t,e):void 0!==n?"string"==typeof o?s(t,e).fill(n,o):s(t,e).fill(n):s(t,e)}function f(t,e){if(u(e),t=s(t,e<0?0:0|_(e)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function h(t,e,n){if("string"==typeof n&&""!==n||(n="utf8"),!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var o=0|m(e,n),i=(t=s(t,o)).write(e,n);return i!==o&&(t=t.slice(0,i)),t}function d(t,e){var n=e.length<0?0:0|_(e.length);t=s(t,n);for(var o=0;o<n;o+=1)t[o]=255&e[o];return t}function y(t,e,n,o){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(o||0))throw new RangeError("'length' is out of bounds");return e=void 0===n&&void 0===o?new Uint8Array(e):void 0===o?new Uint8Array(e,n):new Uint8Array(e,n,o),c.TYPED_ARRAY_SUPPORT?(t=e).__proto__=c.prototype:t=d(t,e),t}function g(t,e){if(c.isBuffer(e)){var n=0|_(e.length);return 0===(t=s(t,n)).length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||$(e.length)?s(t,0):d(t,e);if("Buffer"===e.type&&r(e.data))return d(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function _(t){if(t>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|t}function m(t,e){if(c.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var o=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return Z(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return J(t).length;default:if(o)return Z(t).length;e=(""+e).toLowerCase(),o=!0}}function b(t,e,n){var o=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return M(this,e,n);case"utf8":case"utf-8":return k(this,e,n);case"ascii":return A(this,e,n);case"latin1":case"binary":return N(this,e,n);case"base64":return O(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,e,n);default:if(o)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),o=!0}}function v(t,e,n){var o=t[e];t[e]=t[n],t[n]=o}function P(t,e,n,o,i){if(0===t.length)return-1;if("string"==typeof n?(o=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=c.from(e,o)),c.isBuffer(e))return 0===e.length?-1:w(t,e,n,o,i);if("number"==typeof e)return e&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):w(t,[e],n,o,i);throw new TypeError("val must be string, number or Buffer")}function w(t,e,n,o,i){var r,a=1,s=t.length,c=e.length;if(void 0!==o&&("ucs2"===(o=String(o).toLowerCase())||"ucs-2"===o||"utf16le"===o||"utf-16le"===o)){if(t.length<2||e.length<2)return-1;a=2,s/=2,c/=2,n/=2}function l(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(i){var u=-1;for(r=n;r<s;r++)if(l(t,r)===l(e,-1===u?0:r-u)){if(-1===u&&(u=r),r-u+1===c)return u*a}else-1!==u&&(r-=r-u),u=-1}else for(n+c>s&&(n=s-c),r=n;r>=0;r--){for(var p=!0,f=0;f<c;f++)if(l(t,r+f)!==l(e,f)){p=!1;break}if(p)return r}return-1}function S(t,e,n,o){n=Number(n)||0;var i=t.length-n;o?(o=Number(o))>i&&(o=i):o=i;var r=e.length;if(r%2!=0)throw new TypeError("Invalid hex string");o>r/2&&(o=r/2);for(var a=0;a<o;++a){var s=parseInt(e.substr(2*a,2),16);if(isNaN(s))return a;t[n+a]=s}return a}function C(t,e,n,o){return Q(Z(e,t.length-n),t,n,o)}function T(t,e,n,o){return Q(X(e),t,n,o)}function R(t,e,n,o){return T(t,e,n,o)}function E(t,e,n,o){return Q(J(e),t,n,o)}function B(t,e,n,o){return Q(V(e,t.length-n),t,n,o)}function O(t,e,n){return 0===e&&n===t.length?o.fromByteArray(t):o.fromByteArray(t.slice(e,n))}function k(t,e,n){n=Math.min(t.length,n);for(var o=[],i=e;i<n;){var r,a,s,c,l=t[i],u=null,p=l>239?4:l>223?3:l>191?2:1;if(i+p<=n)switch(p){case 1:l<128&&(u=l);break;case 2:128==(192&(r=t[i+1]))&&(c=(31&l)<<6|63&r)>127&&(u=c);break;case 3:r=t[i+1],a=t[i+2],128==(192&r)&&128==(192&a)&&(c=(15&l)<<12|(63&r)<<6|63&a)>2047&&(c<55296||c>57343)&&(u=c);break;case 4:r=t[i+1],a=t[i+2],s=t[i+3],128==(192&r)&&128==(192&a)&&128==(192&s)&&(c=(15&l)<<18|(63&r)<<12|(63&a)<<6|63&s)>65535&&c<1114112&&(u=c)}null===u?(u=65533,p=1):u>65535&&(u-=65536,o.push(u>>>10&1023|55296),u=56320|1023&u),o.push(u),i+=p}return x(o)}n.Buffer=c,n.SlowBuffer=function(t){+t!=t&&(t=0);return c.alloc(+t)},n.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),n.kMaxLength=a(),c.poolSize=8192,c._augment=function(t){return t.__proto__=c.prototype,t},c.from=function(t,e,n){return l(null,t,e,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(t,e,n){return p(null,t,e,n)},c.allocUnsafe=function(t){return f(null,t)},c.allocUnsafeSlow=function(t){return f(null,t)},c.isBuffer=function(t){return!(null==t||!t._isBuffer)},c.compare=function(t,e){if(!c.isBuffer(t)||!c.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,o=e.length,i=0,r=Math.min(n,o);i<r;++i)if(t[i]!==e[i]){n=t[i],o=e[i];break}return n<o?-1:o<n?1:0},c.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(t,e){if(!r(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return c.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var o=c.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var a=t[n];if(!c.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(o,i),i+=a.length}return o},c.byteLength=m,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)v(this,e,e+1);return this},c.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)v(this,e,e+3),v(this,e+1,e+2);return this},c.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)v(this,e,e+7),v(this,e+1,e+6),v(this,e+2,e+5),v(this,e+3,e+4);return this},c.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?k(this,0,t):b.apply(this,arguments)},c.prototype.equals=function(t){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===c.compare(this,t)},c.prototype.inspect=function(){var t="",e=n.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},c.prototype.compare=function(t,e,n,o,i){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===o&&(o=0),void 0===i&&(i=this.length),e<0||n>t.length||o<0||i>this.length)throw new RangeError("out of range index");if(o>=i&&e>=n)return 0;if(o>=i)return-1;if(e>=n)return 1;if(e>>>=0,n>>>=0,o>>>=0,i>>>=0,this===t)return 0;for(var r=i-o,a=n-e,s=Math.min(r,a),l=this.slice(o,i),u=t.slice(e,n),p=0;p<s;++p)if(l[p]!==u[p]){r=l[p],a=u[p];break}return r<a?-1:a<r?1:0},c.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},c.prototype.indexOf=function(t,e,n){return P(this,t,e,n,!0)},c.prototype.lastIndexOf=function(t,e,n){return P(this,t,e,n,!1)},c.prototype.write=function(t,e,n,o){if(void 0===e)o="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)o=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===o&&(o="utf8")):(o=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");o||(o="utf8");for(var r=!1;;)switch(o){case"hex":return S(this,t,e,n);case"utf8":case"utf-8":return C(this,t,e,n);case"ascii":return T(this,t,e,n);case"latin1":case"binary":return R(this,t,e,n);case"base64":return E(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,t,e,n);default:if(r)throw new TypeError("Unknown encoding: "+o);o=(""+o).toLowerCase(),r=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var I=4096;function x(t){var e=t.length;if(e<=I)return String.fromCharCode.apply(String,t);for(var n="",o=0;o<e;)n+=String.fromCharCode.apply(String,t.slice(o,o+=I));return n}function A(t,e,n){var o="";n=Math.min(t.length,n);for(var i=e;i<n;++i)o+=String.fromCharCode(127&t[i]);return o}function N(t,e,n){var o="";n=Math.min(t.length,n);for(var i=e;i<n;++i)o+=String.fromCharCode(t[i]);return o}function M(t,e,n){var o=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>o)&&(n=o);for(var i="",r=e;r<n;++r)i+=W(t[r]);return i}function L(t,e,n){for(var o=t.slice(e,n),i="",r=0;r<o.length;r+=2)i+=String.fromCharCode(o[r]+256*o[r+1]);return i}function D(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function F(t,e,n,o,i,r){if(!c.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<r)throw new RangeError('"value" argument is out of bounds');if(n+o>t.length)throw new RangeError("Index out of range")}function j(t,e,n,o){e<0&&(e=65535+e+1);for(var i=0,r=Math.min(t.length-n,2);i<r;++i)t[n+i]=(e&255<<8*(o?i:1-i))>>>8*(o?i:1-i)}function U(t,e,n,o){e<0&&(e=4294967295+e+1);for(var i=0,r=Math.min(t.length-n,4);i<r;++i)t[n+i]=e>>>8*(o?i:3-i)&255}function q(t,e,n,o,i,r){if(n+o>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function G(t,e,n,o,r){return r||q(t,0,n,4),i.write(t,e,n,o,23,4),n+4}function Y(t,e,n,o,r){return r||q(t,0,n,8),i.write(t,e,n,o,52,8),n+8}c.prototype.slice=function(t,e){var n,o=this.length;if(t=~~t,e=void 0===e?o:~~e,t<0?(t+=o)<0&&(t=0):t>o&&(t=o),e<0?(e+=o)<0&&(e=0):e>o&&(e=o),e<t&&(e=t),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=c.prototype;else{var i=e-t;n=new c(i,void 0);for(var r=0;r<i;++r)n[r]=this[r+t]}return n},c.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||D(t,e,this.length);for(var o=this[t],i=1,r=0;++r<e&&(i*=256);)o+=this[t+r]*i;return o},c.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||D(t,e,this.length);for(var o=this[t+--e],i=1;e>0&&(i*=256);)o+=this[t+--e]*i;return o},c.prototype.readUInt8=function(t,e){return e||D(t,1,this.length),this[t]},c.prototype.readUInt16LE=function(t,e){return e||D(t,2,this.length),this[t]|this[t+1]<<8},c.prototype.readUInt16BE=function(t,e){return e||D(t,2,this.length),this[t]<<8|this[t+1]},c.prototype.readUInt32LE=function(t,e){return e||D(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},c.prototype.readUInt32BE=function(t,e){return e||D(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},c.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||D(t,e,this.length);for(var o=this[t],i=1,r=0;++r<e&&(i*=256);)o+=this[t+r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},c.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||D(t,e,this.length);for(var o=e,i=1,r=this[t+--o];o>0&&(i*=256);)r+=this[t+--o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},c.prototype.readInt8=function(t,e){return e||D(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},c.prototype.readInt16LE=function(t,e){e||D(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(t,e){e||D(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(t,e){return e||D(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},c.prototype.readInt32BE=function(t,e){return e||D(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},c.prototype.readFloatLE=function(t,e){return e||D(t,4,this.length),i.read(this,t,!0,23,4)},c.prototype.readFloatBE=function(t,e){return e||D(t,4,this.length),i.read(this,t,!1,23,4)},c.prototype.readDoubleLE=function(t,e){return e||D(t,8,this.length),i.read(this,t,!0,52,8)},c.prototype.readDoubleBE=function(t,e){return e||D(t,8,this.length),i.read(this,t,!1,52,8)},c.prototype.writeUIntLE=function(t,e,n,o){(t=+t,e|=0,n|=0,o)||F(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,r=0;for(this[e]=255&t;++r<n&&(i*=256);)this[e+r]=t/i&255;return e+n},c.prototype.writeUIntBE=function(t,e,n,o){(t=+t,e|=0,n|=0,o)||F(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,r=1;for(this[e+i]=255&t;--i>=0&&(r*=256);)this[e+i]=t/r&255;return e+n},c.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,1,255,0),c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},c.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):j(this,t,e,!0),e+2},c.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):j(this,t,e,!1),e+2},c.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):U(this,t,e,!0),e+4},c.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):U(this,t,e,!1),e+4},c.prototype.writeIntLE=function(t,e,n,o){if(t=+t,e|=0,!o){var i=Math.pow(2,8*n-1);F(this,t,e,n,i-1,-i)}var r=0,a=1,s=0;for(this[e]=255&t;++r<n&&(a*=256);)t<0&&0===s&&0!==this[e+r-1]&&(s=1),this[e+r]=(t/a>>0)-s&255;return e+n},c.prototype.writeIntBE=function(t,e,n,o){if(t=+t,e|=0,!o){var i=Math.pow(2,8*n-1);F(this,t,e,n,i-1,-i)}var r=n-1,a=1,s=0;for(this[e+r]=255&t;--r>=0&&(a*=256);)t<0&&0===s&&0!==this[e+r+1]&&(s=1),this[e+r]=(t/a>>0)-s&255;return e+n},c.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,1,127,-128),c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},c.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):j(this,t,e,!0),e+2},c.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):j(this,t,e,!1),e+2},c.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):U(this,t,e,!0),e+4},c.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):U(this,t,e,!1),e+4},c.prototype.writeFloatLE=function(t,e,n){return G(this,t,e,!0,n)},c.prototype.writeFloatBE=function(t,e,n){return G(this,t,e,!1,n)},c.prototype.writeDoubleLE=function(t,e,n){return Y(this,t,e,!0,n)},c.prototype.writeDoubleBE=function(t,e,n){return Y(this,t,e,!1,n)},c.prototype.copy=function(t,e,n,o){if(n||(n=0),o||0===o||(o=this.length),e>=t.length&&(e=t.length),e||(e=0),o>0&&o<n&&(o=n),o===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(o<0)throw new RangeError("sourceEnd out of bounds");o>this.length&&(o=this.length),t.length-e<o-n&&(o=t.length-e+n);var i,r=o-n;if(this===t&&n<e&&e<o)for(i=r-1;i>=0;--i)t[i+e]=this[i+n];else if(r<1e3||!c.TYPED_ARRAY_SUPPORT)for(i=0;i<r;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+r),e);return r},c.prototype.fill=function(t,e,n,o){if("string"==typeof t){if("string"==typeof e?(o=e,e=0,n=this.length):"string"==typeof n&&(o=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==o&&"string"!=typeof o)throw new TypeError("encoding must be a string");if("string"==typeof o&&!c.isEncoding(o))throw new TypeError("Unknown encoding: "+o)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var r;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(r=e;r<n;++r)this[r]=t;else{var a=c.isBuffer(t)?t:Z(new c(t,o).toString()),s=a.length;for(r=0;r<n-e;++r)this[r+e]=a[r%s]}return this};var H=/[^+\/0-9A-Za-z-_]/g;function z(t){if((t=K(t).replace(H,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}function K(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function W(t){return t<16?"0"+t.toString(16):t.toString(16)}function Z(t,e){var n;e=e||1/0;for(var o=t.length,i=null,r=[],a=0;a<o;++a){if((n=t.charCodeAt(a))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&r.push(239,191,189);continue}if(a+1===o){(e-=3)>-1&&r.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&r.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&r.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;r.push(n)}else if(n<2048){if((e-=2)<0)break;r.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;r.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;r.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return r}function X(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}function V(t,e){for(var n,o,i,r=[],a=0;a<t.length&&!((e-=2)<0);++a)o=(n=t.charCodeAt(a))>>8,i=n%256,r.push(i),r.push(o);return r}function J(t){return o.toByteArray(z(t))}function Q(t,e,n,o){for(var i=0;i<o&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}function $(t){return t!=t}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":1,ieee754:4,isarray:3}],3:[function(t,e,n){var o={}.toString;e.exports=Array.isArray||function(t){return"[object Array]"==o.call(t)}},{}],4:[function(t,e,n){n.read=function(t,e,n,o,i){var r,a,s=8*i-o-1,c=(1<<s)-1,l=c>>1,u=-7,p=n?i-1:0,f=n?-1:1,h=t[e+p];for(p+=f,r=h&(1<<-u)-1,h>>=-u,u+=s;u>0;r=256*r+t[e+p],p+=f,u-=8);for(a=r&(1<<-u)-1,r>>=-u,u+=o;u>0;a=256*a+t[e+p],p+=f,u-=8);if(0===r)r=1-l;else{if(r===c)return a?NaN:1/0*(h?-1:1);a+=Math.pow(2,o),r-=l}return(h?-1:1)*a*Math.pow(2,r-o)},n.write=function(t,e,n,o,i,r){var a,s,c,l=8*r-i-1,u=(1<<l)-1,p=u>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=o?0:r-1,d=o?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=u):(a=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-a))<1&&(a--,c*=2),(e+=a+p>=1?f/c:f*Math.pow(2,1-p))*c>=2&&(a++,c/=2),a+p>=u?(s=0,a=u):a+p>=1?(s=(e*c-1)*Math.pow(2,i),a+=p):(s=e*Math.pow(2,p-1)*Math.pow(2,i),a=0));i>=8;t[n+h]=255&s,h+=d,s/=256,i-=8);for(a=a<<i|s,l+=i;l>0;t[n+h]=255&a,h+=d,a/=256,l-=8);t[n+h-d]|=128*y}},{}],GameState:[function(t,e,n){"use strict";cc._RF.push(e,"bfa57IigspLtpwBbBINxljg","GameState");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=cc._decorator,a=r.ccclass,s=r.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.text="hello",e}return o(e,t),e.prototype.start=function(){},i([s(cc.Label)],e.prototype,"label",void 0),i([s],e.prototype,"text",void 0),e=i([a],e)}(cc.Component);n.default=c,cc._RF.pop()},{}],IMessageData:[function(t,e,n){"use strict";cc._RF.push(e,"32b89elwlZJ5b/n9IEFu6QS","IMessageData"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],JsonPacker:[function(t,e,n){"use strict";var o;cc._RF.push(e,"cb5a5rdgDhLyZPMemVjDxWp","JsonPacker"),Object.defineProperty(n,"__esModule",{value:!0});var i,r=t("./BitStream");(function(t){t[t.Bit=0]="Bit",t[t.UInt2=1]="UInt2",t[t.UInt3=2]="UInt3",t[t.UInt4=3]="UInt4",t[t.UInt5=4]="UInt5",t[t.UInt6=5]="UInt6",t[t.UInt7=6]="UInt7",t[t.UInt8=7]="UInt8",t[t.UInt9=8]="UInt9",t[t.UInt10=9]="UInt10",t[t.UInt11=10]="UInt11",t[t.UInt12=11]="UInt12",t[t.UInt13=12]="UInt13",t[t.UInt14=13]="UInt14",t[t.UInt15=14]="UInt15",t[t.UInt16=15]="UInt16",t[t.UInt32=16]="UInt32",t[t.String=17]="String",t[t.Binary=18]="Binary",t[t.PrimativeType=19]="PrimativeType",t[t.Object=20]="Object",t[t.Array=21]="Array"})(i||(i={}));var a=((o={})[i.Bit]=1,o[i.UInt2]=2,o[i.UInt3]=3,o[i.UInt4]=4,o[i.UInt5]=5,o[i.UInt6]=6,o[i.UInt7]=7,o[i.UInt8]=8,o[i.UInt9]=9,o[i.UInt10]=10,o[i.UInt11]=11,o[i.UInt12]=12,o[i.UInt13]=13,o[i.UInt14]=14,o[i.UInt15]=15,o[i.UInt16]=16,o[i.UInt32]=32,o[i.String]=8,o[i.Object]=0,o[i.Array]=8,o[i.Binary]=10,o),s={maxIdx:5,template:{emit:{index:1,type:i.Object,template:{event:{index:1,type:i.String},data:{index:2,type:i.Binary},cid:{index:5,type:i.UInt16}}},publish:{index:2,type:i.Object,template:{data:{index:2,type:i.Binary},channel:{index:3,type:i.String},cid:{index:5,type:i.UInt16}}},response:{index:3,type:i.Object,template:{data:{index:2,type:i.Binary},rid:{index:4,type:i.UInt16}}}}},c=function(){function t(){this.setProto(s)}return t.prototype.writePrimitive=function(t,e){t<i.PrimativeType?t==i.String?e&&"string"==typeof e?(this.stream.writeUint8(e.length),this.stream.writeASCIIString(e,e.length)):(console.warn("Not valid string type"),this.stream.writeUint8(0)):t==i.Binary?e instanceof ArrayBuffer?(this.stream.writeBits(e.byteLength,10),this.stream.writeArrayBuffer(e,e.byteLength)):(console.warn("Not valid binary type ArrayBuffer"),this.stream.writeBits(0,10)):this.stream.writeBits(e,a[t]):console.warn("Do not support primitive type: "+t)},t.prototype.write=function(t,e){for(var n in t){var o=e[n];o?(this.stream.writeBits(o.index,this.indexBit),o.type<i.PrimativeType?this.writePrimitive(o.type,t[n]):o.type==i.Object?(this.write(t[n],o.template),this.stream.writeBits(0,this.indexBit)):console.warn("Not support write type: "+o.type)):console.warn("Key ["+n+"] not found in template")}},t.prototype.readPrimitive=function(t){if(t<i.PrimativeType){if(t==i.String)return 0==(e=this.stream.readUint8())?null:this.stream.readASCIIString(e);if(t==i.Binary){var e=this.stream.readBits(10);return this.stream.readArrayBuffer(e)}return this.stream.readBits(a[t])}return null},t.prototype.read=function(t){for(var e={};this.stream.bitsLeft>this.indexBit;){var n=this.stream.readBits(this.indexBit);if(0==n)break;var o=t.keyIndex_[n];if(t[o].type<i.PrimativeType){var r=this.readPrimitive(t[o].type);e[o]=r}else t[o].type==i.Object?e[o]=this.read(t[o].template):console.warn("Not support read type: "+t[o].type)}return e},t.prototype.updateKeyIndex=function(t){if(t.template)for(var e in t.template.keyIndex_={},t.template){var n=t.template[e];t.template.keyIndex_[n.index]=e,n.template&&this.updateKeyIndex(n)}},t.prototype.setProto=function(t){return t.maxIdx&&t.template?(this.proto=t,this.indexBit=Math.floor(Math.log2(t.maxIdx))+1,this.updateKeyIndex(t),this):(console.warn("Invalid proto"),null)},t.prototype.pack=function(t){return this.stream=new r.BitStream(new ArrayBuffer(512)),this.write(t,this.proto.template),this.stream.view.getArrayBuffer(0,this.stream.byteIndex)},t.prototype.unpack=function(t){return this.stream=new r.BitStream(t),this.read(this.proto.template)},t}();n.JsonPacker=c,cc._RF.pop()},{"./BitStream":"BitStream"}],LabelLocalized:[function(t,e,n){"use strict";cc._RF.push(e,"7b2e4HVWKBCIaBIbtjNKeSy","LabelLocalized");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=cc._decorator,a=r.ccclass,s=r.property,c=r.requireComponent,l=r.executeInEditMode,u=r.menu,p=t("i18n"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._textKey="TEXT_KEY",e.label=null,e.textProp=null,e}return o(e,t),Object.defineProperty(e.prototype,"textKey",{get:function(){return this._textKey},set:function(t){this._textKey=t,this.updateLabel()},enumerable:!0,configurable:!0}),e.prototype.onLoad=function(){this.label=this.getComponent(cc.Label),this.updateLabel()},e.prototype.updateLabel=function(){if(null==this.label&&(this.label=this.getComponent(cc.Label)),this.label){for(var t=this.textKey.trim().split("+"),e="",n=0;n<t.length;++n)e+=p.t(t[n],this.textProp);this.label.string=e}},e.prototype.updateTextProp=function(t){this.textProp=t,this.updateLabel()},i([s()],e.prototype,"_textKey",void 0),i([s({multiline:!0,tooltip:"Enter i18n text key"})],e.prototype,"textKey",null),e=i([a,c(cc.Label),l,u("i18n:MAIN_MENU.component.renderers/LabelLocalized")],e)}(cc.Component);n.default=f,cc._RF.pop()},{i18n:"i18n"}],NetMessage:[function(t,e,n){"use strict";cc._RF.push(e,"f6f9a3uQu9ODq4Y6H4Y+43k","NetMessage");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=t("./BitStream");(function(t){t.GameInfo="i",t.JoinGame="j",t.QueryPlayer="p",t.QueryBomb="b",t.LeaderBoard="l",t.InputAction="a",t.ServerData="s",t.Death="d",t.Notify="n"})(n.Message||(n.Message={}));var r=function(){function t(){}return t.prototype.pack=function(t){return null},t.prototype.unpack=function(t){return null},t}();n.NetMessage=r;var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r);n.MsgServerInfo=a;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.pack=function(t){if(!t)return null;var e=new i.BitStream(new ArrayBuffer(12));return e.writeUint16(t.worldW),e.writeUint16(t.worldH),e.writeUint16(t.playerW),e.writeUint16(t.playerH),e.writeUint16(t.playerSpeed),e.writeUint16(t.bombRange),e.view.getArrayBuffer(0,e.byteIndex)},e.prototype.unpack=function(t){if(!t)return null;var e=new i.BitStream(t);return{worldW:e.readUint16(),worldH:e.readUint16(),playerW:e.readUint16(),playerH:e.readUint16(),playerSpeed:e.readUint16(),bombRange:e.readUint16()}},e}(r);n.MsgGameInfo=s;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.pack=function(t){return t?t.getExtraData():null},e.prototype.unpack=function(t){if(!t)return null;var e=new i.BitStream(t);return{id:e.readBits(24),name:e.readUTF8String()}},e}(r);n.MsgQueryPlayer=c;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.pack=function(t){return t?t.getExtraData():null},e.prototype.unpack=function(t){if(!t)return null;var e=new i.BitStream(t);return{id:e.readBits(24),endX:e.readBits(16),endY:e.readBits(16),owner:e.readBits(24)}},e}(r);n.MsgQueryBomb=l;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.pack=function(t){if(!t)return null;var e=new i.BitStream(new ArrayBuffer(10));return e.writeBits(t.id,24),e.writeBits(t.x,16),e.writeBits(t.y,16),e.writeBits(t.startHealth,16),e.view.getArrayBuffer(0,e.byteIndex)},e.prototype.unpack=function(t){if(!t)return null;var e=new i.BitStream(t);return{id:e.readBits(24),x:e.readBits(16),y:e.readBits(16),startHealth:e.readBits(16)}},e}(r);n.MsgJoinGame=u;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.pack=function(t){if(!t)return null;var e=new i.BitStream(new ArrayBuffer(84));return e.writeUint8(t.length),t.forEach(function(t){e.writeBits(t.id,24),e.writeUTF8String(t.name),e.writeUint8(t.score)}),e.view.getArrayBuffer(0,e.byteIndex)},e.prototype.unpack=function(t){if(!t)return null;for(var e=[],n=t.split("|"),o=0;o<+n[0];o++)e.push({id:+n[3*o+1],name:n[3*o+2],score:+n[3*o+3]});return e},e}(r);n.MsgLeaderBoard=p;var f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.deserialPlayer=function(t,e){void 0===e&&(e=!1);var n={id:t.readBits(24),x:t.readBits(16),y:t.readBits(16),cskin:t.readBits(3),opacity:t.readBits(8),death:t.readBoolean(),action:t.readBits(3),direction:t.readBits(9),health:t.readBits(9),level:t.readBits(4),exp:5*t.readBits(16),vulnerable:t.readBoolean(),buff:t.readBits(3),buffs:[]};if(n.buff>0)for(var o=0;o<n.buff;o++)n.buffs.push(t.readBits(3));return e&&(n.bombable=t.readBoolean(),n.skillable=t.readBoolean(),n.cooldown=t.readBits(8),n.lastInputSeq=t.readBits(16)),n},e.prototype.deserialBomb=function(t){return{id:t.readBits(24),x:t.readBits(16),y:t.readBits(16),opacity:t.readBits(8),death:t.readBoolean(),percent:t.readBits(7),exploded:t.readBoolean(),skin:t.readBits(3)}},e.prototype.deserialExpBuble=function(t){return{id:t.readBits(24),x:t.readBits(16),y:t.readBits(16),opacity:t.readBits(8),death:t.readBoolean(),type:t.readBits(3)}},e.prototype.pack=function(t){return null},e.prototype.unpack=function(t){if(!t)return null;for(var e=new i.BitStream(t),n={players:[],bombs:[],bubles:[]},o=e.readUint8(),r=0;r<o;r++)n.players.push(this.deserialPlayer(e,0==r));var a=e.readUint8();for(r=0;r<a;r++)n.bombs.push(this.deserialBomb(e));var s=e.readUint8();for(r=0;r<s;r++)n.bubles.push(this.deserialExpBuble(e));return n},e}(r);n.MsgServerData=f;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.pack=function(t){if(!t)return null;var e=new i.BitStream(new ArrayBuffer(8));return e.writeBoolean(null!=t.direction),null!=t.direction&&e.writeBits(t.direction,9),e.writeBoolean(null!=t.time),null!=t.time&&e.writeBits(t.time,6),e.writeBoolean(null!=t.seq),null!=t.seq&&e.writeBits(t.seq,16),e.writeBoolean(null!=t.fire),null!=t.fire&&e.writeBits(t.fire,3),e.writeBoolean(null!=t.fire_dir),null!=t.fire_dir&&e.writeBits(t.fire_dir,9),e.writeBoolean(null!=t.fire_range),null!=t.fire_range&&e.writeBits(t.fire_range,8),e.view.getArrayBuffer(0,e.byteIndex)},e.prototype.unpack=function(t){if(!t)return null;var e=new i.BitStream(t),n={};return e.readBoolean()&&(n.direction=e.readBits(9)),e.readBoolean()&&(n.time=e.readBits(6)),e.readBoolean()&&(n.seq=e.readBits(16)),e.readBoolean()&&(n.fire=e.readBits(3)),e.readBoolean()&&(n.fire_dir=e.readBits(9)),e.readBoolean()&&(n.fire_range=e.readBits(8)),n.direction>360&&(n.direction=e.view.getBits(1,9,!0)),n.fire_dir>360&&(n.direction=e.view.getBits(39,9,!0)),n},e}(r);n.MsgInputAction=h;var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.pack=function(t){if(!t)return null;var e=new i.BitStream(new ArrayBuffer(16));return e.writeUTF8String(t.killer),e.writeUint16(t.time),e.writeUint8(t.score),e.view.getArrayBuffer(0,e.byteIndex)},e.prototype.unpack=function(t){if(!t)return null;var e=new i.BitStream(t);return{killer:e.readUTF8String(),time:e.readUint16(),score:e.readUint8()}},e}(r);n.MsgDeath=d;var y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.pack=function(t){return t?t.kill.killer+"|"+t.kill.deathman:null},e.prototype.unpack=function(t){if(!t)return null;var e=t.split("|");return{kill:{killer:e[0],deathman:e[1]}}},e}(r);n.MsgNofity=y,cc._RF.pop()},{"./BitStream":"BitStream"}],PersistentObject:[function(t,e,n){"use strict";cc._RF.push(e,"6de3cVKhstKZICJqyKuSugl","PersistentObject");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=cc._decorator,a=r.ccclass,s=(r.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.onLoad=function(){cc.game.addPersistRootNode(this.node)},e=i([a],e)}(cc.Component));n.default=s,cc._RF.pop()},{}],PingRequest:[function(t,e,n){"use strict";cc._RF.push(e,"da97dojRpNILJGouFHl6SPh","PingRequest");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=t("./ClientRequest"),r=function(t){function e(e){var n=t.call(this)||this;return n.m_callback=e,n}return o(e,t),e.prototype.start=function(){i.ClientRequest.ms_client.ping(this.m_callback)},e}(i.ClientRequest);n.default=r,cc._RF.pop()},{"./ClientRequest":"ClientRequest"}],RichTextLocalized:[function(t,e,n){"use strict";cc._RF.push(e,"a7eff8OjwNOL6lnQdtt4Djg","RichTextLocalized");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=t("./LabelLocalized"),a=cc._decorator,s=a.ccclass,c=(a.property,a.requireComponent),l=a.executeInEditMode,u=a.menu,p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.onLoad=function(){this.label=this.getComponent(cc.RichText),this.updateLabel()},e.prototype.updateLabel=function(){null==this.label&&(this.label=this.getComponent(cc.RichText)),t.prototype.updateLabel.call(this)},e=i([s,c(cc.RichText),u("i18n:MAIN_MENU.component.renderers/RichTextLocalized"),l],e)}(r.default);n.default=p,cc._RF.pop()},{"./LabelLocalized":"LabelLocalized"}],SCCustomCodec:[function(t,e,n){(function(o){"use strict";cc._RF.push(e,"1ccc1pZj9hGTqQio5Hw2LUe","SCCustomCodec"),Object.defineProperty(n,"__esModule",{value:!0});var i=t("./SCFormatter"),r=t("./JsonPacker"),a=function(){function t(){}return t.prototype.compressPublishPacket=function(t){"#publish"==t.event&&null!=t.data&&(t.publish={channel:t.data.channel,data:t.data.data},null!=t.cid&&(t.publish.cid=t.cid),delete t.event,delete t.data,delete t.cid)},t.prototype.decompressPublishPacket=function(t){null!=t.publish&&(t.event="#publish",t.data={channel:t.publish.channel,data:t.publish.data},null!=t.publish.cid&&(t.cid=t.publish.cid),delete t.publish)},t.prototype.compressEmitPacket=function(t){null!=t.event&&(t.emit={event:t.event,data:t.data},null!=t.cid&&(t.emit.cid=t.cid),delete t.event,delete t.data,delete t.cid)},t.prototype.decompressEmitPacket=function(t){null!=t.emit&&(t.event=t.emit.event,t.data=t.emit.data,null!=t.emit.cid&&(t.cid=t.emit.cid),delete t.emit)},t.prototype.compressResponsePacket=function(t){null!=t.rid&&(t.response={rid:t.rid,data:t.data},delete t.rid,delete t.error,delete t.data)},t.prototype.decompressResponsePacket=function(t){null!=t.response&&(t.rid=t.response.rid,t.data=t.response.data,delete t.response)},t.prototype.clonePacket=function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},t.prototype.formatSinglePacket=function(t){return t=this.clonePacket(t),this.compressPublishPacket(t),this.compressEmitPacket(t),this.compressResponsePacket(t),t},t.prototype.deformatSinglePacket=function(t){this.decompressEmitPacket(t),this.decompressPublishPacket(t),this.decompressResponsePacket(t)},t.prototype.encode=function(e){return e&&(e.data instanceof ArrayBuffer||e.data&&e.data.data instanceof ArrayBuffer)?t.packer.pack(this.formatSinglePacket(e)):i.scformatter.encode(e)},t.prototype.decode=function(e){if(e instanceof ArrayBuffer||void 0!==o&&e instanceof o){var n=t.packer.unpack(e);return this.deformatSinglePacket(n),n}return i.scformatter.decode(e)},t.packer=new r.JsonPacker,t}();n.SCCustomCodec=a,cc._RF.pop()}).call(this,t("buffer").Buffer)},{"./JsonPacker":"JsonPacker","./SCFormatter":"SCFormatter",buffer:2}],SCFormatter:[function(t,e,n){(function(t){"use strict";cc._RF.push(e,"aaf88z4pJJFubIVjlGTbYWU","SCFormatter"),Object.defineProperty(n,"__esModule",{value:!0});var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=/^[ \n\r\t]*[{\[]/,r=function(t){for(var e=new Uint8Array(t),n=e.length,i="",r=0;r<n;r+=3)i+=o[e[r]>>2],i+=o[(3&e[r])<<4|e[r+1]>>4],i+=o[(15&e[r+1])<<2|e[r+2]>>6],i+=o[63&e[r+2]];return n%3==2?i=i.substring(0,i.length-1)+"=":n%3==1&&(i=i.substring(0,i.length-2)+"=="),i},a=function(e,n){if(ArrayBuffer&&n instanceof ArrayBuffer)return{base64:!0,data:r(n)};if(void 0!==t){if(n instanceof t)return{base64:!0,data:n.toString("base64")};if(n&&"Buffer"===n.type&&Array.isArray(n.data))return{base64:!0,data:(t.from?t.from(n.data):new t(n.data)).toString("base64")}}return n},s=function(t){if(null==t)return null;if("#1"===t||"#2"===t)return t;var e=t.toString();if(!i.test(e))return e;try{return JSON.parse(e)}catch(t){}return e},c=function(t){return"#1"===t||"#2"===t?t:JSON.stringify(t,a)},l=function(){function t(){}return t.encode=c,t.decode=s,t}();n.scformatter=l,cc._RF.pop()}).call(this,t("buffer").Buffer)},{buffer:2}],SequenceManager:[function(t,e,n){"use strict";cc._RF.push(e,"38bcbPmfEtMp4KMK215iPeO","SequenceManager");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=t("./SequenceNode"),a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sequences=[],e.m_nodeIdx=0,e}return o(e,t),e.prototype.onLoad=function(){},e.prototype.update=function(t){this.updateNode(t)},e.prototype.push=function(t){this.sequences.push(t)},e.prototype.updateNode=function(t){if(this.m_nodeIdx<this.sequences.length){var e=this.sequences[this.m_nodeIdx];e.UpdateNode(t),e.IsFinished()&&this.m_nodeIdx++}},i([c(r.SequenceNode)],e.prototype,"sequences",void 0),e=i([s],e)}(cc.Component);n.default=l,cc._RF.pop()},{"./SequenceNode":"SequenceNode"}],SequenceNodeSerial:[function(t,e,n){"use strict";cc._RF.push(e,"897284yD9lEwZSQerNQ9mHv","SequenceNodeSerial");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=t("./SequenceNode"),a=cc._decorator,s=a.ccclass,c=(a.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sequences=[],e.m_nodeIdx=0,e}return o(e,t),e.prototype.UpdateNode=function(t){},e.prototype.IsFinished=function(){return this.m_nodeIdx==this.sequences.length},e.prototype.Finish=function(){},e=i([s],e)}(r.SequenceNode));n.default=c,cc._RF.pop()},{"./SequenceNode":"SequenceNode"}],SequenceNodeShowGreetingPopup:[function(t,e,n){"use strict";cc._RF.push(e,"fe89fDR1slD/ot+TQlk//I+","SequenceNodeShowGreetingPopup");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=t("./SequenceNodeShowSelectSkinPopup"),a=t("../../player-ref"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.ShowPopup=function(){this.main_menu.showGreetingPopup(),this.main_menu.selectSkinPopup_setTitle("WELCOME")},e.prototype.OnCloseButtonPressed=function(e,n){console.log("SequenceNodeShowGreetingPopup - OnCloseButtonPressed"),t.prototype.OnCloseButtonPressed.call(this,e,n),a.default.current.first_launch_step=1},e=i([c],e)}(r.SequenceNodeShowSelectSkinPopup));n.default=l,cc._RF.pop()},{"../../player-ref":"player-ref","./SequenceNodeShowSelectSkinPopup":"SequenceNodeShowSelectSkinPopup"}],SequenceNodeShowPopup:[function(t,e,n){"use strict";cc._RF.push(e,"adaebClck5K0rTxd9weYpE7","SequenceNodeShowPopup");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r,a=t("./SequenceNode"),s=cc._decorator,c=s.ccclass;s.property;(function(t){t[t.INITIALIZED=0]="INITIALIZED",t[t.STARTED=1]="STARTED",t[t.FINISHED=2]="FINISHED"})(r=n.SequenceNodeShowPopupState||(n.SequenceNodeShowPopupState={}));var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_state=r.INITIALIZED,e}return o(e,t),e.prototype.UpdateNode=function(t){this.m_state==r.INITIALIZED&&(this.SetupGUI(),this.CreateConnection(),this.ShowPopup(),this.m_state=r.STARTED)},e.prototype.IsFinished=function(){return this.m_state==r.FINISHED},e.prototype.OnCloseButtonPressed=function(t,e){console.log("SequenceNodeShowPopup - OnCloseButtonPressed"),this.m_state=r.FINISHED},e=i([c],e)}(a.SequenceNode);n.SequenceNodeShowPopup=l,cc._RF.pop()},{"./SequenceNode":"SequenceNode"}],SequenceNodeShowSelectSkinPopup:[function(t,e,n){"use strict";cc._RF.push(e,"8a6a8uzFdZBA7hkFdp9P6lN","SequenceNodeShowSelectSkinPopup");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=t("./SequenceNodeShowPopup"),a=t("../menu/main-menu"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.selectSkinPopup=null,e.main_menu=null,e}return o(e,t),e.prototype.SetupGUI=function(){this.m_closeButton=this.selectSkinPopup.children[1].getChildByName("close").getComponent(cc.Button)},e.prototype.CreateConnection=function(){console.log("SequenceNodeShowSelectSkinPopup - CreateConnection");var t=new cc.Component.EventHandler;t.target=this.node,t.component="SequenceNodeShowSelectSkinPopup",t.handler="OnCloseButtonPressed",this.m_closeEvent=this.m_closeButton.clickEvents.push(t)},e.prototype.Finish=function(){this.m_closeButton.clickEvents.splice(this.m_closeEvent,1)},i([l(cc.Node)],e.prototype,"selectSkinPopup",void 0),i([l(a.default)],e.prototype,"main_menu",void 0),e=i([c],e)}(r.SequenceNodeShowPopup);n.SequenceNodeShowSelectSkinPopup=u,cc._RF.pop()},{"../menu/main-menu":"main-menu","./SequenceNodeShowPopup":"SequenceNodeShowPopup"}],SequenceNodeShowServerSelectionPopup:[function(t,e,n){"use strict";cc._RF.push(e,"d6ca2uswqVAMpuokwz+P7dl","SequenceNodeShowServerSelectionPopup");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=t("./SequenceNodeShowSelectSkinPopup"),a=t("../../player-ref"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.ShowPopup=function(){this.main_menu.showServerSelectionPopup()},e.prototype.CreateConnection=function(){t.prototype.CreateConnection.call(this);var e=new cc.Component.EventHandler;e.target=this.node,e.component="SequenceNodeShowServerSelectionPopup",e.handler="OnJoinButtonPressed",this.m_closeEvent=this.m_closeButton.clickEvents.push(e)},e.prototype.OnCloseButtonPressed=function(e,n){t.prototype.OnCloseButtonPressed.call(this,e,n),a.default.current.first_launch_step=2},e.prototype.OnJoinButtonPressed=function(t,e){a.default.current.first_launch_step=2},e=i([c],e)}(r.SequenceNodeShowSelectSkinPopup));n.default=l,cc._RF.pop()},{"../../player-ref":"player-ref","./SequenceNodeShowSelectSkinPopup":"SequenceNodeShowSelectSkinPopup"}],SequenceNodeWait:[function(t,e,n){"use strict";cc._RF.push(e,"3e1e5ag/YhM9LCzWklqZw9c","SequenceNodeWait");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=t("./SequenceNode"),a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.delay=0,e.m_counter=0,e}return o(e,t),e.prototype.UpdateNode=function(t){this.m_counter+=t},e.prototype.IsFinished=function(){return this.m_counter>=this.delay},e.prototype.Finish=function(){},i([c],e.prototype,"delay",void 0),e=i([s],e)}(r.SequenceNode);n.default=l,cc._RF.pop()},{"./SequenceNode":"SequenceNode"}],SequenceNode:[function(t,e,n){"use strict";cc._RF.push(e,"0f923ZGbKlG5o4hWu7v7XcA","SequenceNode");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=cc._decorator,a=r.ccclass,s=(r.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e=i([a],e)}(cc.Component));n.SequenceNode=s,cc._RF.pop()},{}],ServerConnectionRequest:[function(t,e,n){"use strict";cc._RF.push(e,"7d858k/2iBHB4R/bDhLQr1f","ServerConnectionRequest");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=t("./ClientRequest"),r=t("../multiplayer/client"),a=function(t){function e(e,n,o,i){void 0===o&&(o=null),void 0===i&&(i=!1);var r=t.call(this)||this;return r.m_desc=e,r.m_onSuccessed=n,r.m_onFailed=o,r.m_force=i,r}return o(e,t),e.prototype.start=function(){i.ClientRequest.ms_client=new r.default(this),i.ClientRequest.ms_client.connectToHost(this.m_desc,this.m_onSuccessed,this.m_onFailed,this.m_force)},e}(i.ClientRequest);n.default=a,cc._RF.pop()},{"../multiplayer/client":"client","./ClientRequest":"ClientRequest"}],ServerDisconnectionRequest:[function(t,e,n){"use strict";cc._RF.push(e,"9c4aeiD44NLS7mblE7Msx7+","ServerDisconnectionRequest");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=t("./ClientRequest"),a=cc._decorator,s=a.ccclass,c=(a.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.start=function(){r.ClientRequest.ms_client&&r.ClientRequest.ms_client.disconnect()},e=i([s],e)}(r.ClientRequest));n.default=c,cc._RF.pop()},{"./ClientRequest":"ClientRequest"}],ServerInfoRequest:[function(t,e,n){"use strict";cc._RF.push(e,"291d8agWJpA+KerJoT/B27Q","ServerInfoRequest");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(e){var n=t.call(this)||this;return n.m_callback=e,n}return o(e,t),e.prototype.start=function(){var t=this;this.StartRequest("t",function(e,n){t.m_callback(t.ParseData(n))})},e.prototype.ParseData=function(t){return{player_count:t+1}},e}(t("./ClientRequest").ClientRequest);n.default=i,cc._RF.pop()},{"./ClientRequest":"ClientRequest"}],bomb:[function(t,e,n){"use strict";cc._RF.push(e,"47fadUdEUtCbqrq11ncr/QH","bomb");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=t("./game"),a=t("./net-component"),s=t("../core/event-manager"),c=t("./ConfigGame"),l=t("./tutorial");(function(t){t[t.None=0]="None",t[t.Immune=1]="Immune",t[t.DmgX2=2]="DmgX2",t[t.DefX2=3]="DefX2",t[t.ExpX2=4]="ExpX2",t[t.Burn=5]="Burn",t[t.Slow=6]="Slow",t[t.Bind=7]="Bind"})(n.Effect||(n.Effect={}));var u=cc._decorator,p=u.ccclass,f=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ownerId=0,e.targetPos=null,e.exploded=!1,e.timePercent=0,e.skin=0,e.collider=null,e.fire_angle=0,e.fire_range=0,e.owner=null,e.applyDamge=!1,e.damage=c.ConfigGame.BOMB_BASE_DAMGE,e.skill=null,e.opacity=255,e.startPos=null,e.endPos=null,e.timeFlight=c.ConfigGame.BOMB_LENGTH/c.ConfigGame.BOMB_SPEED,e.time=0,e.extraData=null,e._exploded=!1,e._flying=!0,e.explosion_anim=["fire_explosion","ice_explosion","grass_explosion"],e.fly_anim=["fire_fly","ice_fly","grass_fly"],e}return o(e,t),e.prototype.onCollisionEnter=function(t,e){this.collider&&(this.collider.radius=0,this.collider.enabled=!1)},e.prototype.onCollisionExit=function(t,e){this.collider&&(this.collider.radius=0,this.collider.enabled=!1)},e.prototype.start=function(){this.animation=this.getComponent(cc.Animation)},e.prototype.init=function(e){t.prototype.init.call(this,e),this.node.opacity=e.opacity,this.timePercent=e.percent,this.exploded=e.exploded,this.skin=e.skin,this.node.setPosition(e.x,e.y),r.default.isTutorial&&this.setStartPos(e.x,e.y)},e.prototype.setStateData=function(e){t.prototype.setStateData.call(this,e),this.node.setPosition(e.x,e.y),r.default.isTutorial&&this.setStartPos(e.x,e.y),this.node.opacity=e.opacity,this.timePercent=e.percent,this.exploded=e.exploded,this.skin=e.skin},e.prototype.setExtraData=function(t){this.ownerId=t.owner,this.setTargetPos(t.endX,t.endY)},e.prototype.setTargetPos=function(t,e){this.targetPos=cc.v2(t,e)},e.prototype.update=function(t){if(r.default.isTutorial&&null!=this.endPos){if(0==this.exploded){if(this.time>=this.timeFlight/2&&l.default.tutorial_status==l.TUTORIAL_STATE.Tutorial_skill&&l.default.tutorial_sub_status<=l.TUTORIAL_SUB_STATE.Tutorial_checkdoAction&&l.default.instance.performAction<=1)return void(0==l.default.instance.performAction&&(l.default.instance.performAction=1));this.time+=t,this.time>=this.timeFlight&&(this.exploded=!0)}var e=this.startPos.lerp(this.endPos,this.time/this.timeFlight);this.node.x=Math.round(e.x),this.node.y=Math.round(e.y),this.timePercent=this.time/this.timeFlight*100}this._flying&&(this.animation.play(this.fly_anim[this.skin]),this._flying=!1);var n=cc.misc.lerp(.75,1,cc.misc.clamp01(this.timePercent>50?(100-this.timePercent)/50:this.timePercent/50));this.animation.node.setScale(n),this.exploded&&0==this._exploded&&(this._exploded=!0,this.animation.node.setScale(.75),this.animation.play(this.explosion_anim[this.skin]),this.animation.on("finished",this.onAnimationEvent,this),this.collider&&(this.collider.enabled=!0,this.collider.radius=50))},e.prototype.onDeath=function(t){r.default.isTutorial||(s.default.instance.dispatch(a.default.EVENT_NET_ENTITY_DEATH,this.id),this.node.removeFromParent())},e.prototype.onAnimationEvent=function(t,e){"finished"===t&&(e.name.indexOf("explosion")>0&&(this.death=!0,r.default.isTutorial&&(this.endPos=null,this.time=0,this._flying=!0,this.node.opacity=0,this.owner.bombable=!0)),r.default.isTutorial&&l.default.instance.updateTutorialStatus())},e.prototype.setStartPos=function(t,e){this.collider&&(this.collider.enabled=!1,this.collider.radius=0),this.startPos=cc.v2(t,e+c.ConfigGame.PLAYER_HEIGHT)},e.prototype.setEndPos=function(t,e){this.collider&&(this.collider.enabled=!1,this.collider.radius=0),this.endPos=cc.v2(t,e)},e.prototype.getEndPos=function(){return this.endPos},e.prototype.updateEndPos=function(){this.endPos=cc.v2(this.startPos.x,this.startPos.y+ +c.ConfigGame.PLAYER_HEIGHT)},e.prototype.setExplodeStatus=function(t){this._exploded=t},e.prototype.setOwnerPlayer=function(t){this.owner=t},e=i([p],e)}(a.default));n.default=f,cc._RF.pop()},{"../core/event-manager":"event-manager","./ConfigGame":"ConfigGame","./game":"game","./net-component":"net-component","./tutorial":"tutorial"}],"camera-control":[function(t,e,n){"use strict";cc._RF.push(e,"9c66egflVFCbL4YF55lXtB/","camera-control");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=t("./game"),a=t("../utils"),s=t("./tutorial"),c=cc._decorator,l=c.ccclass,u=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.targetPlayer=null,e.camera=null,e.followPlayer=!0,e._dgMoveDirect=cc.Vec2.ZERO,e._dgCamSpeed=300,e._dgCamZoom=0,e._dgKeys={},e._offset=120,e}var n;return o(e,t),n=e,e.prototype.start=function(){n.instance=this,cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this),this.camera=this.getComponent(cc.Camera)},e.prototype.moveToTarget=function(){if(this.targetPlayer){var t=this.adjustPos(this.targetPlayer.position);this.node.setPosition(t.x,t.y)}},e.prototype.update=function(t){if(this.followPlayer&&this.targetPlayer){var e=this.adjustPos(this.targetPlayer.position);if(r.default.isTutorial){if(s.default.instance){var n=a.Utils.moveTowards(this.node.x,e.x,s.default.instance.playerSpeed*t),o=a.Utils.moveTowards(this.node.y,e.y,s.default.instance.playerSpeed*t);this.node.setPosition(n,o)}}else if(r.default.instance){n=a.Utils.moveTowards(this.node.x,e.x,r.default.instance.playerSpeed*t),o=a.Utils.moveTowards(this.node.y,e.y,r.default.instance.playerSpeed*t);this.node.setPosition(n,o)}}else{if(0!=this._dgMoveDirect.x||0!=this._dgMoveDirect.y){var i=1;0!=this._dgMoveDirect.x&&0!=this._dgMoveDirect.y&&(i=1.4);var c=this._dgMoveDirect.x*i*this._dgCamSpeed*t/this.camera.zoomRatio,l=this._dgMoveDirect.y*i*this._dgCamSpeed*t/this.camera.zoomRatio;this.node.setPosition(this.node.position.add(cc.v2(c,l)))}0!=this._dgCamZoom&&(this.camera.zoomRatio+=this._dgCamZoom*this.camera.zoomRatio*.05)}},e.prototype.adjustPos=function(t){var e=t.x-this.node.width/2,n=t.x+this.node.width/2,o=t.y+this.node.height/2,i=t.y-this.node.height/2;return r.default.isTutorial?s.default.instance&&(e<-this._offset&&(t.x=this.node.width/2-this._offset),n>s.default.instance.worldSize.x+this._offset&&(t.x=s.default.instance.worldSize.x-this.node.width/2+this._offset),i<-this._offset&&(t.y=this.node.height/2-this._offset),o>s.default.instance.worldSize.y+this._offset&&(t.y=s.default.instance.worldSize.y-this.node.height/2+this._offset)):r.default.instance&&(e<-this._offset&&(t.x=this.node.width/2-this._offset),n>r.default.instance.worldSize.x+this._offset&&(t.x=r.default.instance.worldSize.x-this.node.width/2+this._offset),i<-this._offset&&(t.y=this.node.height/2-this._offset),o>r.default.instance.worldSize.y+this._offset&&(t.y=r.default.instance.worldSize.y-this.node.height/2+this._offset)),t},e.prototype.setFollow=function(t){this.followPlayer=t,t&&this.node.setPosition(this.adjustPos(this.targetPlayer.position))},e.prototype.setTarget=function(t){this.targetPlayer=t,this.setFollow(this.followPlayer)},e.prototype.getTarget=function(){return this.targetPlayer},e.prototype.onKeyUp=function(t){this._dgKeys[t.keyCode]=0,t.keyCode==cc.macro.KEY.up?this._dgMoveDirect.y=0:t.keyCode==cc.macro.KEY.down?this._dgMoveDirect.y=0:t.keyCode==cc.macro.KEY.left?this._dgMoveDirect.x=0:t.keyCode==cc.macro.KEY.right?this._dgMoveDirect.x=0:109==t.keyCode?this._dgCamZoom=0:107==t.keyCode&&(this._dgCamZoom=0)},e.prototype.onKeyDown=function(t){this._dgKeys[t.keyCode]=1,t.keyCode==cc.macro.KEY.up?this._dgMoveDirect.y=1:t.keyCode==cc.macro.KEY.down?this._dgMoveDirect.y=-1:t.keyCode==cc.macro.KEY.left?this._dgMoveDirect.x=-1:t.keyCode==cc.macro.KEY.right?this._dgMoveDirect.x=1:109==t.keyCode?this._dgCamZoom=1:107==t.keyCode?this._dgCamZoom=-1:110==t.keyCode&&(this.camera.zoomRatio=1),t.keyCode==cc.macro.KEY.f&&this._dgKeys[cc.macro.KEY.shift]&&this.setFollow(!this.followPlayer)},e.instance=null,i([u(cc.Node)],e.prototype,"targetPlayer",void 0),e=n=i([l],e)}(cc.Component);n.default=p,cc._RF.pop()},{"../utils":"utils","./game":"game","./tutorial":"tutorial"}],client:[function(t,e,n){"use strict";cc._RF.push(e,"c61f5N8DrNDXKlvzVqeL7DI","client"),Object.defineProperty(n,"__esModule",{value:!0});var o=t("./shared/SCCustomCodec"),i=t("./shared/NetMessage"),r=t("../../core/sound-manager"),a=t("../menu/main-menu"),s=t("../../player-ref"),c=function(){function t(t){this.currentTick=0,this.socket=null,this.channel=null,this.game=null,this.game=t}return t.prototype.connect=function(){var t=this;if(!this.socket){var e=a.default.servers[s.default.current.last_server_selection];this.socket=socketCluster.create({hostname:e.host,port:e.port,secure:e.secure,rejectUnauthorized:!1,autoReconnect:!1,codecEngine:new o.SCCustomCodec}),this.socket.on("connect",function(){t.socket.emit(i.Message.GameInfo,null,function(e,n){null==e?t.game.onGameInfo((new i.MsgGameInfo).unpack(n)):t.game.onError("Get game info error: "+e)})}),this.socket.on("error",function(e){cc.warn("error: "+e.message),t.game.onError(e)}),this.socket.on("disconnect",function(){cc.warn("disconnect "+t.socket.getState()),t.shutdown()}),this.socket.on(i.Message.Death,function(e){t.game.onDeath((new i.MsgDeath).unpack(e))})}},t.prototype.connectToHost=function(e,n,i,r){var a=this;void 0===i&&(i=null),void 0===r&&(r=!1),r||!this.socket?(this.socket=t.ms_socket,this.socket&&this.disconnect(),!r&&this.socket||(this.socket=socketCluster.create({hostname:e.host,port:e.port,secure:e.secure,rejectUnauthorized:!1,autoReconnect:!1,codecEngine:new o.SCCustomCodec}),t.ms_socket=this.socket),this.socket.on("connect",function(){n()}),this.socket.on("error",function(t){i&&i(t)}),this.socket.on("disconnect",function(){a.shutdown()})):n()},t.prototype.shutdown=function(){this.socket&&"closed"==this.socket.getState()&&(this.socket.destroy(),this.socket=null)},t.prototype.disconnect=function(){this.socket&&"open"==this.socket.getState()&&this.socket.disconnect()},t.prototype.sendAction=function(t){this.socket&&this.socket.emit(i.Message.InputAction,(new i.MsgInputAction).pack(t))},t.prototype.sendRequest=function(t,e){this.socket.emit(t,null,e)},t.prototype.joinGame=function(t){var e=this;this.socket&&this.socket.emit(i.Message.JoinGame,t,function(t,n){null==t?(e.game.onJoinGame((new i.MsgJoinGame).unpack(n)),e.registerServerData()):e.game.onError(t)})},t.prototype.getPlayerExtraInfo=function(t,e){var n=this;this.socket&&this.socket.emit(i.Message.QueryPlayer,t,function(t,o){null==t?e((new i.MsgQueryPlayer).unpack(o)):n.game.onError(t)})},t.prototype.getBombExtraInfo=function(t,e){var n=this;this.socket&&this.socket.emit(i.Message.QueryBomb,t,function(t,o){null==t?e((new i.MsgQueryBomb).unpack(o)):n.game.onError(t)})},t.prototype.getLeaderBardData=function(t,e){var n=this;this.socket&&this.socket.emit(i.Message.LeaderBoard,t,function(t,o){null==t?e((new i.MsgLeaderBoard).unpack(o)):n.game.onError(t)})},t.prototype.registerServerData=function(){var t=this;this.socket&&(this.socket.on(i.Message.ServerData,function(e){t.game.onServerData((new i.MsgServerData).unpack(e))}),this.socket.subscribe(i.Message.Notify).watch(function(e){t.game.onNotiMessage((new i.MsgNofity).unpack(e))}),this.socket.subscribe("lbdata").watch(function(e){t.game.onLeaderboardChange((new i.MsgLeaderBoard).unpack(e))}),this.socket.subscribe("fps-dropped").watch(function(t){cc.log("[fps-dropped]"+t)}),this.socket.on("server-sfx-trigger",function(t){r.default.instance.playEffect(t)}))},t.prototype.ping=function(t){if(this.socket){var e=Date.now();this.socket.emit("ping",null,function(){var n=Date.now()-e;t(n)})}},t.ms_socket=null,t}();n.default=c,cc._RF.pop()},{"../../core/sound-manager":"sound-manager","../../player-ref":"player-ref","../menu/main-menu":"main-menu","./shared/NetMessage":"NetMessage","./shared/SCCustomCodec":"SCCustomCodec"}],config:[function(t,e,n){"use strict";cc._RF.push(e,"c40dbVkwulCgaxnZg5s0ilJ","config"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(){}return t.PROJECT_ID="Template",t.PROJECT_VERSION="1.0.0",t}();n.default=o,cc._RF.pop()},{}],debug:[function(t,e,n){"use strict";cc._RF.push(e,"2e362pHwmlAnbc5G8cVVug2","debug");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=t("../game"),a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.game=null,e.debugInfoText=null,e.showCollidBox=!1,e.debugDrawer=null,e.drawBombRange=!0,e.debugInfo={},e.joinGame=!1,e}return o(e,t),e.prototype.update=function(t){0==this.joinGame&&this.game.localPlayer&&this._onJoinGame()},e.prototype.lateUpdate=function(){this.drawCollder()},e.prototype._onJoinGame=function(){this.joinGame=!0,this.debugPing()},e.prototype.debugPing=function(){var t=this;this.game.client&&this.schedule(function(){t.game.client.ping(function(e){t.setInfo("ping",e+"ms")})},3)},e.prototype.setInfo=function(t,e){this.debugInfo[t]=e,this.updateDebugInfo()},e.prototype.updateDebugInfo=function(){var t="";for(var e in this.debugInfo)t+=e+" : "+this.debugInfo[e]+"\n";this.debugInfoText.string=t},e.prototype.drawCollder=function(){if(this.showCollidBox){if(null==this.debugDrawer){var t=cc.find("Debug_Drawer");null==t&&((t=new cc.Node("Debug_Drawer")).zIndex=cc.macro.MAX_ZINDEX,cc.game.addPersistRootNode(t)),this.debugDrawer=t.addComponent(cc.Graphics)}for(var e in this.debugDrawer.clear(),this.game.players)this._drawNode(this.game.players[e].node,this.game.playerSize.x/2,this.game.playerSize.y/2);if(this.game.localPlayer&&this._drawNode(this.game.localPlayer.node,this.game.playerSize.x/2,this.game.playerSize.y/2),this.drawBombRange){var n=.5*this.game.bombRange,o=.8660254037844386*this.game.bombRange;for(var e in this.game.bombs)this.game.bombs[e].exploded&&(this._drawNode(this.game.bombs[e].node,n,o),this._drawNode(this.game.bombs[e].node,o,n))}}},e.prototype._drawNode=function(t,e,n){this.debugDrawer.strokeColor=cc.Color.WHITE;var o=t.convertToWorldSpaceAR(cc.Vec2.ZERO);this.debugDrawer.moveTo(o.x-e,o.y+n),this.debugDrawer.lineTo(o.x+e,o.y+n),this.debugDrawer.lineTo(o.x+e,o.y-n),this.debugDrawer.lineTo(o.x-e,o.y-n),this.debugDrawer.close(),this.debugDrawer.stroke()},i([c({type:r.default})],e.prototype,"game",void 0),i([c({type:cc.Label})],e.prototype,"debugInfoText",void 0),i([c()],e.prototype,"showCollidBox",void 0),e=i([s],e)}(cc.Component);n.default=l,cc._RF.pop()},{"../game":"game"}],"event-manager":[function(t,e,n){"use strict";cc._RF.push(e,"f534eiXgTxDaIAsHCAjGshJ","event-manager"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(){this.eventListenners={}}return Object.defineProperty(t,"instance",{get:function(){return null==t._instance&&(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),t.prototype.register=function(t,e,n,o,i){void 0===n&&(n=null),void 0===o&&(o=0),void 0===i&&(i=!1);var r={target:n,callback:e,priority:o,excuteOnce:i};return this.eventListenners[t]?this.eventListenners[t].push(r):(this.eventListenners[t]=[],this.eventListenners[t].push(r)),this.eventListenners[t].sort(function(t,e){return e.priority-t.priority}),e},t.prototype.registerOnce=function(t,e,n,o){void 0===n&&(n=null),void 0===o&&(o=0),this.register(t,e,n,o,!0)},t.prototype.unregister=function(t,e,n){if(void 0===n&&(n=null),this.eventListenners[t]){for(var o=[],i=0;i<this.eventListenners[t].length;i++){var r=this.eventListenners[t][i];null==e?r.target==n&&o.push(i):r.target==n&&r.callback==e&&o.push(i)}this.eventListenners[t]=this.eventListenners[t].filter(function(t,e){return-1===o.indexOf(e)}),0==this.eventListenners[t].length&&delete this.eventListenners[t]}},t.prototype.unregisterTarget=function(t){var e=function(e){for(var o=[],i=0;i<n.eventListenners[e].length;i++){n.eventListenners[e][i].target==t&&o.push(i)}n.eventListenners[e]=n.eventListenners[e].filter(function(t,e){return-1===o.indexOf(e)}),0==n.eventListenners[e].length&&delete n.eventListenners[e]},n=this;for(var o in this.eventListenners)e(o)},t.prototype.remove=function(t){this.eventListenners[t]&&delete this.eventListenners[t]},t.prototype.dispatch=function(t){for(var e=this,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];if(this.eventListenners[t]){var i=[];this.eventListenners[t].forEach(function(t){t.target?t.callback.call(t.target,n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9]):t.callback(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9]),1==t.excuteOnce&&i.push(t)}),i.forEach(function(n){e.unregister(t,n.callback,n.target)})}},t._instance=null,t}();n.default=o,cc._RF.pop()},{}],"exp-buble":[function(t,e,n){"use strict";cc._RF.push(e,"429632zggJMArq6tC4HMR9P","exp-buble");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=t("./net-component"),a=t("../core/event-manager"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.frames=[],e}return o(e,t),e.prototype.start=function(){},e.prototype.init=function(e){t.prototype.init.call(this,e),this.node.opacity=e.opacity,this.node.setPosition(e.x,e.y),this.node.getComponent(cc.Sprite).spriteFrame=this.frames[e.type]},e.prototype.setStateData=function(e){t.prototype.setStateData.call(this,e),this.node.opacity=e.opacity,this.death=e.death,this.node.getComponent(cc.Sprite).spriteFrame=this.frames[e.type]},e.prototype.onDeath=function(t){var e=this;a.default.instance.dispatch(r.default.EVENT_NET_ENTITY_DEATH,this.id),t?this.node.removeFromParent():this.node.runAction(cc.sequence(cc.fadeOut(.2),cc.callFunc(function(){e.node.removeFromParent()})))},i([l({type:cc.SpriteFrame})],e.prototype,"frames",void 0),e=i([c],e)}(r.default);n.default=u,cc._RF.pop()},{"../core/event-manager":"event-manager","./net-component":"net-component"}],firebaseAppInst:[function(t,e,n){"use strict";cc._RF.push(e,"f7421mwzGpIkJT2OCHRmRTy","firebaseAppInst"),Object.defineProperty(n,"__esModule",{value:!0});var o=t("../player-ref"),i=function(){function t(){this._app=null,this.anonymousID=null,this.isAnonymousSignIn=!1,this.txtNotify=null,this.firebaseConfig={apiKey:"AIzaSyCmyZFtG71zLuMfQNm-xyWAGLUAqPuuZfY",authDomain:"testfbase-2ce37.firebaseapp.com",databaseURL:"https://testfbase-2ce37.firebaseio.com",projectId:"testfbase-2ce37",storageBucket:"testfbase-2ce37.appspot.com",messagingSenderId:"797184681679",appId:"1:797184681679:web:1a6a3ca7491d9cdda8b9ba",measurementId:"G-PHL8Y5V5GC"}}return Object.defineProperty(t,"instance",{get:function(){return null==t._instance&&(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),t.prototype.setOutputComponent=function(t){this.txtNotify=t,this.txtNotify.string=""},t.prototype.initFirebaseApp=function(){t._instance=this,firebase.apps.length||(this._app=firebase.initializeApp(this.firebaseConfig,"Jellimon"),firebase.analytics(this._app),console.log("Nhan --\x3e get App Name after initializeApp: "+this._app.name))},t.prototype.initAuth=function(){null!=t.instance&&(firebase.auth(this._app).signInAnonymously().catch(function(t){cc.log("Firebase --\x3esignInAnonymously --\x3e error code: "+t.code),cc.log("Firebase --\x3esignInAnonymously --\x3e error Mess: "+t.errorMessage)}),firebase.auth(this._app).onAuthStateChanged(function(e){console.log("User state change detected from the Background script of the Chrome Extension:",e),console.log("Firebase --\x3e1 user.uid : "+e.uid),console.log("Firebase --\x3e1 user.isAnonymous : "+e.isAnonymous),console.log("Firebase --\x3e currentUser.uid : "+firebase.auth(t._instance._app).currentUser.uid),e.isAnonymous?(t._instance.anonymousID=e.uid,t.instance.writeGameData(e.uid)):(o.default.current.crediental=e.uid,t.instance.loadGameData(e.uid))}))},t.prototype.GoogleAuth=function(){var t=new firebase.auth.GoogleAuthProvider;t.addScope("profile"),t.addScope("email"),firebase.auth().signInWithPopup(t).then(function(t){var e=t.credential.accessToken;t.user;console.log("Firebase --\x3e1 google Token : "+e)})},t.prototype.writeUserData=function(t,e,n,o,i,r,a,s,c,l,u,p){firebase.database().ref("users/"+t).get({username:e,control:n,characterType:o,bombType:i,mapType:r,streak:a,alive:s,showhelp:c,isRabitTutorial:l,isPenguinTutorial:u,isLeafTutorial:p},function(t){t?(cc.log("Firebase --\x3ewriteUserData --\x3e error code: "+t.code),cc.log("Firebase --\x3ewriteUserData --\x3e error Mess: "+t.errorMessage)):cc.log("Firebase --\x3ewriteUserData --\x3e Data saved successfully")})},t.prototype.writeGameData=function(e){null!=t._instance&&(console.log("_instance.anonymousID : "+e),firebase.firestore(this._app).collection("users").doc(e).set({username:o.default.current.name,control:o.default.current.control,characterType:o.default.current.user,bombType:o.default.current.bomb,mapType:o.default.current.map,streak:o.default.current.streak,alive:o.default.current.alive,showhelp:o.default.current.show_help,isRabitTutorial:o.default.current.isRabitTutorial,isPenguinTutorial:o.default.current.isPenguinTutorial,isLeafTutorial:o.default.current.isLeafTutorial},function(t){t?(cc.log("Firebase --\x3ewriteUserData --\x3e error code: "+t.code),cc.log("Firebase --\x3ewriteUserData --\x3e error Mess: "+t.errorMessage)):cc.log("Firebase --\x3ewriteUserData --\x3e Data saved successfully")}))},t.prototype.loadGameData=function(e){null!=t._instance&&(console.log("_instance.anonymousID : "+e),firebase.firestore(this._app).collection("users").doc(e).get().then(function(t){if(t.exists){console.log("Document data: ",t.data());var e=t.data();o.default.current.name=e.username,o.default.current.control=e.control,o.default.current.user=e.characterType,o.default.current.bomb=e.bombType,o.default.current.map=e.mapType,o.default.current.streak=e.streak,o.default.current.alive=e.alive,o.default.current.show_help=e.showhelp,o.default.current.isRabitTutorial=e.isRabitTutorial,o.default.current.isPenguinTutorial=e.isPenguinTutorial,o.default.current.isLeafTutorial=e.isLeafTutorial}else console.log("No such document!")}).catch(function(t){console.log("Error getting document:",t)}))},t.prototype.SignInWithEmailPass=function(e,n){t.instance.txtNotify&&(t.instance.txtNotify.string=""),firebase.auth(this._app).signInWithEmailAndPassword(e,n).catch(function(e){var n=e.code,o=e.message;"auth/wrong-password"===n?t.instance.txtNotify&&(t.instance.txtNotify.string="Wrong password."):t.instance.txtNotify&&(t.instance.txtNotify.string=o+" Please register account again.")})},t.prototype.RegisterEmailPass=function(e,n){t.instance.txtNotify&&(t.instance.txtNotify.string=""),firebase.auth(this._app).createUserWithEmailAndPassword(e,n).catch(function(e){var n=e.code,o=e.message;"auth/weak-password"===n?t.instance.txtNotify&&(t.instance.txtNotify.string="The password is too weak."):t.instance.txtNotify&&(t.instance.txtNotify.string=o)})},t._instance=null,t}();n.default=i,cc._RF.pop()},{"../player-ref":"player-ref"}],game:[function(t,e,n){"use strict";cc._RF.push(e,"3d5bfZRQ/VJAbNoawKUTATx","game");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../core/loader"),s=t("./player"),c=t("./bomb"),l=t("./multiplayer/client"),u=t("../player-ref"),p=t("./camera-control"),f=t("./player-control"),h=t("./ui/leaderboard"),d=t("../core/event-manager"),y=t("./notifier"),g=t("./ui/minimap"),_=t("./exp-buble"),m=t("./player-control-local"),b=t("./net-component"),v=t("../core/popup"),P=t("./ui/special-skill"),w=t("./resources-cacher"),S=t("../core/sound-manager"),C=cc._decorator,T=C.ccclass,R=C.property,E=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.worldRoot=null,e.map=null,e.killerPopup=null,e.notifier=null,e.leaderboard=null,e.miniMap=null,e.playerPrefabs=[],e.bombPrefab=null,e.expBublePrefab=null,e.targetPrefab=null,e.mcFrames=[],e.localPlayer=null,e.localTarget=null,e.players={},e.bombs={},e.bubles={},e.client=null,e.isDeath=!1,e.worldSize=null,e.playerSize=null,e.bombRange=0,e.playerSpeed=0,e.skill=null,e}var n;return o(e,t),n=e,e.prototype.onLoad=function(){if(a.default.loaded){v.default.instance.setTarget(this.node.getChildByName("uiRoot")),v.default.instance.showWaitingPopup("connecting to server..."),n.instance=this,this.client=new l.default(this),this.client.connect();var t=this.map.addComponent(cc.TiledMap);t.tmxAsset=w.default.instance.map.asset,t.tmxAsset.textures[0]=w.default.instance.map.texture[u.default.current.map]}},e.prototype.start=function(){a.default.loaded&&(d.default.instance.register(b.default.EVENT_NET_ENTITY_DEATH,this.onNetEntityDeath,this),S.default.instance.playMusic("m_ih_bgm"),this.map.active=!0,1==n.USE_DYNAMIC_BOMB?this.node.getChildByName("uiRoot").getChildByName("fire-pad").getChildByName("bg").active=!0:this.node.getChildByName("uiRoot").getChildByName("fire-pad").getChildByName("bg").active=!1)},e.prototype.onNetEntityDeath=function(t){this.players[t]?(delete this.players[t],this.miniMap.removeFromMap([t])):this.bombs[t]?delete this.bombs[t]:this.bubles[t]&&delete this.bubles[t]},e.prototype.onGameInfo=function(t){cc.log("game info: "+t.worldW+" - "+t.worldH),this.worldRoot.width=t.worldW,this.worldRoot.height=t.worldH,this.worldSize=cc.v2(t.worldW,t.worldH),this.playerSize=cc.v2(t.playerW,t.playerH),this.bombRange=t.bombRange,this.playerSpeed=t.playerSpeed,this.client.joinGame({name:u.default.current.name,cskin:u.default.current.user,bskin:u.default.current.bomb})},e.prototype.onJoinGame=function(t){var e=cc.instantiate(this.playerPrefabs[u.default.current.user]).getComponent(s.default);e.init(i({},t,{level:1,exp:0,health:t.startHealth,name:u.default.current.name,cskin:u.default.current.user})),e.node.addComponent(m.default).init(this.client),this.worldRoot.addChild(e.node),this.localPlayer=e,p.default.instance.setTarget(e.node),this.skill=this.getComponent(P.default),this.skill.setPlayerSkill(),this.localTarget||(this.localTarget=cc.instantiate(this.targetPrefab),this.localTarget.active=!1,this.worldRoot.addChild(this.localTarget)),v.default.instance.hideWaitingPopup()},e.prototype.onServerData=function(t){var e=this;t.players.forEach(function(t){if(e.localPlayer.id==t.id)e.localPlayer.controller.setServerData(t),e.skill.setData(t.cskin,t.skillable,t.cooldown);else if(e.players[t.id])e.players[t.id].controller.setServerData(t);else{var n=cc.instantiate(e.playerPrefabs[t.cskin]).getComponent(s.default);n.init(i({},t,{name:""})),n.node.addComponent(f.default),e.worldRoot.addChild(n.node),e.players[n.id]=n,e.client.getPlayerExtraInfo(n.id,function(t){t&&t.id==n.id&&n.setPlayerName(t.name)})}}),t.bombs.forEach(function(t){if(e.bombs[t.id])e.bombs[t.id].setStateData(t);else{var n=cc.instantiate(e.bombPrefab).getComponent(c.default);n.init(t),e.worldRoot.addChild(n.node),e.bombs[t.id]=n,e.client.getBombExtraInfo(n.id,function(t){t&&t.id==n.id&&n.setExtraData(t)})}}),t.bubles.forEach(function(t){if(e.bubles[t.id])e.bubles[t.id].setStateData(t);else{var n=cc.instantiate(e.expBublePrefab).getComponent(_.default);n.init(t),e.worldRoot.addChild(n.node),e.bubles[t.id]=n}}),this.miniMap.updatePlayersPosition(this.players)},e.prototype.updateLeaderBoard=function(){var t=this;this.localPlayer&&this.client.getLeaderBardData(this.localPlayer.id,function(e){for(var n in t.leaderboard.setData(e),t.miniMap.updatePlayersDisplay(e),t.localPlayer.controller.updateRank(e,!0),t.players)t.players[n].controller.updateRank(e)})},e.prototype.onLeaderboardChange=function(t){for(var e in this.leaderboard.setData(t),this.miniMap.updatePlayersDisplay(t),this.localPlayer.controller.updateRank(t,!0),this.players)this.players[e].controller.updateRank(t)},e.prototype.updateLocalTarget=function(t,e){if(t>-1&&e>0){var n=e*this.bombRange/100,o=t*Math.PI/180,i=this.localPlayer.node.x+Math.round(n*Math.cos(o)),r=this.localPlayer.node.y+this.playerSize.y+Math.round(n*Math.sin(o));this.localTarget.setPosition(i,r),this.localTarget.active=!0}else this.localTarget.active=!1},e.prototype.onDeath=function(t){var e=this;u.default.current.updateLocalRecord(t.score,t.time),this.isDeath=!0,this.killerPopup.active=!0;var o=Math.floor(t.time/60)+"' "+Math.floor(t.time%60)+'"';this.killerPopup.getComponentInChildren(cc.Label).string="Killed by "+t.killer,this.killerPopup.runAction(cc.sequence(cc.fadeIn(.5),cc.delayTime(1),cc.fadeOut(.25),cc.callFunc(function(){e.killerPopup.active=!1,S.default.instance.stop("m_ih_bgm"),n.instance.showAds()}))),this.scheduleOnce(function(){v.default.instance.showConfirmPopup(this.mcFrames[u.default.current.user],o,t.score.toString(),this.replay.bind(this),this.quit.bind(this))},3)},e.prototype.replay=function(){window.dataLayer&&window.dataLayer.push({event:"ga_event",ga_category:"Gamepage",ga_action:"Start",ga_label:window.productTitle,ga_noninteraction:!1}),cc.director.loadScene("game")},e.prototype.quit=function(){window.dataLayer&&window.dataLayer.push({event:"ga_event",ga_category:"Gamepage",ga_action:"Completion",ga_label:window.productTitle,ga_noninteraction:!1}),this.client.disconnect(),cc.director.loadScene("main-menu")},e.prototype.onNotiMessage=function(t){t.kill&&(S.default.instance.playRandom(["vo_jelly_die_1","vo_jelly_die_2","vo_jelly_die_3","vo_jelly_die_4"]),this.notifier.addNotify("<color=#00ff00>"+t.kill.killer+"</c> killed <color=#ff0000>"+t.kill.deathman+"</c>"))},e.prototype.onError=function(t){this.isDeath||(cc.error(t),this.client.shutdown(),v.default.instance.showInfoPopup("Opss, something's wrong...\nPlease try again later!",function(){cc.director.loadScene("main-menu")}))},e.prototype.onDestroy=function(){d.default.instance.unregisterTarget(this),delete this.client},e.prototype.onButtonQuit=function(t){S.default.instance.stop("m_ih_bgm"),S.default.instance.playEffect("sfx_ui_back"),v.default.instance.showInfoPopup(null,this.quit.bind(this),!0,function(){S.default.instance.playMusic("m_ih_bgm")})},e.prototype.showAds=function(){if(console.log("showAds()"),window.enableADS){console.log("showing ADS");try{window.playAds()}catch(t){console.error(t)}}},e.instance=null,e.isTutorial=!0,e.USE_NEW_PORTAL=!0,e.USE_DYNAMIC_BOMB=!1,e.pressed_btnfire=!1,e.dynamic_range=20,e.min_range=20,e.max_range=100,e.count=3,r([R(cc.Node)],e.prototype,"worldRoot",void 0),r([R(cc.Node)],e.prototype,"map",void 0),r([R(cc.Node)],e.prototype,"killerPopup",void 0),r([R(y.default)],e.prototype,"notifier",void 0),r([R(h.default)],e.prototype,"leaderboard",void 0),r([R(g.default)],e.prototype,"miniMap",void 0),r([R({type:cc.Prefab})],e.prototype,"playerPrefabs",void 0),r([R(cc.Prefab)],e.prototype,"bombPrefab",void 0),r([R(cc.Prefab)],e.prototype,"expBublePrefab",void 0),r([R(cc.Prefab)],e.prototype,"targetPrefab",void 0),r([R({type:cc.SpriteFrame})],e.prototype,"mcFrames",void 0),e=n=r([T],e)}(cc.Component);n.default=E,cc._RF.pop()},{"../core/event-manager":"event-manager","../core/loader":"loader","../core/popup":"popup","../core/sound-manager":"sound-manager","../player-ref":"player-ref","./bomb":"bomb","./camera-control":"camera-control","./exp-buble":"exp-buble","./multiplayer/client":"client","./net-component":"net-component","./notifier":"notifier","./player":"player","./player-control":"player-control","./player-control-local":"player-control-local","./resources-cacher":"resources-cacher","./ui/leaderboard":"leaderboard","./ui/minimap":"minimap","./ui/special-skill":"special-skill"}],healthbar:[function(t,e,n){"use strict";cc._RF.push(e,"f1dedfdCuVPYrIxgabTPWVo","healthbar");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=t("../player"),a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.segments=null,e.healthColors=[],e.curColor=0,e}return o(e,t),e.prototype.start=function(){this.healthBar=this.getComponent(cc.ProgressBar),this.curColor=0},e.prototype.updateHealth=function(t,e){if(this.healthBar&&(this.healthBar.progress=e/r.default.getHealth(t),t>=2))for(var n=this.segments.childrenCount;n<t;n++){var o=cc.instantiate(this.segments.children[0]);this.segments.addChild(o)}},e.prototype.updateNotify=function(){this.healthBar.progress<.3&&0==this.curColor?(this.curColor=1,this.healthBar.getComponentInChildren(cc.Sprite).spriteFrame=this.healthColors[this.curColor]):1==this.healthBar.progress&&1==this.curColor&&(this.curColor=0,this.healthBar.getComponentInChildren(cc.Sprite).spriteFrame=this.healthColors[this.curColor])},i([c(cc.Node)],e.prototype,"segments",void 0),i([c({type:[cc.SpriteFrame]})],e.prototype,"healthColors",void 0),e=i([s],e)}(cc.Component);n.default=l,cc._RF.pop()},{"../player":"player"}],"help-page":[function(t,e,n){"use strict";cc._RF.push(e,"ae0a9561IdLRZCvCPoghvJC","help-page");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=t("../../player-ref"),a=t("../../core/sound-manager"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.menuPage=null,e.apPage=null,e.ticked=null,e.textPage=null,e.previous=null,e.next=null,e}var n;return o(e,t),n=e,e.prototype.start=function(){this.ticked.active=r.default.current.show_help<1,this.node.active=n.firstLaunch_shouldShow&&r.default.current.show_help>0},e.prototype.onButtonsPress=function(t,e){if(0==e){a.default.instance.playEffect("sfx_ui_select");var o=r.default.current.show_help;r.default.current.show_help=1-o,this.ticked.active=r.default.current.show_help<1}else 3==e?(a.default.instance.playEffect("sfx_ui_back"),this.node.active=!1,n.firstLaunch_shouldShow=!1):(a.default.instance.playEffect("sfx_ui_next"),this.apPage.active=2==e,this.menuPage.active=1==e,this.textPage.string=e+"/2",this.previous.node.active=2==e,this.next.node.active=1==e)},e.firstLaunch_shouldShow=!0,i([l(cc.Node)],e.prototype,"menuPage",void 0),i([l(cc.Node)],e.prototype,"apPage",void 0),i([l(cc.Node)],e.prototype,"ticked",void 0),i([l(cc.Label)],e.prototype,"textPage",void 0),i([l(cc.Button)],e.prototype,"previous",void 0),i([l(cc.Button)],e.prototype,"next",void 0),e=n=i([c],e)}(cc.Component);n.default=u,cc._RF.pop()},{"../../core/sound-manager":"sound-manager","../../player-ref":"player-ref"}],i18n:[function(t,e,n){"use strict";cc._RF.push(e,"cb41b4cbx9AcpIzAaOE+6ZV","i18n"),window.i18n||(window.i18n={}),window.i18n.languages||(window.i18n.languages={});var o=t("polyglot"),i=window.i18n.supported_languages||[],r=cc.sys.localStorage.getItem("__gamesave-language"),a="";null==r?(a=cc.sys.language,i.length>0&&-1==i.indexOf(a)&&(a=i[0],cc.sys.localStorage.setItem("__gamesave-language",a))):a=r;var s=window.i18n.languages[a]||{},c=new o({phrases:s,allowMissing:!0});e.exports={init:function(t){return window.i18n.languages[t]?(window.i18n.languages[t]&&cc.sys.localStorage.setItem("__gamesave-language",t),a=t,s=window.i18n.languages[a]||{},c.replace(s),!0):(console.warn("Language is not support: "+t),!1)},getSaveLang:function(){return cc.sys.localStorage.getItem("__gamesave-language")},t:function(t,e){return c.t(t,e)}},cc._RF.pop()},{polyglot:"polyglot"}],"input-keyboard":[function(t,e,n){"use strict";cc._RF.push(e,"a5e71OSpJNAgJ+CdztMVbWO","input-keyboard");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=t("./input"),a=t("./game"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dpad=null,e.keys={},e.preAngle=-1,e}return o(e,t),e.prototype.start=function(){cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)},e.prototype.update=function(){this.updateMove()},e.prototype.setInput=function(t){r.default.instance.set(t,0)},e.prototype.onKeyUp=function(t){var e=t.keyCode;e==cc.macro.KEY.up&&(e=cc.macro.KEY.w),e==cc.macro.KEY.down&&(e=cc.macro.KEY.s),e==cc.macro.KEY.left&&(e=cc.macro.KEY.a),e==cc.macro.KEY.right&&(e=cc.macro.KEY.d),this.keys[e]=0,e==cc.macro.KEY.space?(a.default.USE_DYNAMIC_BOMB||(a.default.pressed_btnfire=!1),this.setInput({fire:1,fire_dir:a.default.instance.localPlayer.direction,fire_range:a.default.dynamic_range})):e==cc.macro.KEY.shift&&this.setInput({fire:2,fire_dir:a.default.instance.localPlayer.direction,fire_range:100})},e.prototype.onKeyDown=function(t){var e=t.keyCode;e==cc.macro.KEY.up&&(e=cc.macro.KEY.w),e==cc.macro.KEY.down&&(e=cc.macro.KEY.s),e==cc.macro.KEY.left&&(e=cc.macro.KEY.a),e==cc.macro.KEY.right&&(e=cc.macro.KEY.d),a.default.USE_DYNAMIC_BOMB||e!=cc.macro.KEY.space||(a.default.pressed_btnfire=!0),this.keys[e]=1},e.prototype.updateMove=function(){var t=this.getMoveDirection();if(t>-1){if(this.preAngle=t,this.setInput({direction:t}),this.dpad.active){var e=t*Math.PI/180,n=Math.round(100*Math.cos(e)),o=Math.round(100*Math.sin(e));this.dpad.getChildByName("indicator").setPosition(n,o)}}else-1!=this.preAngle&&(this.setInput({direction:-1}),this.preAngle=-1,this.dpad.active&&this.dpad.getChildByName("indicator").setPosition(cc.Vec2.ZERO))},e.prototype.getMoveDirection=function(){var t=-1;return this.keys[cc.macro.KEY.w]?t=this.keys[cc.macro.KEY.a]?135:this.keys[cc.macro.KEY.d]?45:90:this.keys[cc.macro.KEY.d]?t=this.keys[cc.macro.KEY.w]?45:this.keys[cc.macro.KEY.s]?315:0:this.keys[cc.macro.KEY.s]?t=this.keys[cc.macro.KEY.d]?315:this.keys[cc.macro.KEY.a]?225:270:this.keys[cc.macro.KEY.a]&&(t=this.keys[cc.macro.KEY.w]?135:this.keys[cc.macro.KEY.s]?225:180),t},i([l(cc.Node)],e.prototype,"dpad",void 0),e=i([c],e)}(cc.Component);n.default=u,cc._RF.pop()},{"./game":"game","./input":"input"}],"input-touch":[function(t,e,n){"use strict";cc._RF.push(e,"4b045MXXJRF6Y8osqSWdohC","input-touch");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=t("./game"),a=t("./camera-control"),s=t("../player-ref"),c=t("./input"),l=t("../utils"),u=t("./tutorial"),p=cc._decorator,f=p.ccclass,h=p.property,d=(p.requireComponent,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.touchZone=null,e.dpad=null,e.buttonFire=null,e.buttonSkill=null,e.angle=-1,e.startPos=null,e.defaultDpadPos=null,e.fireCenterPos=null,e.fireInfo=null,e.buttonZIndex=0,e}return o(e,t),e.prototype.start=function(){var t=this;if(s.default.current.control==s.ControlType.DPad){this.dpad.active=!0,this.defaultDpadPos=this.dpad.position;var e=this.touchZone.getComponent(cc.Widget);e.right=480,e.updateAlignment()}[this.touchZone,this.buttonFire,this.buttonSkill].forEach(function(e){e.on(cc.Node.EventType.TOUCH_START,t.onTouchStart,t),e.on(cc.Node.EventType.TOUCH_MOVE,t.onTouchMove,t),e.on(cc.Node.EventType.TOUCH_END,t.onTouchEnd,t),e.on(cc.Node.EventType.TOUCH_CANCEL,t.onTouchEnd,t)})},e.prototype.update=function(t){var e=null;if(this.startPos&&(e=l.Utils.extend(e,{direction:Math.round(this.angle)})),this.fireCenterPos&&(e=l.Utils.extend(e,this.fireInfo)),r.default.isTutorial?r.default.pressed_btnfire?(r.default.dynamic_range+=r.default.count,r.default.dynamic_range>=r.default.max_range&&(r.default.dynamic_range=r.default.max_range),u.default.instance.updateLocalTarget(0,r.default.dynamic_range)):(r.default.dynamic_range=r.default.min_range,u.default.instance.updateLocalTarget(0,0)):!r.default.USE_DYNAMIC_BOMB&&r.default.instance&&r.default.instance.localPlayer&&(r.default.pressed_btnfire?(r.default.dynamic_range+=r.default.count,r.default.dynamic_range>=r.default.max_range&&(r.default.dynamic_range=r.default.max_range),r.default.instance.updateLocalTarget(r.default.instance.localPlayer.direction,r.default.dynamic_range)):(r.default.dynamic_range=r.default.min_range,r.default.instance.updateLocalTarget(0,0))),r.default.isTutorial?this.fireInfo&&u.default.instance.TutorialPlayer.isFiring&&(this.fireInfo=null,e=l.Utils.extend(e,{fire:0,fire_dir:-1,fire_range:0})):r.default.instance&&r.default.instance.localPlayer&&this.fireInfo&&r.default.instance.localPlayer.isFiring&&(this.fireInfo=null,e=l.Utils.extend(e,{fire:0,fire_dir:-1,fire_range:0})),r.default.isTutorial)if(u.default.instance){if(3==u.default.instance.performAction)return;e&&this.setInput(e)}else e&&this.setInput(e);else e&&this.setInput(e)},e.prototype.setInput=function(t){c.default.instance.set(t,1)},e.prototype.onTouchStart=function(t){if(t.target==this.touchZone){if(this.startPos=t.getLocation(),!r.default.isTutorial||u.default.tutorial_status!=u.TUTORIAL_STATE.Tutorial_shield&&u.default.tutorial_status!=u.TUTORIAL_STATE.Tutorial_skill||u.default.tutorial_sub_status!=u.TUTORIAL_SUB_STATE.Tutorial_checkdoAction||2!=u.default.instance.performAction||(u.default.instance.performAction=3),r.default.isTutorial&&u.default.instance&&3==u.default.instance.performAction)return;if(this.dpad.active)if(r.default.isTutorial){if(u.default.tutorial_status!=u.TUTORIAL_STATE.Tutorial_skill){var e=this.dpad.parent.convertToNodeSpaceAR(this.startPos);this.dpad.setPosition(e)}}else{e=this.dpad.parent.convertToNodeSpaceAR(this.startPos);this.dpad.setPosition(e)}}if(t.target==this.buttonFire)if(r.default.USE_DYNAMIC_BOMB){this.buttonZIndex=t.target.zIndex,t.target.zIndex=cc.macro.MAX_ZINDEX;var n=t.target.convertToWorldSpaceAR(cc.Vec2.ZERO);this.fireCenterPos=n}else this.buttonFire.getChildByName("indicator").setScale(.8),r.default.pressed_btnfire=!0;else if(t.target==this.buttonSkill){this.buttonZIndex=t.target.zIndex,t.target.zIndex=cc.macro.MAX_ZINDEX;n=t.target.convertToWorldSpaceAR(cc.Vec2.ZERO);this.fireCenterPos=n}},e.prototype.onTouchMove=function(t){if(t.target==this.touchZone&&this.startPos){var e=void 0,n=void 0;if(this.dpad.active)n=t.getLocationY()-this.startPos.y,e=t.getLocationX()-this.startPos.x;else if(this.touchZone.active){var o=a.default.instance.camera.getScreenToWorldPoint(t.getLocation(),null);r.default.isTutorial?(n=o.y-u.default.instance.TutorialPlayer.node.position.y,e=o.x-u.default.instance.TutorialPlayer.node.position.x):(n=o.y-r.default.instance.localPlayer.node.position.y,e=o.x-r.default.instance.localPlayer.node.position.x)}if(this.angle=Math.atan2(n,e),this.dpad.active){if(e*e+n*n>1e4&&(e=Math.round(100*Math.cos(this.angle)),n=Math.round(100*Math.sin(this.angle))),r.default.isTutorial&&u.default.instance&&3==u.default.instance.performAction)return;this.dpad.getChildByName("indicator").setPosition(e,n)}this.angle*=180/Math.PI,this.angle<0&&(this.angle+=360)}if(t.target==this.buttonFire&&r.default.USE_DYNAMIC_BOMB){e=t.getLocationX()-this.fireCenterPos.x,n=t.getLocationY()-this.fireCenterPos.y;var i=Math.atan2(n,e),s=Math.sqrt(e*e+n*n);s>100&&(s=100,e=Math.round(100*Math.cos(i)),n=Math.round(100*Math.sin(i))),t.target.getChildByName("indicator").setPosition(e,n),(i*=180/Math.PI)<0&&(i+=360),this.fireInfo=l.Utils.extend(this.fireInfo,{fire_dir:i,fire_range:Math.round(s)})}},e.prototype.onTouchEnd=function(t){t.target==this.touchZone&&(this.dpad.active&&(this.dpad.getChildByName("indicator").setPosition(cc.Vec2.ZERO),this.defaultDpadPos&&this.dpad.setPosition(this.defaultDpadPos)),null!=this.startPos&&(this.startPos=null,this.setInput({direction:-1})),!r.default.isTutorial||u.default.tutorial_status!=u.TUTORIAL_STATE.Tutorial_shield&&u.default.tutorial_status!=u.TUTORIAL_STATE.Tutorial_skill||u.default.tutorial_sub_status!=u.TUTORIAL_SUB_STATE.Tutorial_checkdoAction||3!=u.default.instance.performAction||(u.default.instance.performAction=4)),t.target==this.buttonFire?r.default.USE_DYNAMIC_BOMB?(this.fireInfo=l.Utils.extend(this.fireInfo,{fire:t.target==this.buttonFire?1:2}),this.setInput(this.fireInfo),t.target.getChildByName("indicator").setPosition(cc.Vec2.ZERO),t.target.zIndex=this.buttonZIndex,this.fireCenterPos=null):(this.buttonFire.getChildByName("indicator").setScale(1),r.default.isTutorial?this.setInput({fire:1,fire_dir:0,fire_range:r.default.dynamic_range}):this.setInput({fire:1,fire_dir:r.default.instance.localPlayer.direction,fire_range:r.default.dynamic_range}),r.default.pressed_btnfire=!1):t.target==this.buttonSkill&&(this.fireInfo=l.Utils.extend(this.fireInfo,{fire:t.target==this.buttonFire?1:2}),this.setInput(this.fireInfo),t.target.getChildByName("indicator").setPosition(cc.Vec2.ZERO),t.target.zIndex=this.buttonZIndex,this.fireCenterPos=null)},e.prototype.onButtonFire=function(t,e){2==+e&&(t.target.getComponent(cc.Button).interactable=!1),r.default.isTutorial?this.setInput({fire:e,fire_dir:u.default.instance.TutorialPlayer.direction,fire_range:100}):this.setInput({fire:e,fire_dir:r.default.instance.localPlayer.direction,fire_range:100})},i([h(cc.Node)],e.prototype,"touchZone",void 0),i([h(cc.Node)],e.prototype,"dpad",void 0),i([h(cc.Node)],e.prototype,"buttonFire",void 0),i([h(cc.Node)],e.prototype,"buttonSkill",void 0),e=i([f],e)}(cc.Component));n.default=d,cc._RF.pop()},{"../player-ref":"player-ref","../utils":"utils","./camera-control":"camera-control","./game":"game","./input":"input","./tutorial":"tutorial"}],input:[function(t,e,n){"use strict";cc._RF.push(e,"bed7bnlgMFOZpevQfwvrVm0","input"),Object.defineProperty(n,"__esModule",{value:!0});var o=t("../utils"),i=function(){function t(){this.inputSources={}}return Object.defineProperty(t,"instance",{get:function(){return null==t._instance&&(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),t.prototype.set=function(t,e){this.inputSources[e]&&(t=o.Utils.extend(this.inputSources[e],t)),this.inputSources[e]=t},t.prototype.clear=function(){this.inputSources={}},t.prototype.getData=function(){var t=null;for(var e in this.inputSources)t=o.Utils.extend(t,this.inputSources[e]);return this.inputSources={},t},t._instance=null,t}();n.default=i,cc._RF.pop()},{"../utils":"utils"}],leaderboard:[function(t,e,n){"use strict";cc._RF.push(e,"437178fOrVOcaorDxSqW/zb","leaderboard");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=t("../game"),a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.entryPrefab=null,e.content=null,e.ranks=[],e}return o(e,t),e.prototype.start=function(){},e.prototype.setData=function(t){var e=this,n=0;for(t.forEach(function(t,o){var i=o+1,a=e.content.children[n++];a||((a=cc.instantiate(e.entryPrefab)).getChildByName("rank-icon").addComponent(cc.Sprite),e.content.addChild(a)),i<=3?(a.getChildByName("rank-icon").active=!0,a.getChildByName("rank-icon").getComponent(cc.Sprite).spriteFrame=e.ranks[i-1],a.getChildByName("rank").active=!1):(a.getChildByName("rank-icon").active=!1,a.getChildByName("rank").active=!0,a.getChildByName("rank").getComponent(cc.Label).string=i+"."),a.getChildByName("score").getComponent(cc.Label).string=""+t.score;var s=a.getChildByName("name");r.default.instance.localPlayer.id==t.id?s.color=cc.Color.GREEN:s.color=cc.Color.WHITE,s.getComponent(cc.Label).string=""+t.name});n<this.content.childrenCount;){this.content.children[n++].removeFromParent()}},i([c(cc.Prefab)],e.prototype,"entryPrefab",void 0),i([c(cc.Node)],e.prototype,"content",void 0),i([c({type:[cc.SpriteFrame]})],e.prototype,"ranks",void 0),e=i([s],e)}(cc.Component);n.default=l,cc._RF.pop()},{"../game":"game"}],"levelexp-control":[function(t,e,n){"use strict";cc._RF.push(e,"252a0kiAstMlKV93GoRKYlM","levelexp-control");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=t("../../core/event-manager"),a=t("../player"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.text=null,e.expBar=null,e}return o(e,t),e.prototype.start=function(){this.expBar=this.getComponent(cc.ProgressBar),r.default.instance.register(a.default.EVENT_LOCAL_PLAYER_EXP_CHANGE,this.onExpUpdate,this)},e.prototype.onExpUpdate=function(t,e){var n=a.default.getLevelExp(t);this.expBar.progress=e/n,this.text.string="Lvl: "+t+" / Exp: "+e},e.prototype.onDestroy=function(){r.default.instance.unregisterTarget(this)},i([l(cc.Label)],e.prototype,"text",void 0),e=i([c],e)}(cc.Component);n.default=u,cc._RF.pop()},{"../../core/event-manager":"event-manager","../player":"player"}],loader:[function(t,e,n){"use strict";cc._RF.push(e,"9353alEtjFNbItXpbB1+rL+","loader");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=t("./transport-message"),a=t("../player-ref"),s=t("./event-manager"),c=t("./sound-manager"),l=t("./localization"),u=t("../game/resources-cacher"),p=cc._decorator,f=p.ccclass,h=p.property,d=p.executionOrder,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nextScene="main-menu",e.targetLoad="",e._loadInstances={PlayerRef:!1,Sound:!1,Character:!1},e._loadGame=!1,e}var n;return o(e,t),n=e,e.prototype.onLoad=function(){if(0==n.loaded)if("loader"!=this.getCurrentSceneName()){var t=""!=this.targetLoad?this.targetLoad:this.getCurrentSceneName();r.default.instance.send("loader","nextScene",t),cc.director.loadScene("loader")}else{n.loaded=!0;var e=r.default.instance.get("loader","nextScene");this.nextScene=null!=e?e:this.nextScene}},e.prototype.start=function(){"loader"==this.getCurrentSceneName()&&this.initLoader()},e.prototype.initLoader=function(){var t=this;s.default.instance.registerOnce("PlayerRef-init",function(){t._loadInstances.PlayerRef=!0},this),s.default.instance.registerOnce("Sound_initialized",function(){t._loadInstances.Sound=!0},this),s.default.instance.registerOnce("Resources-Cached",function(){t._loadInstances.Character=!0}),a.default.current,u.default.instance.load(),c.default.instance.init(),null==l.default.getCurrentLanguage()&&l.default.setLanguage(cc.sys.language)},e.prototype.update=function(t){a.default.current.initialized&&(this._loadInstances.PlayerRef=!0);var e=!0;for(var n in this._loadInstances)if(0==this._loadInstances[n]){e=!1;break}e&&!this._loadGame&&(this._loadGame=!0,cc.director.loadScene(this.nextScene))},e.prototype.getCurrentSceneName=function(){var t="";return cc.game._sceneInfos.forEach(function(e){e.uuid==cc.director._scene._id&&(t=(t=e.url).substring(t.lastIndexOf("/")+1).match(/[^\.]+/)[0])}),t},e.loaded=!1,i([h],e.prototype,"targetLoad",void 0),e=n=i([f,d(-100)],e)}(cc.Component);n.default=y,cc._RF.pop()},{"../game/resources-cacher":"resources-cacher","../player-ref":"player-ref","./event-manager":"event-manager","./localization":"localization","./sound-manager":"sound-manager","./transport-message":"transport-message"}],localization:[function(t,e,n){"use strict";cc._RF.push(e,"71238deafNK+p8wUFQbZvd1","localization"),Object.defineProperty(n,"__esModule",{value:!0});var o=t("i18n"),i=function(){function t(){}return t.get=function(t){var e=o.t(t);return""==e&&(e="N/A"),e},t.setLanguage=function(t){if(o.init(t)){for(var e=cc.director.getScene().children,n=[],i=0;i<e.length;++i){var r=e[i].getComponentsInChildren("LabelLocalized");Array.prototype.push.apply(n,r)}for(i=0;i<n.length;++i){n[i].updateLabel()}}},t.getCurrentLanguage=function(){return o.getSaveLang()},t}();n.default=i,cc._RF.pop()},{i18n:"i18n"}],"main-menu":[function(t,e,n){"use strict";cc._RF.push(e,"7ed0aJhOqZCxoUZ/Kdztn4n","main-menu");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r,a=t("../../core/popup"),s=t("../../player-ref"),c=t("../game"),l=t("../../core/sound-manager"),u=t("../../utils"),p=t("../online/ServerConnectionRequest"),f=t("../online/ServerDisconnectionRequest"),h=t("../online/ServerInfoRequest"),d=t("../online/PingRequest");(function(t){t[t.None=-1]="None",t[t.Bomb=0]="Bomb",t[t.Character=1]="Character",t[t.Map=2]="Map",t[t.Skill=3]="Skill",t[t.Control=4]="Control",t[t.Servers=5]="Servers"})(r=n.Tabs||(n.Tabs={}));var y=cc._decorator,g=y.ccclass,_=y.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.controlFrames=[],e.tabFrames=[],e.contentFrames=[],e.popupProfile=null,e.badWords=null,e.nameBox=null,e.popupAbout=null,e.tab=r.None,e.mainChar=null,e.mainSkill=null,e.mainGreeting=null,e.popup=null,e.mc_anim=["rabbit","penguin","leaf"],e.popup_title=["BOMB COLOR","YOUR CHARACTER","MAP","","SETTING","SELECT SERVER"],e.pingColors=[cc.Color.GREEN,cc.Color.YELLOW,cc.Color.RED],e.posAboutStart=-120,e.posAboutEnd=3700,e.speed_pos=70,e.VERSION="v1.0.5a",e.nameEditing=!1,e}var n;return o(e,t),n=e,e.prototype.onLoad=function(){this.updateSound()},e.prototype.start=function(){this.popup=this.node.getChildByName("selectSkinPopup");var t=cc.find("/Canvas/main-menu-content");this.mainChar=t.children[1].getComponent(cc.Animation),this.mainSkill=t.children[2].children[1].getComponent(cc.Sprite),this.mainGreeting=t.children[3].children[1].getComponent(cc.Label),this.setupMainContent(),this.checkTutorial(),this.gotoAP=!1,a.default.instance&&a.default.instance.setTarget(this.node),l.default.instance.playMusic("m_ih_menu");this.popupProfile.getChildByName("content").getChildByName("OutputMsg").getComponent(cc.Label);window.dataLayer&&(console.log("pushing dataLayer..."),window.dataLayer.push({event:"ga_event",ga_category:"Gamepage",ga_action:"Main Menu",ga_label:window.productTitle,ga_noninteraction:!0}),n.gtm_gameReturn())},e.gtm_gameReturn=function(){console.log("gtm_gameReturn()");var t=new Date,e=t.getTime(),n=u.Utils.Atob(cc.sys.localStorage.getItem(u.Utils.Btoa(window.productKey+"gameReturn_lastPlayInDays"))),o="",i=u.Utils.Atob(cc.sys.localStorage.getItem(u.Utils.Btoa(window.productKey+"gameReturn_firstDayInDays"))),r=u.Utils.Atob(cc.sys.localStorage.getItem(u.Utils.Btoa(window.productKey+"gameReturn_firstDayGTM001"))),a="Dxx";if(null==r)if(i=n=Math.ceil(e/864e5),r=""+t.getFullYear()+u.Utils.zeropad(t.getMonth()+1,2)+u.Utils.zeropad(t.getDate(),2),a="D00",cc.sys.localStorage.setItem(u.Utils.Btoa(window.productKey+"gameReturn_lastPlayInDays"),u.Utils.Btoa(n)),cc.sys.localStorage.setItem(u.Utils.Btoa(window.productKey+"gameReturn_firstDayGTM001"),u.Utils.Btoa(r)),cc.sys.localStorage.setItem(u.Utils.Btoa(window.productKey+"gameReturn_firstDayInDays"),u.Utils.Btoa(i)),1==c.default.USE_NEW_PORTAL){var s=a+"-"+window.productTitle;window.dataLayer.push({event:"ga_event",ga_category:"Gamepage",ga_action:"Return",ga_label:s,ga_noninteraction:!0})}else window.dataLayer.push({event:"gameReturn",ga_category:"Gamepage",ga_action:"Return",ga_label:window.productTitle,ga_noninteraction:!0});else if((o=Math.ceil(e/864e5))>n)if(a="D"+u.Utils.zeropad(o-parseInt(i),2),n=o,cc.sys.localStorage.setItem(u.Utils.Btoa(window.productKey+"gameReturn_lastPlayInDays"),u.Utils.Btoa(n)),1==c.default.USE_NEW_PORTAL){s=a+"-"+window.productTitle;window.dataLayer.push({event:"ga_event",ga_category:"Gamepage",ga_action:"Return",ga_label:s,ga_noninteraction:!0})}else window.dataLayer.push({event:"gameReturn",ga_category:"Gamepage",ga_action:"Return",ga_label:window.productTitle,ga_noninteraction:!0})},e.prototype.showLog=function(t,e){cc.log("ludiSDK error: ",e)},e.prototype.showCustomPopup=function(t,e){this.popup.active=!0,this.popup.children[1].children.forEach(function(e){e.active="close"==e.name||e.name==t}),this.selectSkinPopup_setTitle(e)},e.prototype.selectSkinPopup_setTitle=function(t){this.popup.children[2].children[0].getComponent(cc.Label).string=t},e.prototype.activePopup=function(t,e){void 0===t&&(t=!0),void 0===e&&(e=!0);var n=this.popup.children[1].children;n[0].active=t&&e,n[1].active=t&&e,n[2].active=t&&!e,n[3].active=t&&!e,n[4].active=!1,this.popup.active=t},e.prototype.checkTutorial=function(){switch(+s.default.current.user){case 0:c.default.isTutorial=1==s.default.current.isRabitTutorial;break;case 1:c.default.isTutorial=1==s.default.current.isPenguinTutorial;break;case 2:c.default.isTutorial=1==s.default.current.isLeafTutorial}},e.prototype.onButtonPlay=function(){l.default.instance.playEffect("sfx_ui_select"),null!=n.servers[s.default.current.last_server_selection]?this.goToBattle():this.showServerSelectionPopup()},e.prototype.onButtonHelp=function(t,e){l.default.instance.playEffect("sfx_ui_select"),this.node.getChildByName("helpPopup").active=!0},e.prototype.onButtonClose=function(t,e){l.default.instance.playEffect("sfx_ui_back"),this.setPlayerRef(),this.activePopup(!1),this.node.getChildByName("infoPopup").active=!1,this.tab=r.None},e.prototype.onEditting=function(){this.nameEditing&&(this.nameBox.string=this.nameBox.string.trim())},e.prototype.onEditedName=function(t){var e=this;if(this.nameEditing){this.nameEditing=!1,cc.log("onEditedName()");var n=!1,o=t.string.toLowerCase();if(0==t.string.length||-1!=o.indexOf(" "))n=!0;else for(var i in this.badWords.json)if(this.badWords.json[i].blacklisted.indexOf(o)>=0){n=!0;break}if(n)a.default.instance.showInfoPopup("Empty or Invalid character's name.\nPlease be polite in naming!",function(){t.string=t.placeholder=s.default.current.name,e.nameEditing=!0});else{s.default.current.name=t.string,this.mainGreeting.string="Welcome "+t.string+"!";var r=cc.find("/board/content-control/character-name",this.popup).children;r[2].active=!1,r[0].children[0].getComponent(cc.Label).string=t.string,r[0].children[0].active=!0}}},e.prototype.onButtonGreeting=function(){l.default.instance.playEffect("sfx_ui_select"),this.showGreetingPopup()},e.prototype.onButtonControl=function(){l.default.instance.playEffect("sfx_ui_select"),this.activePopup(!0,!1),this.setupPopupContent(r.Control)},e.prototype.onButtonAbout=function(){l.default.instance.playEffect("sfx_ui_select"),this.node.getChildByName("infoPopup").active=!0;var t=this.popupAbout.getChildByName("Mask_page").getChildByName("pageAll");t.getChildByName("version").getComponent(cc.Label).string=this.VERSION,t.y=this.posAboutStart,t.setPosition(t.x,t.y)},e.prototype.update=function(t){this.popup.active&&(n=this.popup.getChildByName("board")).getChildByName("close").setPosition(n.getPosition().x+n.width/2-60,n.getPosition().y+n.height/2-40);var e=this.popup.children[1].getChildByName("servers_selection_content");if(null!=e&&e.active&&!window.navigator.onLine&&(this.activePopup(!1),this.node.getChildByName("infoPopup").active=!1,this.tab=r.None,this.ShowPopupSomethingWrong()),this.node.getChildByName("infoPopup").active){var n;(n=this.popupAbout.getChildByName("board")).getChildByName("close").setPosition(n.getPosition().x+n.width/2-60,n.getPosition().y+n.height/2-40);var o=this.popupAbout.getChildByName("Mask_page").getChildByName("pageAll");o.y+=this.speed_pos*t,o.y>=this.posAboutEnd&&(o.y=this.posAboutStart),o.setPosition(o.x,o.y)}},e.prototype.onButtonSound=function(){l.default.instance.soundEnable?l.default.instance.setEnable(!1):(l.default.instance.setEnable(!0),l.default.instance.playEffect("sfx_ui_select")),this.updateSound()},e.prototype.updateSound=function(){var t=this.node.getChildByName("buttonSound"),e=this.node.getChildByName("buttonSound-off");l.default.instance.soundEnable?(t.active=!0,e.active=!1,l.default.instance.resumeAll()):(t.active=!1,e.active=!0,l.default.instance.pauseAll())},e.prototype.onButtonSkin=function(){l.default.instance.playEffect("sfx_ui_select"),this.activePopup(),this.setupPopupContent(r.Character)},e.prototype.onButtonChangeName=function(){cc.log("onButtonChangeName()"),l.default.instance.playEffect("sfx_ui_select");var t=cc.find("/board/content-control/character-name",this.popup).children;t[0].children[0].active=!1,t[1].active=!1,this.nameBox.placeholder=this.nameBox.string=s.default.current.name,this.nameBox.node.active=!0,this.nameBox.focus(),this.nameEditing=!0},e.prototype.onTabButton=function(t,e){l.default.instance.playEffect("sfx_ui_select"),this.tab!=e&&(this.setPlayerRef(),this.setupPopupContent(e,t.target))},e.prototype.onArrowButton=function(t,e){l.default.instance.playEffect("sfx_ui_next");var n=Math.abs(e);n>2?e>0?++this.item==n&&(this.item=0):e<0&&--this.item<0&&(this.item=n-1):(this.item=1-this.item,this.popup.children[1].children[3].children[0].active=this.item<1,this.popup.children[1].children[3].children[1].active=this.item>0);this.setupPopupContent(this.tab)},e.prototype.setupMainContent=function(){this.mainChar.play(this.mc_anim[+s.default.current.user]),this.mainSkill.spriteFrame=this.contentFrames[+s.default.current.user+3*r.Skill],this.mainGreeting.string=this.mainGreeting.string="Welcome, "+s.default.current.name+"!"},e.prototype.setPlayerRef=function(){this.tab==r.Bomb?s.default.current.bomb=this.item:this.tab==r.Character?s.default.current.user=this.item:this.tab==r.Map?s.default.current.map=this.item:this.tab==r.Control&&(s.default.current.control=this.item),this.checkTutorial(),this.setupMainContent()},e.prototype.getPlayerRef=function(){var t=-1;return this.tab==r.Bomb?t=s.default.current.bomb:this.tab==r.Character?t=s.default.current.user:this.tab==r.Map?t=s.default.current.map:this.tab==r.Control&&(t=s.default.current.control),t},e.prototype.setupPopupContent=function(t,e){var n=this;(this.tab<r.Bomb||this.tab!=t)&&(this.tab=t,this.item=this.getPlayerRef(),this.popup.children[2].children[0].getComponent(cc.Label).string=this.popup_title[t]);if(this.tab<r.Control){var o=cc.find("/board/content-skin",this.popup);o.children[3].children.forEach(function(e,o){e.getComponent(cc.Sprite).spriteFrame=o==t?n.tabFrames[o+3]:n.tabFrames[o]}),this.setupSkinContent(o)}else this.tab<r.Servers?this.setupControlContent():this.setupServersContent(t)},e.prototype.setupSkinContent=function(t){var e=+this.item,n=e>0?e-1:2,o=e<2?e+1:0,i=t.children[1].children;i[0].getComponent(cc.Sprite).spriteFrame=this.contentFrames[n+3*this.tab],i[1].getComponent(cc.Sprite).spriteFrame=this.contentFrames[o+3*this.tab],i[2].getComponent(cc.Sprite).spriteFrame=this.contentFrames[e+3*this.tab];var a=t.children[2];this.tab==r.Character?(a.children[0].getComponent(cc.Sprite).spriteFrame=this.contentFrames[n+3*r.Skill],a.children[1].getComponent(cc.Sprite).spriteFrame=this.contentFrames[o+3*r.Skill],a.children[2].getComponent(cc.Sprite).spriteFrame=this.contentFrames[e+3*r.Skill],a.active=!0):a.active=!1},e.prototype.setupControlContent=function(){(cc.find("/board/content-control/character-name/name-bg/name",this.popup).getComponent(cc.Label).string=s.default.current.name,cc.sys.isMobile)&&(cc.find("board/content-control/control-type/desc",this.popup).getComponent(cc.Label).string="USE D-PAD TO MOVE JELLY");cc.find("board/content-control/control-type/popup-control-type/image-desc",this.popup).getComponent(cc.Sprite).spriteFrame=this.controlFrames[this.item],this.popup.children[1].children[3].children[0].active=!cc.sys.isMobile&&this.item<1,this.popup.children[1].children[3].children[1].active=!cc.sys.isMobile&&this.item>0},e.prototype.setupServersContent=function(t){},e.prototype.onButtonLogin=function(){var t=this.popupProfile.getChildByName("content");t.getChildByName("EmailInput").getChildByName("editbox").getComponent(cc.EditBox),t.getChildByName("passInput").getChildByName("editbox").getComponent(cc.EditBox)},e.prototype.onButtonRegister=function(){var t=this.popupProfile.getChildByName("content");t.getChildByName("EmailInput").getChildByName("editbox").getComponent(cc.EditBox),t.getChildByName("passInput").getChildByName("editbox").getComponent(cc.EditBox)},e.prototype.onServerSelectionButtonPressed=function(){this.showServerSelectionPopup()},e.prototype.onServerButtonPressed=function(t,e){l.default.instance.playEffect("sfx_ui_select");for(var o=this.popup.children[1].children[4].children[0].children,i=0;i<o.length;i++)o[i].children[0].children[1].active=i==e,o[i].children[1].children[1].active=i==e;s.default.current.last_server_selection=e,this.onServerSelected(n.servers[e])},e.prototype.onServerSelected=function(t){var e=this,n=this.popup.children[1].children[4].children[1].children[1].children[0].getComponent(cc.Label);console.log("MainMenu - onServerSelected - title: "+(n?"not null":"null")+" - server: "+(t?"not null":"null")),n.string=t.name;var o=this.popup.children[1].children[4].children[1].children[4].children[0].getComponent(cc.Button);o.enabled=!1;var i=function(t){for(var n=e.popup.children[1].children[4].children[0].children,o=0;o<n.length;o++)n[o].getComponent(cc.Button).enabled=t&&o!=s.default.current.last_server_selection,n[o].children[1].getChildByName("disable").active=!t};i(!1),this.popup.children[1].children[4].children[1].children[2].getComponent(cc.Label).string="";var r=this.popup.children[1].children[4].children[1].children[3];r.getComponent(cc.Label).string="waiting server response...",r.color=cc.Color.WHITE,new p.default(t,function(){console.log("MainMenu::onServerSelected - onConnected() - Server: "+t.name);var n=new h.default(function(t){var n="Players: %d/200";n=n.replace("%d",t.player_count.toString()),e.popup.children[1].children[4].children[1].children[2].getComponent(cc.Label).string=n,o.enabled=!0,o.node.active=t.player_count<200}),a=new d.default(function(t){var n="Ping: %d";n=n.replace("%d",t.toString()),r.color=e.pingColors[t<60?0:t<120?1:2],r.getComponent(cc.Label).string=n,i(!0),(new f.default).start()});n.start(),a.start()},function(t){console.log("MainMenu - onServerSelected - connect fail"+t),r.getComponent(cc.Label).string="CONNECTION FAILED",r.color=cc.Color.RED,i(!0)},!0).start()},e.prototype.onJoinNowPressed=function(){l.default.instance.playEffect("sfx_ui_select"),this.goToBattle()},e.prototype.onServerInfoChanged=function(t){this.popup.children[1].children[4].children[1].children[2].getComponent(cc.Label).string=t.player_count.toString()},e.prototype.showGreetingPopup=function(){this.onButtonControl(),this.onButtonChangeName()},e.prototype.showServerSelectionPopup=function(){if(window.navigator.onLine){this.showCustomPopup("servers_selection_content",this.popup_title[r.Servers]);var t=0==s.default.current.first_launch_step||null==s.default.current.last_server_selection?0:s.default.current.last_server_selection;this.onServerButtonPressed(null,t)}else this.ShowPopupSomethingWrong()},e.prototype.goToBattle=function(){window.navigator.onLine?(window.dataLayer&&window.dataLayer.push({event:"ga_event",ga_category:"Gamepage",ga_action:"Start",ga_label:window.productTitle,ga_noninteraction:!0}),l.default.instance.playEffect("sfx_ui_select"),this.gotoAP||(this.gotoAP=!0,a.default.instance.showWaitingPopup("Loading... "),s.default.current,this.checkTutorial(),1==c.default.isTutorial?cc.director.preloadScene("tutorial",function(t){cc.director.loadScene("tutorial",function(){l.default.instance.stop("m_ih_menu"),a.default.instance.hideWaitingPopup()})}):cc.director.preloadScene("game",function(t){cc.director.loadScene("game",function(){l.default.instance.stop("m_ih_menu"),a.default.instance.hideWaitingPopup()})}))):this.ShowPopupSomethingWrong()},e.prototype.ShowPopupSomethingWrong=function(){a.default.instance.showInfoPopup("Opss, something's wrong...\nPlease try again later!",function(){cc.director.loadScene("main-menu")})},e.servers=[{name:"SERVER 1",host:"gameserver-sin.ludigames.com",port:3001,secure:!0},{name:"SERVER 2",host:"jellimon-be.ludigames.com",port:3001,secure:!0}],i([_({type:cc.SpriteFrame})],e.prototype,"controlFrames",void 0),i([_({type:cc.SpriteFrame})],e.prototype,"tabFrames",void 0),i([_({type:cc.SpriteFrame})],e.prototype,"contentFrames",void 0),i([_(cc.Node)],e.prototype,"popupProfile",void 0),i([_(cc.JsonAsset)],e.prototype,"badWords",void 0),i([_(cc.EditBox)],e.prototype,"nameBox",void 0),i([_(cc.Node)],e.prototype,"popupAbout",void 0),e=n=i([g],e)}(cc.Component);n.default=m,cc._RF.pop()},{"../../core/popup":"popup","../../core/sound-manager":"sound-manager","../../player-ref":"player-ref","../../utils":"utils","../game":"game","../online/PingRequest":"PingRequest","../online/ServerConnectionRequest":"ServerConnectionRequest","../online/ServerDisconnectionRequest":"ServerDisconnectionRequest","../online/ServerInfoRequest":"ServerInfoRequest"}],minimap:[function(t,e,n){"use strict";cc._RF.push(e,"c4ac6yJB7lBGrU3RjNzd2PQ","minimap");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=t("../game"),a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.indicatorPrefab=null,e.ranks=[],e.ratio=130/960,e.radius=55,e.indicators={},e}return o(e,t),e.prototype.start=function(){var t=cc.instantiate(this.indicatorPrefab);t.color=cc.Color.BLUE,t.setPosition(cc.Vec2.ZERO),this.node.addChild(t)},e.prototype.updatePlayersPosition=function(t){for(var e in t){var n=(t[e].node.position.x-r.default.instance.localPlayer.node.position.x)*this.ratio,o=(t[e].node.position.y-r.default.instance.localPlayer.node.position.y)*this.ratio,i=n,a=o;if(n*n+o*o>this.radius*this.radius){var s=Math.atan2(o,n);i=Math.cos(s)*this.radius,a=Math.sin(s)*this.radius}if(!this.indicators[e]){var c=cc.instantiate(this.indicatorPrefab);this.node.addChild(c),this.indicators[e]=c}this.indicators[e].setPosition(i,a)}},e.prototype.updatePlayersDisplay=function(t){var e=this;t.forEach(function(t,n){var o=n+1;e.indicators[t.id]&&(o>3?e.indicators[t.id].setContentSize(8,8):(e.indicators[t.id].setContentSize(16,16),e.indicators[t.id].getComponent(cc.Sprite).spriteFrame=e.ranks[o-1]))})},e.prototype.removeFromMap=function(t){var e=this;t.forEach(function(t){e.indicators[t]&&(e.indicators[t].removeFromParent(),delete e.indicators[t])})},i([c(cc.Prefab)],e.prototype,"indicatorPrefab",void 0),i([c({type:[cc.SpriteFrame]})],e.prototype,"ranks",void 0),e=i([s],e)}(cc.Component);n.default=l,cc._RF.pop()},{"../game":"game"}],"net-component":[function(t,e,n){"use strict";cc._RF.push(e,"fea8da722ZC95gC22UVgYRv","net-component");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=cc._decorator,a=r.ccclass,s=(r.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._cid=0,e.x=0,e.y=0,e.death=!1,e.lastStateTime=0,e.isDestroying=!1,e}return o(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._cid},enumerable:!0,configurable:!0}),e.prototype.init=function(t){this._cid=t.id,this.x=t.x,this.y=t.y,this.lastStateTime=Date.now()},e.prototype.setStateData=function(t){this.x=t.x||this.x,this.y=t.y||this.y,this.lastStateTime=Date.now()},e.prototype.isDeath=function(){return this.death||Date.now()-this.lastStateTime>3e3},e.prototype.setDeath=function(t){this.death=t},e.prototype.onDeath=function(t){},e.prototype.lateUpdate=function(){this.isDeath()&&!this.isDestroying&&(this.isDestroying=!0,this.death?this.onDeath():this.onDeath(!0))},e.EVENT_NET_ENTITY_DEATH="net_entity_death",e=i([a],e)}(cc.Component));n.default=s,cc._RF.pop()},{}],notifier:[function(t,e,n){"use strict";cc._RF.push(e,"3a306RSYKBKrLVIcyToKxJC","notifier");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=cc._decorator,a=r.ccclass,s=r.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.notifyItem=null,e.container=null,e}return o(e,t),e.prototype.start=function(){this.container=this.getComponent(cc.Layout)},e.prototype.addNotify=function(t){var e=cc.instantiate(this.notifyItem);e.getComponent(cc.RichText).string=t,this.node.insertChild(e,0),e.runAction(cc.sequence(cc.delayTime(3),cc.fadeOut(.5),cc.callFunc(function(){e.removeFromParent()})))},i([s(cc.Prefab)],e.prototype,"notifyItem",void 0),e=i([a],e)}(cc.Component);n.default=c,cc._RF.pop()},{}],"player-control-local":[function(t,e,n){"use strict";cc._RF.push(e,"db6dbZnbG1NmZ2aMRQ2xy8e","player-control-local");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=t("./player"),a=t("./player-control"),s=t("./input"),c=t("../core/event-manager"),l=t("./game"),u=t("./ConfigGame"),p=t("./tutorial"),f=t("../player-ref"),h=cc._decorator,d=h.ccclass,y=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lastInputTime=null,e.lastInputSeq=0,e.pendingInputs=[],e}return o(e,t),e.prototype.init=function(t){this.client=t,s.default.instance.clear()},e.prototype.start=function(){t.prototype.start.call(this),c.default.instance.dispatch(r.default.EVENT_LOCAL_PLAYER_EXP_CHANGE,1,0),null!=this.client&&this.player.updateAction(r.PlayerAction.Idle,90)},e.prototype.setServerData=function(e){null!=this.client&&(t.prototype.setServerData.call(this,e),this.player.level==e.level&&this.player.exp==e.exp||c.default.instance.dispatch(r.default.EVENT_LOCAL_PLAYER_EXP_CHANGE,e.level,e.exp))},e.prototype.handleDeath=function(){return!0},e.prototype.update=function(t){null!=this.client&&this.processServerData(),this.processInput()},e.prototype.processServerData=function(){for(;this.serverData.length>0;){var t=this.serverData.shift();this.player.updatePlayerInfo(t.x,t.y,t.opacity,t.health,t.level,t.exp,t.death,t.vulnerable,t.bombable,t.skillable,t.buffs),this.player.cskin=t.cskin,this.player.healthBar.updateNotify();var e=t.lastInputSeq;if(this.player.setPosition(t.x,t.y),this.pendingInputs.length>0)for(var n=0;n<this.pendingInputs.length;){var o=this.pendingInputs[n];o.seq<=e?this.pendingInputs.splice(n,1):(this.applyInput(o),n++)}else this.player.action==t.action&&this.player.direction==t.direction||this.player.updateAction(t.action,t.direction)}},e.prototype.processInput=function(){var t=Date.now(),e=t-(this.lastInputTime||t);this.lastInputTime=t;var n=s.default.instance.getData();if(n){var o={direction:n.direction,time:e,seq:65535&this.lastInputSeq++,fire:n.fire,fire_dir:n.fire_dir,fire_range:n.fire_range};this.validateInput(o)&&(null!=this.client?(this.client.sendAction(o),this.applyInput(o),this.pendingInputs.push(o)):(this.applyInput(o),this.pendingInputs.push(o)))}},e.prototype.validateInput=function(t){return t.time<40},e.prototype.applyInput=function(t){var e,n=-1,o=this.player.direction,i=null;if(t.direction>=0){n=r.PlayerAction.Move;var a=0,s=0,c=(o=cc.misc.clampf(t.direction,0,360))*Math.PI/180,h=void 0;h=l.default.isTutorial?u.ConfigGame.PLAYER_SPEED:l.default.instance.playerSpeed,a=Math.cos(c)*h*t.time/1e3,s=Math.sin(c)*h*t.time/1e3,i=cc.v2(Math.round(a),Math.round(s))}else t.direction<0&&(n=r.PlayerAction.Idle);if(l.default.isTutorial?!t.fire&&p.default.instance.updateLocalTarget(t.fire_dir,t.fire_range):l.default.USE_DYNAMIC_BOMB&&!t.fire&&l.default.instance.updateLocalTarget(t.fire_dir,t.fire_range),t.fire)if(this.player.bombable&&1==t.fire)n=r.PlayerAction.Fire,l.default.isTutorial&&this.player.m_bomb&&this.player.m_bomb.collider&&(this.player.m_bomb.collider.tag=2);else if(this.player.skillable&&2==t.fire){if(this.player.cskin==f.DesignType.Fire){c=o*Math.PI/180,a=160*Math.cos(c),s=160*Math.sin(c);i=cc.v2(Math.round(a),Math.round(s)),l.default.isTutorial&&(this.player.collider.enabled=!1,p.default.instance.BOTplayer.collider.enabled=!1)}else this.player.cskin==f.DesignType.Ice?this.player.effectsNode.children[0].active=!0:this.player.cskin==f.DesignType.Grass&&(this.player.node.opacity=100);l.default.isTutorial&&(this.player.m_bomb&&this.player.m_bomb.collider&&(this.player.m_bomb.collider.tag=3),p.default.tutorial_status==p.TUTORIAL_STATE.Tutorial_skill&&p.default.tutorial_sub_status==p.TUTORIAL_SUB_STATE.Tutorial_checkdoAction&&1==p.default.instance.performAction&&(p.default.instance.performAction=2))}(this.player.action==n&&this.player.direction==o||this.player.updateAction(n,o),null!=i)&&(l.default.isTutorial?((e=this.player.node.position.add(i)).x<-460&&(e.x=-460),e.x>460&&(e.x=460),e.y<-300&&(e.y=-300),e.y>300&&(e.y=300),this.player.setPosition(e.x,e.y)):((e=this.player.node.position.add(i)).x-u.ConfigGame.PLAYER_HALF_W<0&&(e.x=u.ConfigGame.PLAYER_HALF_W),e.x+u.ConfigGame.PLAYER_HALF_W>u.ConfigGame.WORLD_WIDTH&&(e.x=u.ConfigGame.WORLD_WIDTH-u.ConfigGame.PLAYER_HALF_W),e.y-u.ConfigGame.PLAYER_HALF_H<0&&(e.y=u.ConfigGame.PLAYER_HALF_H),e.y+u.ConfigGame.PLAYER_HALF_H>u.ConfigGame.WORLD_HEIGHT&&(e.y=u.ConfigGame.WORLD_HEIGHT-u.ConfigGame.PLAYER_HALF_H),this.player.setPosition(e.x,e.y)))},e=i([d],e)}(a.default));n.default=y,cc._RF.pop()},{"../core/event-manager":"event-manager","../player-ref":"player-ref","./ConfigGame":"ConfigGame","./game":"game","./input":"input","./player":"player","./player-control":"player-control","./tutorial":"tutorial"}],"player-control":[function(t,e,n){"use strict";cc._RF.push(e,"90f57EPrz1OM67MW60qUuLP","player-control");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=t("./player"),a=t("./game"),s=cc._decorator,c=s.ccclass,l=(s.property,s.requireComponent),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.serverData=[],e.positionBuffer=[],e}return o(e,t),e.prototype.onLoad=function(){this.player=this.getComponent(r.default),this.player.controller=this},e.prototype.start=function(){},e.prototype.setServerData=function(t){a.default.isTutorial||this.serverData.push(t)},e.prototype.update=function(t){a.default.isTutorial?this.processPosition():(this.processServerData(),this.processPosition())},e.prototype.processServerData=function(){for(;this.serverData.length>0;){var t=this.serverData.shift();this.player.setServerData(t),this.positionBuffer.push([cc.v2(t.x,t.y),Date.now()])}},e.prototype.handleDeath=function(){return!1},e.prototype.processPosition=function(){for(var t=Date.now()-1e3/30;this.positionBuffer.length>=2&&this.positionBuffer[1][1]<=t;)this.positionBuffer.shift();if(this.positionBuffer.length>=2&&this.positionBuffer[0][1]<=t&&t<=this.positionBuffer[1][1]){var e=this.positionBuffer[0][0],n=this.positionBuffer[1][0],o=this.positionBuffer[0][1],i=this.positionBuffer[1][1],r=e.lerp(n,(t-o)/(i-o));this.player.setPosition(r.x,r.y)}},e.prototype.updateRank=function(t,e){void 0===e&&(e=!1);for(var n=0,o=0;o<3&&o<t.length;o++)this.player.id==t[o].id&&(n=o+1);this.player.setStatus(n,e)},e=i([c,l(r.default)],e)}(cc.Component);n.default=u,cc._RF.pop()},{"./game":"game","./player":"player"}],"player-ref":[function(t,e,n){"use strict";cc._RF.push(e,"4a529iwQnlGbq3EfIYgrRWO","player-ref"),Object.defineProperty(n,"__esModule",{value:!0});var o,i,r=t("./core/event-manager");(function(t){t[t.DPad=0]="DPad",t[t.Touch=1]="Touch"})(o=n.ControlType||(n.ControlType={})),function(t){t[t.Fire=0]="Fire",t[t.Ice=1]="Ice",t[t.Grass=2]="Grass"}(i=n.DesignType||(n.DesignType={}));var a=function(){function t(){this.initialized=!1}return Object.defineProperty(t,"current",{get:function(){return null==this._current&&(this._current=new t,this._current.init()),this._current},enumerable:!0,configurable:!0}),t.prototype.init=function(){this.name||(this.name="Default"),this.control=cc.sys.isMobile?o.DPad:o.Touch,this.user||(this.user=i.Fire),this.bomb||(this.bomb=i.Fire),this.map||(this.map=i.Fire),this.streak||(this.streak=0),this.alive||(this.alive=0),null==this.first_launch_step&&(this.first_launch_step=0),null==this.istutorial&&(this.istutorial=1),null==this.isRabitTutorial&&(this.isRabitTutorial=1),null==this.isPenguinTutorial&&(this.isPenguinTutorial=1),null==this.isLeafTutorial&&(this.isLeafTutorial=1),this.show_help||(this.show_help=1),this.crediental||(this.crediental=""),r.default.instance.dispatch("PlayerRef-init","success"),this.initialized=!0},t.prototype.clear=function(){cc.sys.localStorage.clear()},t.prototype.updateLocalRecord=function(t,e){(!this.streak||this.streak<t)&&(this.streak=t),(!this.alive||this.alive<e)&&(this.alive=e)},Object.defineProperty(t.prototype,"name",{get:function(){return cc.sys.localStorage.getItem("user-name")},set:function(t){cc.sys.localStorage.setItem("user-name",t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"control",{get:function(){return cc.sys.localStorage.getItem("user-control-type")},set:function(t){cc.sys.localStorage.setItem("user-control-type",t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"user",{get:function(){return cc.sys.localStorage.getItem("user-skin")},set:function(t){cc.sys.localStorage.setItem("user-skin",t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bomb",{get:function(){return cc.sys.localStorage.getItem("bomb-skin")},set:function(t){cc.sys.localStorage.setItem("bomb-skin",t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"map",{get:function(){return cc.sys.localStorage.getItem("user-map")},set:function(t){cc.sys.localStorage.setItem("user-map",t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"streak",{get:function(){return cc.sys.localStorage.getItem("user-killstreak")},set:function(t){cc.sys.localStorage.setItem("user-killstreak",t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alive",{get:function(){return cc.sys.localStorage.getItem("user-time-alive")},set:function(t){cc.sys.localStorage.setItem("user-time-alive",t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"show_help",{get:function(){return cc.sys.localStorage.getItem("user-show-help")},set:function(t){cc.sys.localStorage.setItem("user-show-help",t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"istutorial",{get:function(){return cc.sys.localStorage.getItem("user-is-Tutorial")},set:function(t){cc.sys.localStorage.setItem("user-is-Tutorial",t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isRabitTutorial",{get:function(){return cc.sys.localStorage.getItem("user-is-RabitTutorial")},set:function(t){cc.sys.localStorage.setItem("user-is-RabitTutorial",t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPenguinTutorial",{get:function(){return cc.sys.localStorage.getItem("user-is-PenguinTutorial")},set:function(t){cc.sys.localStorage.setItem("user-is-PenguinTutorial",t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLeafTutorial",{get:function(){return cc.sys.localStorage.getItem("user-is-LeafTutorial")},set:function(t){cc.sys.localStorage.setItem("user-is-LeafTutorial",t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"crediental",{get:function(){return cc.sys.localStorage.getItem("user-crediental")},set:function(t){cc.sys.localStorage.setItem("user-crediental",t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"email",{get:function(){return cc.sys.localStorage.getItem("user-email")},set:function(t){cc.sys.localStorage.setItem("user-email",t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"first_launch_step",{get:function(){return cc.sys.localStorage.getItem("first-launch")},set:function(t){cc.sys.localStorage.setItem("first-launch",t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"last_server_selection",{get:function(){return cc.sys.localStorage.getItem("last-server")},set:function(t){cc.sys.localStorage.setItem("last-server",t)},enumerable:!0,configurable:!0}),t._current=null,t}();n.default=a,cc._RF.pop()},{"./core/event-manager":"event-manager"}],player:[function(t,e,n){"use strict";cc._RF.push(e,"355d9UvLmpKJ4kFaCvILZ/X","player");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r,a,s,c=t("./ui/healthbar"),l=t("./net-component"),u=t("../core/event-manager"),p=t("./game"),f=t("./ConfigGame"),h=t("../player-ref"),d=cc._decorator,y=d.ccclass,g=d.property;(function(t){t[t.None=0]="None",t[t.Normal=1]="Normal",t[t.Skill=2]="Skill"})(r=n.AttackType||(n.AttackType={})),function(t){t[t.Idle=1]="Idle",t[t.Move=2]="Move",t[t.Fire=4]="Fire",t[t.Death=8]="Death"}(a=n.PlayerAction||(n.PlayerAction={})),function(t){t[t.None=0]="None",t[t.Immune=1]="Immune",t[t.DmgX2=2]="DmgX2",t[t.DefX2=3]="DefX2",t[t.ExpX2=4]="ExpX2",t[t.SpeedUp=5]="SpeedUp",t[t.Block=6]="Block",t[t.Invisible=7]="Invisible",t[t.Burn=8]="Burn",t[t.Slow=9]="Slow",t[t.Bind=10]="Bind"}(s=n.PlayerStatus||(n.PlayerStatus={}));var _=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.playerName=null,e.healthBar=null,e.sprite=null,e.directionSprite=null,e.rank=null,e.effectsNode=null,e.fx_shield=null,e.rankFrames=[],e.buffFrames=[],e.skill=null,e.atkType=r.None,e.collider=null,e.cskin=h.DesignType.Fire,e.bskin=h.DesignType.Fire,e.maxDistanceCanfire=f.ConfigGame.BOMB_LENGTH,e.isRobot=!1,e.autoMove=!1,e.autoFire=!1,e.targetPos=null,e.stopPoint=!1,e.playerSpeed=f.ConfigGame.PLAYER_SPEED,e.buffs={},e.shield=null,e.numofBombReceive=0,e.health=0,e.level=1,e.exp=0,e.action=0,e.direction=90,e.bombable=!1,e.skillable=!1,e.effects=[],e.invulnerable=!0,e.controller=null,e.isFiring=!1,e.pendingAnim=null,e.move_anim=["move_0","move_45","move_90","move_135","move_180","move_225","move_270","move_315"],e.idle_anim=["idle_0","idle_45","idle_90","idle_135","idle_180","idle_225","idle_270","idle_315"],e.fire_anim=["fire_0","fire_45","fire_90","fire_135","fire_180","fire_225","fire_270","fire_315"],e.animIdx=-1,e.rank_anim=["none","gold","silver","bronze"],e.fx_levelUp=null,e.fx_warn=null,e.fx_buff=null,e}return o(e,t),e.prototype.onCollisionEnter=function(t,e){p.default.isTutorial&&(2==t.tag&&(this.effectsNode.children[0].active?"start-invulnerable"==this.fx_shield.currentClip.name?this.effectsNode.children[0].active=!1:this.numofBombReceive++:(this.health-=f.ConfigGame.BOMB_BASE_DAMGE,this.healthBar.updateHealth(this.level,this.health))))},e.prototype.onCollisionExit=function(t,e){},e.prototype.init=function(e){t.prototype.init.call(this,e),this.animation=this.sprite.getComponent(cc.Animation),this.animation.on("finished",this.onAnimationEvent,this),this.fx_shield=this.effectsNode.children[0].getComponent(cc.Animation),this.fx_shield.play("protector"),this.fx_levelUp=this.effectsNode.children[1],this.fx_buff=this.effectsNode.children[2].getComponent(cc.Sprite),this.fx_warn=this.effectsNode.children[3],this.playerName.string=e.name,this.cskin=e.cskin,this.health=e.health,this.level=e.level,this.exp=e.exp,this.healthBar.updateHealth(this.level,this.health),this.setPosition(e.x,e.y),this.setStatus(0),this.setBombskin(e.id)},e.prototype.setPlayerName=function(t){this.playerName.string=t},e.prototype.getPlayerName=function(){return this.playerName.string},e.prototype.setPosition=function(t,e){this.death||this.node.setPosition(t,e)},e.prototype.setServerData=function(t){this.cskin=t.cskin,this.updatePlayerInfo(t.x,t.y,t.opacity,t.health,t.level,t.exp,t.death,t.vulnerable,t.bombable,t.skillable,t.buffs),this.updateAction(t.action,t.direction)},e.prototype.updatePlayerInfo=function(e,n,o,i,r,a,c,l,u,f,h){var d=this;t.prototype.setStateData.call(this,{x:e,y:n}),this.death=c,this.level<r&&(this.level=r,this.fx_levelUp.active=!0,setTimeout(function(){d.fx_levelUp.active=!1},2e3)),this.healthBar.updateHealth(r,i),this.health=i,this.exp=a,this.bombable=u,this.skillable=f,this.effects=h.slice(),this.invulnerable?l&&(this.invulnerable=!1,this.fx_shield.node.active=!1,this.fx_shield.play("start-invulnerable")):this.fx_shield.node.active=this.hasStatus(s.Block),this.node.opacity=o,this.hasStatus(s.Invisible)&&(this.node.opacity=this==p.default.instance.localPlayer?100:0);var y=!1;[s.ExpX2,s.DefX2,s.DmgX2].forEach(function(t){d.hasStatus(t)&&(y=!0,d.fx_buff.spriteFrame=d.buffFrames[t-2])}),this.fx_buff.node.active=y},e.prototype.setStatus=function(t,e){void 0===e&&(e=!1),this.fx_warn.active=!e&&t>0,this.rank.node.active=t>0;var n=this.rank.getComponent(cc.Animation);t>0?n.play(this.rank_anim[t]):n.stop()},e.prototype.hasStatus=function(t){return this.effects.length>0&&this.effects.indexOf(t)>=0},e.prototype.updateImpactEffects=function(){var t=this,e=!1;[s.ExpX2,s.DefX2,s.DmgX2].forEach(function(n){t.hasStatus(n)&&(e=!0,t.fx_buff.spriteFrame=t.buffFrames[n-2])}),this.fx_buff.node.active=e},e.prototype.activeEffect=function(t,e,n){},e.prototype.deactiveEffect=function(t){this.buffs[t]&&delete this.buffs[t]},e.prototype.updateAction=function(t,e){var n=Math.round(e/45)%8;this.animIdx==n&&t==this.action||(t==a.Move?this.isFiring?this.pendingAnim=this.move_anim[n]:this.animation.play(this.move_anim[n]):t==a.Idle?this.isFiring?this.pendingAnim=this.idle_anim[n]:this.animation.play(this.idle_anim[n]):t==a.Fire&&(this.isFiring=!0,this.animation.play(this.fire_anim[n])),this.animIdx=n),this.direction=e,this.action=t},e.prototype.onDeath=function(t){var e=this;p.default.isTutorial||this.controller&&this.controller.handleDeath()||(u.default.instance.dispatch(l.default.EVENT_NET_ENTITY_DEATH,this.id),t?this.node.removeFromParent():this.node.runAction(cc.sequence(cc.fadeOut(1),cc.callFunc(function(){e.node.removeFromParent()}))))},e.prototype.onAnimationEvent=function(t,e){"finished"===t&&-1!=e.name.indexOf("fire_")&&(this.isFiring=!1,null!=this.pendingAnim&&(this.animation.play(this.pendingAnim),this.pendingAnim=null))},e.getLevelExp=function(t){return 100*Math.pow(2,t-1)},e.getHealth=function(t){return 70*t},e.prototype.enableAttack=function(t){void 0===t&&(t=r.Normal),t==r.Normal?this.bombable=!0:this.skillable=!0,this.atkType=r.None},e.prototype.setBombskin=function(t){this.bskin=t},e.prototype.getBombskin=function(){return this.bskin},e.prototype.setImpactEffect=function(t){this.effects=t.slice()},e.prototype.setTargetPos=function(t){this.targetPos=t},e.prototype.setBombAnim=function(t){this.m_bomb=t,null!=this.m_bomb?(this.m_bomb.setOwnerPlayer(this),this.m_bomb.init({id:this.id,x:this.node.position.x,y:this.node.position.y,opacity:0,death:!1,percent:100,exploded:!0,skin:this.bskin}),this.m_bomb.setExplodeStatus(!0),this.targetPos&&this.m_bomb.setEndPos(this.targetPos.x,this.targetPos.y),this.m_bomb.node.addComponent(cc.CircleCollider),this.m_bomb.node.getComponent(cc.CircleCollider).radius=this.m_bomb.node.width/2,this.m_bomb.node.getComponent(cc.CircleCollider).tag=2,this.m_bomb.node.getComponent(cc.CircleCollider).enabled=!1,this.m_bomb.collider=this.m_bomb.node.getComponent(cc.CircleCollider),this.node.parent.addChild(this.m_bomb.node)):cc.log("--\x3e Need set one bomb for player")},e.prototype.update=function(t){if(p.default.isTutorial&&this.isRobot&&!this.stopPoint&&this.autoMove&&this.targetPos){var e=this.node.getPosition().x,n=this.node.getPosition().y,o=this.targetPos.x,i=this.targetPos.y,r=(o-e)*(o-e)+(i-n)*(i-n),s=Math.sqrt(r),c=(r+(o-e)*(o-e)-(i-n)*(i-n))/(2*s*(o-e)),l=Math.acos(c);if((e>o&&n>i||e<o&&n>i)&&(l=2*Math.PI-Math.acos(c)),s>this.maxDistanceCanfire){var u=s/this.playerSpeed,h=this.node.position.lerp(this.targetPos,t/u);this.updateAction(a.Move,180*l/Math.PI),this.setPosition(h.x,h.y)}else this.action==a.Move&&this.updateAction(a.Idle,180*l/Math.PI),this.autoFire&&this.action!=a.Fire&&this.bombable&&(this.bombable=!1,this.m_bomb&&(this.m_bomb.setEndPos(this.targetPos.x,this.targetPos.y),this.m_bomb.collider.tag=2,this.m_bomb.setStateData({id:this.id,x:this.node.x,y:this.node.y+f.ConfigGame.PLAYER_HEIGHT,percent:100,death:!1,exploded:!1,opacity:255,skin:this.bskin}),this.m_bomb.setExplodeStatus(!1)))}},e.EVENT_LOCAL_PLAYER_EXP_CHANGE="local_exp_change",i([g(cc.Label)],e.prototype,"playerName",void 0),i([g(c.default)],e.prototype,"healthBar",void 0),i([g(cc.Sprite)],e.prototype,"sprite",void 0),i([g(cc.Sprite)],e.prototype,"directionSprite",void 0),i([g(cc.Sprite)],e.prototype,"rank",void 0),i([g(cc.Node)],e.prototype,"effectsNode",void 0),i([g({type:[cc.SpriteFrame]})],e.prototype,"rankFrames",void 0),i([g({type:[cc.SpriteFrame]})],e.prototype,"buffFrames",void 0),e=i([y],e)}(l.default);n.default=_,cc._RF.pop()},{"../core/event-manager":"event-manager","../player-ref":"player-ref","./ConfigGame":"ConfigGame","./game":"game","./net-component":"net-component","./ui/healthbar":"healthbar"}],polyglot:[function(t,e,n){(function(t){"use strict";function o(t){"@babel/helpers - typeof";return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}cc._RF.push(e,"fc9daZr2NhGiIHGcSpiJP7z","polyglot"),function(t,i){"function"==typeof define&&define.amd?define([],function(){return i(t)}):"object"===(void 0===n?"undefined":o(n))?e.exports=i(t):t.Polyglot=i(t)}(void 0!==t?t:void 0,function(t){var e=String.prototype.replace;function n(t){t=t||{},this.phrases={},this.extend(t.phrases||{}),this.currentLocale=t.locale||"en",this.allowMissing=!!t.allowMissing,this.warn=t.warn||g}n.VERSION="1.0.0",n.prototype.locale=function(t){return t&&(this.currentLocale=t),this.currentLocale},n.prototype.extend=function(t,e){var n;for(var i in t)t.hasOwnProperty(i)&&(n=t[i],e&&(i=e+"."+i),"object"===o(n)?this.extend(n,i):this.phrases[i]=n)},n.prototype.unset=function(t,e){var n;if("string"==typeof t)delete this.phrases[t];else for(var i in t)t.hasOwnProperty(i)&&(n=t[i],e&&(i=e+"."+i),"object"===o(n)?this.unset(n,i):delete this.phrases[i])},n.prototype.clear=function(){this.phrases={}},n.prototype.replace=function(t){this.clear(),this.extend(t)},n.prototype.t=function(t,e){var n,o;return"number"==typeof(e=null==e?{}:e)&&(e={smart_count:e}),"string"==typeof this.phrases[t]?n=this.phrases[t]:"string"==typeof e._?n=e._:this.allowMissing?n=t:(this.warn('Missing translation for key: "'+t+'"'),o=t),"string"==typeof n&&(e=_(e),o=y(o=u(n,this.currentLocale,e.smart_count),e)),o},n.prototype.has=function(t){return t in this.phrases};var i="||||",r={chinese:function(t){return 0},german:function(t){return 1!==t?1:0},french:function(t){return t>1?1:0},russian:function(t){return t%10==1&&t%100!=11?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2},czech:function(t){return 1===t?0:t>=2&&t<=4?1:2},polish:function(t){return 1===t?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2},icelandic:function(t){return t%10!=1||t%100==11?1:0}},a={chinese:["fa","id","ja","ko","lo","ms","th","tr","zh"],german:["da","de","en","es","fi","el","he","hu","it","nl","no","pt","sv"],french:["fr","tl","pt-br"],russian:["hr","ru"],czech:["cs","sk"],polish:["pl"],icelandic:["is"]};function s(t){var e,n,o,i={};for(e in t)if(t.hasOwnProperty(e))for(o in n=t[e])i[n[o]]=e;return i}var c=/^\s+|\s+$/g;function l(t){return e.call(t,c,"")}function u(t,e,n){var o;return null!=n&&t?l((o=t.split(i))[f(e,n)]||o[0]):t}function p(t){var e=s(a);return e[t]||e.en}function f(t,e){return r[p(t)](e)}var h=/\$/g,d="$$$$";function y(t,n){for(var o in n)if("_"!==o&&n.hasOwnProperty(o)){var i=n[o];"string"==typeof i&&(i=e.call(n[o],h,d)),t=e.call(t,new RegExp("%\\{"+o+"\\}","g"),i)}return t}function g(e){t.console&&t.console.warn&&t.console.warn("WARNING: "+e)}function _(t){var e={};for(var n in t)e[n]=t[n];return e}return n}),cc._RF.pop()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],popup:[function(t,e,n){"use strict";cc._RF.push(e,"c2517+l3BlDPqhUWyhQt7/S","popup");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=cc._decorator,a=r.ccclass,s=r.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dialogPopup=null,e.waitingPopup=null,e.target=null,e.waitingPopupNode=null,e}var n;return o(e,t),n=e,Object.defineProperty(e,"instance",{get:function(){return this._instance?this._instance:(cc.error("Popup does not init yet, this need to be init in loader"),null)},enumerable:!0,configurable:!0}),e.prototype.onLoad=function(){n._instance=this,cc.game.addPersistRootNode(this.node),this.node.zIndex=1e3},e.prototype.setTarget=function(t){this.target=t},e.prototype.showInfoPopup=function(t,e,n,o){var i=this.target?this.target:cc.find("Canvas"),r=cc.instantiate(this.dialogPopup);r.name="final_Info_dialog";var a=r.getChildByName("blockinput").getComponent(cc.Widget);a.target=i,a.left=0,a.right=0,r.getChildByName("confirm-content").active=!1;var s=r.getChildByName("info-content");t&&(s.getChildByName("title").getComponent(cc.Label).string=t),s.getChildByName("title").getComponent(cc.Label).horizontalAlign=1,s.getChildByName("title").getComponent(cc.Label).verticalAlign=1,s.active=!0;var c=s.getChildByName("cancelbutton").getComponent(cc.Button);c.node.on("click",function(){r.removeFromParent(),e&&e()});var l=s.getChildByName("positivebutton").getComponent(cc.Button);l.node.on("click",function(){r.removeFromParent(),e&&e()});var u=s.getChildByName("negativebutton").getComponent(cc.Button);u.node.on("click",function(){r.removeFromParent(),e&&!n&&e(),o&&n&&o()}),n?c.node.active=!1:(l.node.active=!1,u.node.active=!1),i.addChild(r)},e.prototype.showConfirmPopup=function(t,e,n,o,i){var r=this.target?this.target:cc.find("Canvas"),a=cc.instantiate(this.dialogPopup),s=a.getChildByName("blockinput").getComponent(cc.Widget);s.target=r,s.left=0,s.right=0,a.getChildByName("info-content").active=!1;var c=a.getChildByName("confirm-content");c.active=!0,c.getChildByName("character").getComponent(cc.Sprite).spriteFrame=t,c.getChildByName("played-time").getComponent(cc.Label).string=e,c.getChildByName("killed-number").getComponent(cc.Label).string=n,c.getChildByName("positivebutton").getComponent(cc.Button).node.on("click",function(){a.removeFromParent(),o&&o()}),c.getChildByName("negativebutton").getComponent(cc.Button).node.on("click",function(){a.removeFromParent(),i&&i()}),r.addChild(a)},e.prototype.showWaitingPopup=function(t){if(!this.waitingPopupNode){var e=this.target?this.target:cc.find("Canvas"),n=cc.instantiate(this.waitingPopup),o=n.getChildByName("blockinput").getComponent(cc.Widget);o.target=e,o.left=0,o.right=0,this.waitingPopupNode=n,e.addChild(this.waitingPopupNode),this.waitingPopupNode.getChildByName("content").getComponentInChildren(cc.Label).string=t}},e.prototype.hideWaitingPopup=function(){this.waitingPopupNode.removeFromParent()},e.prototype.showNotify=function(t,e){void 0===e&&(e=3);var n=this.target?this.target:cc.find("Canvas"),o=cc.instantiate(this.waitingPopup);o.getChildByName("blockinput").removeFromParent(),o.getChildByName("content").getComponentInChildren(cc.Label).string=t,n.addChild(o),this.scheduleOnce(function(){o.removeFromParent()},e)},e._instance=null,i([s(cc.Prefab)],e.prototype,"dialogPopup",void 0),i([s(cc.Prefab)],e.prototype,"waitingPopup",void 0),e=n=i([a],e)}(cc.Component);n.default=c,cc._RF.pop()},{}],"resources-cacher":[function(t,e,n){"use strict";cc._RF.push(e,"0f45ctQ8IlPCI9ZabJXTMHm","resources-cacher"),Object.defineProperty(n,"__esModule",{value:!0});var o=t("../core/event-manager");(function(t){t[t.NONE=0]="NONE",t[t.CACHING=1]="CACHING",t[t.CACHED=2]="CACHED"})(n.State||(n.State={}));var i=function(){function t(){this.mc_anims={},this.map={}}return Object.defineProperty(t,"instance",{get:function(){return null==this._instance&&(this._instance=new t),t._instance},enumerable:!0,configurable:!0}),t.prototype.load=function(){var t=this;cc.loader.loadRes("map/default",function(e,n){t.map.asset=n,t.map.texture={};["map/sand","map/ice","map/grass"].forEach(function(e,n){cc.loader.loadRes(e,function(e,o){t.map.texture[n]=o})}),o.default.instance.dispatch("Resources-Cached")})},t._instance=null,t}();n.default=i,cc._RF.pop()},{"../core/event-manager":"event-manager"}],"sound-manager":[function(t,e,n){"use strict";cc._RF.push(e,"59e6dC1iuNE15G3c1/RKO6a","sound-manager");var o=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var i=cc._decorator,r=i.ccclass,a=(i.property,t("./event-manager")),s=function(){function t(){this.sounds={},this.playingSounds={},this.initialized=!1,this.enable=!0,this.effectEnable=!0,this.musicEnable=!0,this.DEBUG_LOG=!1}var e;return e=t,Object.defineProperty(t,"instance",{get:function(){return null==e._instance&&(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"soundEnable",{get:function(){return this.enable},enumerable:!0,configurable:!0}),t.prototype.setEnable=function(t){this.enable=t,cc.sys.localStorage.setItem("Sound_enable",t?1:0),this.setEffectEnable(t),this.setMusicEnable(t)},Object.defineProperty(t.prototype,"soundEffectEnable",{get:function(){return this.effectEnable},enumerable:!0,configurable:!0}),t.prototype.setEffectEnable=function(t){this.effectEnable=t,cc.sys.localStorage.setItem("Sound_effect_enable",t?1:0)},Object.defineProperty(t.prototype,"soundMusicEnable",{get:function(){return this.musicEnable},enumerable:!0,configurable:!0}),t.prototype.setMusicEnable=function(t){this.musicEnable=t,cc.sys.localStorage.setItem("Sound_music_enable",t?1:0)},t.prototype.log=function(t){this.DEBUG_LOG&&cc.log(t)},t.prototype.error=function(t){this.DEBUG_LOG&&cc.error(t)},t.prototype.init=function(){var t=this;cc.loader.loadResDir("sounds",cc.AudioClip,function(e,n,o){o.length>0&&n.forEach(function(e,n){t.sounds[e.name]=e}),t.initialized=!0,t.enable=!cc.sys.localStorage.getItem("Sound_enable")||1==parseInt(cc.sys.localStorage.getItem("Sound_enable")),t.effectEnable=!cc.sys.localStorage.getItem("Sound_effect_enable")||1==parseInt(cc.sys.localStorage.getItem("Sound_effect_enable")),t.musicEnable=!cc.sys.localStorage.getItem("Sound_music_enable")||1==parseInt(cc.sys.localStorage.getItem("Sound_music_enable")),cc.log("sound init"),a.default.instance.dispatch("Sound_initialized")})},t.prototype.playMusic=function(t,e){if(void 0===e&&(e=!0),!this.musicEnable||!this.initialized)return null;if(t=t.toLowerCase(),this.sounds[t]){this.log("play music: "+t);var n=cc.audioEngine.playMusic(this.sounds[t],e);return this.playingSounds[t]=n,n}return this.error("playMusic - clipName: "+t+" not found"),null},t.prototype.playEffect=function(t,e){if(void 0===e&&(e=!1),!this.enable||!this.initialized)return null;if(t=t.toLowerCase(),this.sounds[t]){this.log("play effect: "+t);var n=cc.audioEngine.playEffect(this.sounds[t],e);return this.playingSounds[t]=n,n}return this.error("playEffect - clipName: "+t+" not found"),null},t.prototype.playRandom=function(t,e,n){if(void 0===e&&(e=!1),void 0===n&&(n=!0),!this.enable||!this.initialized)return null;var o=Math.floor(Math.random()*t.length),i=t[o].toLowerCase();if(this.sounds[i]){this.log("play random: "+i);var r=null;return r=n?this.playEffect(i,e):this.playMusic(i,e),this.playingSounds[i]=r,r}return this.error("playRandom - clipName: "+t[o]+" not found"),null},t.prototype.pause=function(t){this.enable&&(t=t.toLowerCase(),void 0!=this.playingSounds[t]&&cc.audioEngine.getState(this.playingSounds[t])===cc.audioEngine.AudioState.PLAYING?cc.audioEngine.pause(this.playingSounds[t]):(this.error("Pause sound: "+t+" is not in playing list"),delete this.playingSounds[t]))},t.prototype.resume=function(t){this.enable&&(t=t.toLowerCase(),void 0!=this.playingSounds[t]&&cc.audioEngine.getState(this.playingSounds[t])===cc.audioEngine.AudioState.PAUSED?cc.audioEngine.resume(this.playingSounds[t]):(this.error("Resume sound: "+t+" is not in pause list"),delete this.playingSounds[t]))},t.prototype.stop=function(t){this.enable&&(this.log("stop sound: "+t),t=t.toLowerCase(),void 0!=this.playingSounds[t]?(cc.audioEngine.stop(this.playingSounds[t]),delete this.playingSounds[t]):this.error("Stop sound: "+t+" is not in playing list"))},t.prototype.isPlaying=function(t){return t=t.toLowerCase(),void 0!=this.playingSounds[t]&&cc.audioEngine.getState(this.playingSounds[t])==cc.audioEngine.AudioState.PLAYING},t.prototype.pauseAll=function(){cc.audioEngine.pauseAll()},t.prototype.resumeAll=function(){this.enable&&cc.audioEngine.resumeAll()},t.prototype.stopAll=function(){this.enable&&cc.audioEngine.stopAll()},t.prototype.setMusicVolume=function(t){this.musicEnable&&cc.audioEngine.setMusicVolume(t)},t.prototype.setEffectVolume=function(t){this.effectEnable&&cc.audioEngine.setEffectsVolume(t)},t.prototype.getSoundId=function(t){return t=t.toLowerCase(),this.playingSounds[t]},t._instance=null,t=e=o([r],t)}();n.default=s,cc._RF.pop()},{"./event-manager":"event-manager"}],"special-skill":[function(t,e,n){"use strict";cc._RF.push(e,"2279cDiA/NJmJt70uxiHI7z","special-skill");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=t("../../player-ref"),a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.uiRoot=null,e.skillFrames=[],e.normalFrames=[],e.bgFrames=[],e.skill=null,e.blockInput=null,e.skillSprite=null,e.bgSkillSprite=null,e.normalSprite=null,e.skillCooldown=null,e}return o(e,t),e.prototype.start=function(){var t=this.uiRoot.getChildByName("button-fire"),e=this.uiRoot.getChildByName("button-skill"),n=this.uiRoot.getChildByName("fire-pad"),o=this.uiRoot.getChildByName("skill-pad");this.skillSprite=(e.active?e.children[1]:o.children[2]).getComponent(cc.Sprite),this.bgSkillSprite=(e.active?e.children[0]:o.children[1]).getComponent(cc.Sprite),this.normalSprite=(t.active?t.children[1]:n.children[1]).getComponent(cc.Sprite),this.skillCooldown=(e.active?e.children[2]:o.children[3]).getComponent(cc.Label),this.skill=e.active?e.children[1].getComponent(cc.Button):null,this.blockInput=o.active?o.children[0]:null},e.prototype.setPlayerSkill=function(){this.skillSprite.spriteFrame=this.skillFrames[r.default.current.user],this.bgSkillSprite.spriteFrame=this.bgFrames[r.default.current.user],this.normalSprite.spriteFrame=this.normalFrames[r.default.current.bomb]},e.prototype.setData=function(t,e,n){this.skill&&(this.skill.interactable=e),this.blockInput&&(this.blockInput.active=!e),this.skillSprite.spriteFrame=this.skillFrames[t],this.skillSprite.node.color=e?cc.Color.WHITE:cc.Color.GRAY,this.skillCooldown.node.active=!e,this.skillCooldown.string=n},i([c(cc.Node)],e.prototype,"uiRoot",void 0),i([c({type:cc.SpriteFrame})],e.prototype,"skillFrames",void 0),i([c({type:cc.SpriteFrame})],e.prototype,"normalFrames",void 0),i([c({type:cc.SpriteFrame})],e.prototype,"bgFrames",void 0),e=i([s],e)}(cc.Component);n.default=l,cc._RF.pop()},{"../../player-ref":"player-ref"}],squence_first_launch:[function(t,e,n){"use strict";cc._RF.push(e,"d5049IZCvFGe74LssjbvZC4","squence_first_launch");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=t("../../player-ref"),a=t("./SequenceManager"),s=t("./SequenceNode"),c=cc._decorator,l=c.ccclass,u=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.onLoad=function(){var t=this.getComponent(a.default);r.default.current.first_launch_step<1&&t.push(this.node.children[0].getComponent(s.SequenceNode))},e=i([l],e)}(cc.Component));n.default=u,cc._RF.pop()},{"../../player-ref":"player-ref","./SequenceManager":"SequenceManager","./SequenceNode":"SequenceNode"}],"transport-message":[function(t,e,n){"use strict";cc._RF.push(e,"9d73dZh4/xErImzzrW9XvRT","transport-message"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(){this._messages={}}return Object.defineProperty(t,"instance",{get:function(){return null==this._instance&&(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),t.prototype.send=function(t,e,n){void 0===n&&(n=""),this._messages[t]||(this._messages[t]={}),this._messages[t][e]=n},t.prototype.get=function(t,e,n){void 0===n&&(n=!0);var o=null;return this._messages[t]&&null!=this._messages[t][e]&&(o=this._messages[t][e].slice(0,this._messages[t][e].length),n&&delete this._messages[t][e]),o},t._instance=null,t}();n.default=o,cc._RF.pop()},{}],tutorial:[function(t,e,n){"use strict";cc._RF.push(e,"7e6d3RG9LVNCoJ3C/bzKMtd","tutorial");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r,a,s=t("../core/loader"),c=t("./player"),l=t("./player"),u=t("./bomb"),p=t("../player-ref"),f=t("./camera-control"),h=t("./player-control"),d=t("./player-control-local"),y=t("../core/popup"),g=t("./resources-cacher"),_=t("./ConfigGame"),m=t("../core/sound-manager"),b=t("./game"),v=cc._decorator,P=v.ccclass,w=v.property;(function(t){t[t.Tutorial_move=0]="Tutorial_move",t[t.Tutorial_fire=1]="Tutorial_fire",t[t.Tutorial_skill=2]="Tutorial_skill",t[t.Tutorial_shield=3]="Tutorial_shield",t[t.Tutorial_finish=4]="Tutorial_finish"})(r=n.TUTORIAL_STATE||(n.TUTORIAL_STATE={})),function(t){t[t.Tutorial_default=0]="Tutorial_default",t[t.Tutorial_stopPoint=1]="Tutorial_stopPoint",t[t.Tutorial_checkdoAction=2]="Tutorial_checkdoAction",t[t.Tutorial_subStepMax=3]="Tutorial_subStepMax"}(a=n.TUTORIAL_SUB_STATE||(n.TUTORIAL_SUB_STATE={}));var S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.worldMap=null,e.bombPrefab=null,e.playerPrefabs=[],e.targetPrefab=null,e.btn_playnow=null,e.localTarget=null,e.TutorialPopup=null,e.TutorialHand=null,e.handPos=null,e.players_list={},e.bubles={},e.worldSize=null,e.playerSize=null,e.bombRange=_.ConfigGame.BOMB_LENGTH,e.playerSpeed=0,e.textshow="",e.isEndStopPoint=!1,e.animStopPoint=null,e.performAction=0,e.botFireCount=0,e.block_firepad=null,e.block_touchzone=null,e.block_skillpad=null,e.btn_firepad=null,e.btn_dpad=null,e.btn_skillpad=null,e.state_comepleted=-1,e.lockControl=!1,e.collisionManager=null,e.isWaitingReleaseDPad=!1,e.numofBomb=0,e}var n;return o(e,t),n=e,e.prototype.onLoad=function(){if(s.default.loaded){var t,e=this.worldMap.getChildByName("tMap"),o=e.addComponent(cc.TiledMap);if(o.tmxAsset=g.default.instance.map.asset,o.tmxAsset.textures[0]=g.default.instance.map.texture[p.default.current.map],e.active=!0,1==p.default.current.user)t=cc.find("/Canvas/uiRoot/ice").getComponent(cc.Sprite).spriteFrame;else if(2==p.default.current.user){t=cc.find("/Canvas/uiRoot/grass").getComponent(cc.Sprite).spriteFrame}if(0!=p.default.current.user)cc.find("/Canvas/uiRoot/skill-pad/indicator").getComponent(cc.Sprite).spriteFrame=t;n.instance=this,this.TutorialPopup=cc.find("/Canvas/uiRoot/tutorial_text/text"),this.TutorialPopup.active=!1,this.TutorialHand=this.node.getChildByName("hand"),this.TutorialHand.active=!1}},e.prototype.resetTutorialState=function(){n.tutorial_status=r.Tutorial_move,n.tutorial_sub_status=a.Tutorial_default,n.instance.state_comepleted=-1,n.instance.performAction=0},e.prototype.start=function(){s.default.loaded&&(b.default.isTutorial?(y.default.instance.setTarget(this.node.getChildByName("uiRoot")),this.collisionManager=cc.director.getCollisionManager(),this.collisionManager.enabled=!0,this.collisionManager.enabledDebugDraw=!1,this.initEntities(),this.block_skillpad||(this.block_skillpad=cc.find("/Canvas/uiRoot/skill-pad/block_input")),this.block_touchzone||(this.block_touchzone=cc.find("/Canvas/uiRoot/touchZone/block_input")),this.block_firepad||(this.block_firepad=cc.find("/Canvas/uiRoot/fire-pad/block_input")),this.btn_firepad||(this.btn_firepad=cc.find("/Canvas/uiRoot/fire-pad")),this.btn_skillpad||(this.btn_skillpad=cc.find("/Canvas/uiRoot/skill-pad")),this.btn_dpad||(this.btn_dpad=cc.find("/Canvas/uiRoot/d-pad")),this.setlockControl(!0),m.default.instance.playMusic("m_ap")):this.gotoMainMenu())},e.prototype.update=function(t){s.default.loaded&&b.default.isTutorial&&(null==f.default.instance.getTarget()&&this.worldMap.getChildByName("Main MC")&&f.default.instance.setTarget(this.TutorialPlayer.node),this.state_comepleted==n.tutorial_status&&this.updateTutorialStatus(),this.UpdateTutorial_Step(),this.BOTplayer.action!=l.PlayerAction.Fire&&this.BOTplayer.bombable&&this.BOTplayer.setTargetPos(this.TutorialPlayer.node.position))},e.prototype.initEntities=function(){this.worldSize=cc.v2(_.ConfigGame.WORLD_WIDTH,_.ConfigGame.WORLD_HEIGHT);var t=cc.instantiate(this.playerPrefabs[p.default.current.user]).getComponent(c.default);t.init({id:0,x:0,y:0,level:1,exp:0,health:70,name:p.default.current.name,cskin:p.default.current.user}),t.node.addComponent(d.default).init(null),t.node.addComponent(cc.CircleCollider),t.node.getComponent(cc.CircleCollider).radius=t.node.width/2,t.node.getComponent(cc.CircleCollider).tag=0,t.collider=t.node.getComponent(cc.CircleCollider),t.node.name="Main MC",this.worldMap.addChild(t.node),this.TutorialPlayer=t,this.TutorialPlayer.setServerData({id:0,x:0,y:0,cskin:p.default.current.user,opacity:255,direction:0,action:l.PlayerAction.Idle,health:70,level:1,exp:0,vulnerable:!0,death:!1,buff:0,buffs:[],bombable:!0,skillable:!0,cooldown:0,lastInputSeq:0});var e=cc.instantiate(this.bombPrefab).getComponent(u.default);this.TutorialPlayer.setBombAnim(e);var n=Math.floor(3*Math.random()),o=cc.instantiate(this.playerPrefabs[n]).getComponent(c.default);o.init({id:1,x:450,y:0,level:1,exp:0,health:70,name:"Player 1",cskin:n}),o.isRobot=!0,o.autoMove=!0,o.autoFire=!1,o.setTargetPos(this.TutorialPlayer.node.position),o.node.addComponent(h.default),o.node.addComponent(cc.CircleCollider),o.node.getComponent(cc.CircleCollider).radius=o.node.width/2,o.node.getComponent(cc.CircleCollider).tag=0,o.node.getComponent(cc.CircleCollider).enabled=!0,o.collider=o.node.getComponent(cc.CircleCollider),this.worldMap.addChild(o.node),this.BOTplayer=o,this.BOTplayer.setServerData({id:1,x:450,y:0,cskin:p.default.current.user,opacity:255,direction:0,action:l.PlayerAction.Idle,health:70,level:0,exp:0,vulnerable:!0,death:!1,buff:0,buffs:[],bombable:!0,skillable:!0,cooldown:0,lastInputSeq:0});var i=cc.instantiate(this.bombPrefab).getComponent(u.default);this.BOTplayer.setBombAnim(i),this.localTarget=cc.instantiate(this.targetPrefab),this.localTarget.active=!1,this.worldMap.addChild(this.localTarget)},e.prototype.generateBomb=function(t){return cc.instantiate(this.bombPrefab).getComponent(u.default)},e.prototype.updateLocalTarget=function(t,e){if(t>-1&&e>0){var o=e*this.bombRange/100,i=t*Math.PI/180,s=this.TutorialPlayer.node.getPosition().x+Math.round(o*Math.cos(i)),c=this.TutorialPlayer.node.getPosition().y+Math.round(o*Math.sin(i));this.localTarget.setPosition(s,c),this.localTarget.active=!0,this.TutorialPlayer.m_bomb.setEndPos(s,c),n.tutorial_status==r.Tutorial_fire&&n.tutorial_sub_status==a.Tutorial_checkdoAction&&(Math.abs(this.localTarget.position.x-this.TutorialPlayer.node.position.x)>10||Math.abs(this.localTarget.position.y-this.TutorialPlayer.node.position.y)>10)&&(this.performAction=1)}else this.localTarget.active=!1,n.tutorial_status==r.Tutorial_fire&&n.tutorial_sub_status==a.Tutorial_checkdoAction&&1==this.performAction&&(this.performAction=2),this.TutorialPlayer.action==l.PlayerAction.Fire&&this.TutorialPlayer.bombable&&(b.default.USE_DYNAMIC_BOMB&&null==this.TutorialPlayer.m_bomb.getEndPos()&&this.TutorialPlayer.m_bomb.setEndPos(this.TutorialPlayer.node.position.x,this.TutorialPlayer.node.position.y+ +_.ConfigGame.PLAYER_HEIGHT),this.TutorialPlayer.m_bomb.setStateData({id:this.TutorialPlayer.id,x:this.TutorialPlayer.node.position.x,y:this.TutorialPlayer.node.position.y+_.ConfigGame.PLAYER_HEIGHT,percent:100,death:!1,exploded:!1,opacity:255,skin:p.default.current.bomb}),this.TutorialPlayer.m_bomb.setExplodeStatus(!1),this.TutorialPlayer.bombable=!1)},e.prototype.updateBombSkill=function(t){this.TutorialPlayer.m_bomb.collider.tag=t},e.prototype.resetTempleStatus=function(){this.setlockControl(!0),this.TutorialPlayer.setPosition(0,0),this.TutorialPlayer.setServerData({id:0,x:0,y:0,cskin:p.default.current.user,opacity:255,direction:0,action:l.PlayerAction.Idle,health:70,level:1,exp:0,vulnerable:!0,death:!1,buff:0,buffs:[],bombable:!0,skillable:!0,cooldown:0,lastInputSeq:0}),this.TutorialPlayer.collider&&(this.TutorialPlayer.collider.enabled=!0),this.BOTplayer.setPosition(480,0),this.BOTplayer.setServerData({id:1,x:480,y:0,cskin:p.default.current.user,opacity:255,direction:0,action:l.PlayerAction.Idle,health:70,level:1,exp:0,vulnerable:!0,death:!1,buff:0,buffs:[],bombable:!0,skillable:!0,cooldown:0,lastInputSeq:0}),this.BOTplayer.collider&&(this.BOTplayer.collider.enabled=!0),this.BOTplayer.autoFire=!1,this.performAction=0,this.botFireCount=0},e.prototype.setlockControl=function(t){if(this.lockControl!=t)if(this.lockControl=t,this.lockControl)this.TutorialHand.active=!1,this.block_skillpad&&(this.block_skillpad.active=!0),this.block_touchzone&&(this.block_touchzone.active=!0),this.block_firepad&&(this.block_firepad.active=!0),this.btn_firepad&&(this.btn_firepad.opacity=128),this.btn_skillpad&&(this.btn_skillpad.opacity=128),this.btn_dpad&&(this.btn_dpad.opacity=128);else switch(n.tutorial_status){case r.Tutorial_move:if(this.block_touchzone&&(this.block_touchzone.active=this.lockControl),this.btn_dpad)this.btn_dpad.opacity=255,(e=this.btn_dpad.getChildByName("indicator"))&&(e.opacity=255);break;case r.Tutorial_fire:this.block_firepad&&(this.block_firepad.active=this.lockControl),this.btn_firepad&&(this.btn_firepad.opacity=255);break;case r.Tutorial_skill:var e;if(this.block_touchzone&&(this.block_touchzone.active=this.lockControl),this.block_skillpad&&(this.block_skillpad.active=this.lockControl),this.btn_skillpad&&(this.btn_skillpad.opacity=255),this.btn_dpad)this.btn_dpad.opacity=255,(e=this.btn_dpad.getChildByName("indicator"))&&(e.opacity=255);break;case r.Tutorial_shield:this.block_touchzone&&(this.block_touchzone.active=!0),this.block_skillpad&&(this.block_skillpad.active=!0),this.btn_skillpad&&(this.btn_skillpad.opacity=128),this.block_firepad&&(this.block_firepad.active=!0),this.block_firepad&&(this.block_firepad.opacity=128);break;case r.Tutorial_finish:this.block_skillpad&&(this.block_skillpad.active=!0),this.btn_skillpad&&(this.btn_skillpad.opacity=128),this.block_touchzone&&(this.block_touchzone.active=!0),this.btn_dpad&&(this.btn_dpad.opacity=128),this.block_firepad&&(this.block_firepad.active=!0),this.btn_firepad&&(this.btn_firepad.opacity=128)}},e.prototype.gotoMainMenu=function(){switch(+p.default.current.user){case p.DesignType.Fire:p.default.current.isRabitTutorial=0;break;case p.DesignType.Grass:p.default.current.isLeafTutorial=0;break;case p.DesignType.Ice:p.default.current.isPenguinTutorial=0}b.default.isTutorial=!1,n.instance.resetTutorialState(),cc.director.loadScene("game"),y.default.instance.setTarget(null)},e.prototype.updateTutorialStatus=function(){if(n.tutorial_status==r.Tutorial_finish){if(this.TutorialPopup.getComponent(cc.Label).string="",0==n.tutorial_sub_status){n.tutorial_sub_status=4;var t=this.node.getChildByName("uiRoot");y.default.instance.showInfoPopup("Thank you for playing tutorial.\nEnjoy the game.",this.gotoMainMenu.bind(this),!1);var e=t.getChildByName("final_Info_dialog");if(e)cc.log("Can find popup_node"),e.getChildByName("info-content").getChildByName("cancelbutton").getChildByName("exit").getComponent(cc.Label).string="Play"}}else n.tutorial_status++,n.tutorial_sub_status=0;this.resetTempleStatus()},e.prototype.UpdateTutorial_Step=function(){var t=this.BOTplayer.node.position.x,e=this.BOTplayer.node.position.y,o=this.TutorialPlayer.node.position.x,i=this.TutorialPlayer.node.position.y,a=(o-t)*(o-t)+(i-e)*(i-e);Math.sqrt(a);if(n.tutorial_status==r.Tutorial_move){this.textshow="Touch and slide virtual D-pad \n to move main character.";var s=cc.find("/Canvas/uiRoot/d-pad");this.handPos=s.position,this.UpdateTutorial_SubStep("/Canvas/uiRoot/d-pad","Touch and slide virtual D-pad \n to move main character.","Touch and slide virtual D-pad \n to move main character."),this.TutorialPlayer.action==l.PlayerAction.Move&&(this.isWaitingReleaseDPad=!0),this.TutorialPlayer.action==l.PlayerAction.Idle&&this.isWaitingReleaseDPad&&1==this.performAction&&(this.isWaitingReleaseDPad=!1,n.instance.state_comepleted=r.Tutorial_move)}else if(n.tutorial_status==r.Tutorial_fire){this.textshow="Press and hold the button \n to increase a buble range.";var c=cc.find("/Canvas/uiRoot/fire-pad");this.handPos=c.position,this.UpdateTutorial_SubStep("/Canvas/uiRoot/fire-pad","Press and hold the button \n to increase a buble range.","Release your finger to\n throw a jelly Balloon."),(this.BOTplayer.health<=0||this.TutorialPlayer.health<=0)&&(n.instance.state_comepleted=r.Tutorial_fire)}else if(n.tutorial_status==r.Tutorial_skill){var u=cc.find("/Canvas/uiRoot/skill-pad");this.handPos=u.position,p.default.current.user==p.DesignType.Grass?this.UpdateTutorial_SubStep("/Canvas/uiRoot/skill-pad","Each character will have \n a specific special skill.","Touch this button \n to perform special skill.\n You are invisible but \nyou still take damge."):this.UpdateTutorial_SubStep("/Canvas/uiRoot/skill-pad","Each character will have \n a specific special skill.","Touch this button \n to perform special skill."),4==this.performAction&&(n.instance.state_comepleted=r.Tutorial_skill)}else n.tutorial_status==r.Tutorial_shield?(this.UpdateTutorial_SubStep("","A shield is activated \nautomatically in 30 seconds \nwhen starting a match.","Touch the screen to continue."),5==this.TutorialPlayer.numofBombReceive&&(this.performAction=2,this.BOTplayer.autoFire=!1,this.TutorialPlayer.numofBombReceive++,this.block_touchzone&&(this.block_touchzone.active=!1)),(4==this.performAction||this.BOTplayer.health<=0)&&(n.instance.state_comepleted=r.Tutorial_shield)):(n.tutorial_status=r.Tutorial_finish)&&(n.instance.state_comepleted=r.Tutorial_finish)},e.prototype.UpdateTutorial_SubStep=function(t,e,o){switch(n.tutorial_sub_status){case a.Tutorial_default:n.tutorial_status==r.Tutorial_shield&&(this.TutorialPlayer.invulnerable=!1,this.TutorialPlayer.init({id:0,x:0,y:0,level:1,exp:0,health:70,name:p.default.current.name}),this.TutorialPlayer.effectsNode.children[0].active=!0),this.TutorialPopup.active=!0,this.TutorialPopup.getComponent(cc.Label).string=e,n.tutorial_status!=r.Tutorial_shield&&n.tutorial_status!=r.Tutorial_skill||(this.BOTplayer.autoFire=!0),n.tutorial_sub_status++;break;case a.Tutorial_stopPoint:if(n.tutorial_status==r.Tutorial_shield&&n.tutorial_sub_status++,null==this.animStopPoint){if(this.isEndStopPoint=!0,""==t)break;var i=cc.find(t);i.opacity=255,this.TutorialHand.active=!0,this.TutorialHand.position=this.handPos,n.tutorial_status==r.Tutorial_fire||n.tutorial_status==r.Tutorial_skill?(this.TutorialHand.getChildByName("hand_touch").active=!0,this.animStopPoint=cc.blink(2,4)):(this.TutorialHand.getChildByName("hand_touch").active=!0,this.animStopPoint=cc.repeat(cc.sequence(cc.moveTo(.5,i.position),cc.moveTo(.5,cc.v2(i.x+80,i.y+80)),cc.moveTo(.5,i.position)),3)),this.animStopPoint.setTag(2e3),this.TutorialHand.runAction(this.animStopPoint)}this.animStopPoint&&this.animStopPoint.isDone()&&(n.tutorial_sub_status++,this.animStopPoint=null,n.tutorial_status==r.Tutorial_move&&(this.performAction=1));break;case a.Tutorial_checkdoAction:if(this.TutorialPopup.active=!0,this.setlockControl(!1),1==this.performAction&&(this.TutorialPopup.getComponent(cc.Label).string=o),2==this.performAction)if(n.tutorial_status==r.Tutorial_skill||n.tutorial_status==r.Tutorial_shield){if(this.TutorialPopup.getComponent(cc.Label).string="Touch the screen to continue.",this.BOTplayer.autoFire=!1,this.block_skillpad&&(this.block_skillpad.active=!0),this.btn_skillpad&&n.tutorial_status==r.Tutorial_skill&&(this.btn_skillpad.opacity=255),this.btn_dpad){this.btn_dpad.active=!0;var s=this.btn_dpad.getChildByName("indicator");s&&(s.opacity=128)}}else n.tutorial_sub_status++;4==this.performAction&&n.tutorial_sub_status++}},e.prototype.onPlayNowPress=function(){m.default.instance.playEffect("sfx_ui_press"),this.gotoMainMenu()},e.instance=null,e.tutorial_status=0,e.tutorial_sub_status=0,i([w(cc.Node)],e.prototype,"worldMap",void 0),i([w(cc.Prefab)],e.prototype,"bombPrefab",void 0),i([w({type:cc.Prefab})],e.prototype,"playerPrefabs",void 0),i([w(cc.Prefab)],e.prototype,"targetPrefab",void 0),i([w(cc.Node)],e.prototype,"btn_playnow",void 0),e=n=i([P],e)}(cc.Component);n.default=S,cc._RF.pop()},{"../core/loader":"loader","../core/popup":"popup","../core/sound-manager":"sound-manager","../player-ref":"player-ref","./ConfigGame":"ConfigGame","./bomb":"bomb","./camera-control":"camera-control","./game":"game","./player":"player","./player-control":"player-control","./player-control-local":"player-control-local","./resources-cacher":"resources-cacher"}],use_reversed_rotateBy:[function(t,e,n){"use strict";cc._RF.push(e,"6b41dpq/xxFR6JkLTHMpzzt","use_reversed_rotateBy"),cc.RotateBy._reverse=!0,cc._RF.pop()},{}],use_reversed_rotateTo:[function(t,e,n){"use strict";cc._RF.push(e,"91e35jsfKJB9Kz7xZ6tmMqr","use_reversed_rotateTo"),cc.RotateTo._reverse=!0,cc._RF.pop()},{}],"use_v2.1-2.2.1_cc.Toggle_event":[function(t,e,n){"use strict";cc._RF.push(e,"932a6FM8ddBJJTyvQXgHmW6","use_v2.1-2.2.1_cc.Toggle_event"),cc.Toggle&&(cc.Toggle._triggerEventInScript_isChecked=!0),cc._RF.pop()},{}],utils:[function(t,e,n){"use strict";cc._RF.push(e,"5cfb2oIO3hIpYyXE5URmBs6","utils"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t,e){void 0===e&&(e=!1),this.unique=[],this.initLength=-1,this.recycle=!1,this.initLength=t,this.recycle=e;for(var n=0;n<t;n++)this.unique[n]=n}return t.prototype.random=function(){if(0==this.unique.length){if(!this.recycle||-1==this.initLength)return-1;for(var t=0;t<this.initLength;t++)this.unique[t]=t}var e=Math.floor(Math.random()*(this.unique.length-1)),n=this.unique[e];return this.unique.splice(e,1),n},t}();n.RandomUnique=o;var i=function(){function t(){}return t.MAX_SAFE_INTEGER=9007199254740991,t.MIN_SAFE_INTEGER=-9007199254740991,t}();n.Constant=i;var r=function(){function t(){}return t.getCurrentSceneName=function(){var t="";return cc.game._sceneInfos.forEach(function(e){e.uuid==cc.director._scene._id&&(t=(t=e.url).substring(t.lastIndexOf("/")+1).match(/[^\.]+/)[0])}),t},t.lerp=function(t,e,n){return t+(e-t)*(n=(n=n<0?0:n)>1?1:n)},t.genUId=function(){return Date.now().toString(36)+Math.random().toString(36).substr(2,5)},t.extend=function(t,e){return null==e?t:(null==t&&(t={}),Object.keys(e).forEach(function(n){t[n]=e[n]}),t)},t.randomRange=function(t,e){return Math.random()*(e-t)+t},t.zeropad=function(t,e){var n=t<0?"-":"";t<0&&(t=-t);for(var o=e-t.toString().length,i=0;i<o;i++)n+="0";return n+t.toString()},t.sign=function(t){return t>0?1:t<0?-1:0},t.moveTowards=function(e,n,o){return Math.abs(n-e)<=o?n:e+t.sign(n-e)*o},t.v2MoveTowards=function(t,e,n){var o=e.sub(t),i=o.mag();return i<=n||0==i?e:t.add(o.div(i).mul(n))},t.zeropad=function(t,e){var n=t<0?"-":"";t<0&&(t=-t);for(var o=e-t.toString().length,i=0;i<o;i++)n+="0";return n+t.toString()},t.Atob=function(t){return null!=t&&this.ENCODE_LOCAL_STORAGE?atob(t):t},t.Btoa=function(t){return null!=t&&this.ENCODE_LOCAL_STORAGE?btoa(t):t},t.ENCODE_LOCAL_STORAGE=!0,t}();n.Utils=r,cc._RF.pop()},{}],"widget-align":[function(t,e,n){"use strict";cc._RF.push(e,"9d32euE/BtBM6pNLOGeVu3K","widget-align");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=cc._decorator,a=r.ccclass,s=(r.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.start=function(){this.node.parent.on(cc.Node.EventType.SIZE_CHANGED,this.onParentSizeChange,this),this.widget=this.getComponent(cc.Widget)},e.prototype.onParentSizeChange=function(){this.widget.updateAlignment()},e=i([a],e)}(cc.Component));n.default=s,cc._RF.pop()},{}]},{},["use_reversed_rotateBy","use_reversed_rotateTo","use_v2.1-2.2.1_cc.Toggle_event","config","event-manager","loader","localization","popup","sound-manager","transport-message","ConfigGame","bomb","camera-control","PersistentObject","debug","exp-buble","firebaseAppInst","game","GameState","input-keyboard","input-touch","input","help-page","main-menu","client","BitStream","IMessageData","JsonPacker","NetMessage","SCCustomCodec","SCFormatter","net-component","notifier","ClientRequest","PingRequest","ServerConnectionRequest","ServerDisconnectionRequest","ServerInfoRequest","player-control-local","player-control","player","resources-cacher","SequenceManager","SequenceNode","SequenceNodeSerial","SequenceNodeShowGreetingPopup","SequenceNodeShowPopup","SequenceNodeShowSelectSkinPopup","SequenceNodeShowServerSelectionPopup","SequenceNodeWait","squence_first_launch","tutorial","healthbar","leaderboard","levelexp-control","minimap","special-skill","player-ref","utils","widget-align","LabelLocalized","RichTextLocalized","i18n","polyglot"]);
//# sourceMappingURL=project.js.map
